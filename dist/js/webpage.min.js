var webpage=function(e){function t(a){if(s[a])return s[a].exports;var n=s[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t){"use strict";function s(){g=JsBattle.createRenderer(m),g.loadAssets(a.bind(this))}function a(){g.init(u),l=JsBattle.createSimulation(g),l.onError(n),l.init(900,600),l.onRender(i),l.setSpeed(h),l.onFinish(function(){i(!0);var e=-1,t="";for(var s in l.tankList){var a=l.tankList[s];a.score>e&&(e=a.score,t=a.fullName)}l.timeElapsed==l.timeLimit?$(".congrats").html("<small>Time out! The winner is:</small><br/> <strong>"+t+"</strong>!"):$(".congrats").html("<small>And the winner is:</small><br/> <strong>"+t+"</strong>!"),$(".sim-finish").show(),$(".sim-control").hide(),p=30,setTimeout(o,500)}),$("#sim-loading").show(),$.getJSON("js/tanks/index.json",function(e){e.forEach(function(e){l.addTank(e),$("#sim-loading").hide(),$("#sim-start").show()}),o(),r(l.tankList),i(!0)}).fail(function(){n("Cannot load and parse js/tanks/index.json")})}function n(e){console.error(e),$("#error > span").html(e),$("#error").show()}function r(e){var t,s,a,n,r;$("#scoreboard > tbody > tr.tank-data").remove(),f=[],$("#debug-tank").empty(),$("#debug-tank").append('<option value="0">[Select Tank for Debug View]</option>');for(var i in e)s=e[i],t=$('<tr class="tank-data"></tr>'),a=$("<td></td>"),n=$('<td class="energy" style="text-align: center"><div class="progress" style="margin-bottom: 0 !important;"><div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div></div></td>'),r=$('<td style="text-align: right" class="score">0</td>'),t.append(a),t.append(n),t.append(r),$("#scoreboard").append(t),$("#debug-tank").append('<option value="'+s.id+'">'+s.fullName+"</option>"),f.push({row:t,nameCell:a,energyCell:n,scoreCell:r,progressBar:n.find(".progress > .progress-bar")});$("#debug-tank").val(c)}function i(e){if(f.length){v++;var t,s;for(t in l.tankList)s=l.tankList[t],s.id==c&&($("#debug-view > pre.debug").html(s.debugData?s.debugData:"{}"),$("#debug-view > pre.state").html(JSON.stringify(s.state,null,2)));if(e||v%15==0){var a=[];for(t in l.tankList)s=l.tankList[t],a.push({name:s.fullName,energy:Math.round(100*s.energy/s.maxEnergy),score:s.score});a.sort(function(e,t){return t.score-e.score});for(t in a)f[t].nameCell.html(a[t].name),f[t].progressBar.attr("aria-valuenow",a[t].energy),f[t].progressBar.css("width",a[t].energy+"%"),f[t].progressBar.html(a[t].energy.toFixed(2)),f[t].scoreCell.html(a[t].score.toFixed(2))}}}function o(){$("#battlefield").hide(),$("#cover").show()}function d(){$("#battlefield").show(),$("#cover").hide()}var l,c=localStorage.getItem("settings.debugTankId");c=c||0;var g,m="brody",u=document.getElementById("battlefield"),p=0,f=[],h=localStorage.getItem("settings.simSpeed");h=h||1,setInterval(function(){g&&p>0&&(g.preRender(),g.postRender(),p--)},30);var v=0;$(document).ready(function(){0==c?$("#debug-view").hide():($("#debug-view").show(),$("#debug-view > pre").html("")),s(),o(),$("#sim-super-slow").data("speed",.05),$("#sim-slow").data("speed",.3),$("#sim-normal").data("speed",1),$("#sim-fast").data("speed",8),$("#sim-super-fast").data("speed",50),$(".sim-speed").click(function(){h=$(this).data("speed"),localStorage.setItem("settings.simSpeed",h),l&&l.setSpeed(h),$(".sim-speed").removeClass("btn-warning"),$(this).addClass("btn-warning")}),$(".sim-speed").toArray().find(function(e){e=$(e),e.data("speed")==h&&e.addClass("btn-warning")}),$("#debug-tank").change(function(){c=$(this).val(),localStorage.setItem("settings.debugTankId",c),0==c?$("#debug-view").hide():($("#debug-view").show(),$("#debug-view > pre").html(""))}),$("#sim-start").click(function(){l.start(),d(),$(".sim-control").show(),$("#sim-start").hide()}),$("#sim-restart").click(function(){$(".sim-finish").hide(),$("#sim-loading").show(),s()})})}]);
//# sourceMappingURL=webpage.min.js.map