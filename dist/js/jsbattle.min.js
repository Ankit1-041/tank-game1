var JsBattle=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1),i=n(24),o=n(25),a=n(45),s=n(50),u=n(56);t.exports={createSimulation:function(t){return t=t||new i,new r(t)},createAiDefinition:function(){return new u},createRenderer:function(t){switch(t){case"debug":return new o;case"bw":return new a;case"brody":return new s;default:throw"Unknown rederer "+t}}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=n(3),u=n(4),l=n(5),c=n(6),h=n(10),f=n(13),p=n(14),_=function(){function t(e){r(this,t),this._aiList=[],this._allTankList=[],this._tankList=[],this._bulletList=[],this._explodedTankList=[],this._explodedBulletList=[],this._battlefield=new u,this._simulationTimeout=null,this._renderInterval=null,this._simulationStepDuration=17,this._renderStepDuration=30,this._renderer=e,this._isRunning=!1,this._collisionResolver=new c,this._rngSeed=(new Date).getTime(),this._rng=p(this._rngSeed),this._speedMultiplier=1,this._onSimulationStepCallback=[],this._onRenderStepCallback=[],this._onFinishCallback=[],this._onErrorCallback=[],this._onStartCallback=[],this._timeElapsed=0,this._timeLimit=3e4,this._eventStore=new l,this._nextTankId=1,this._nextBulletId=1,this._rendererQuality="auto",this._perfMon=new f,this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._callStackLimit=Number.MAX_VALUE,this._callStackCount=0,Math.random=this._rng}return o(t,[{key:"init",value:function(t,e){this._battlefield.setSize(t,e),this._renderer.initBatlefield(this._battlefield),this._collisionResolver.updateBattlefield(this._battlefield)}},{key:"start",value:function(){this._isRunning=!0;var t,e=this;this._renderInterval&&(clearInterval(this._renderInterval),this._renderInterval=null),this._activateAi(function(){for(e._renderInterval=setInterval(function(){e._updateView()},e._renderStepDuration),e._simulationTimeout&&clearTimeout(e._simulationTimeout),e._perfMon.start(),t=0;t<e._onStartCallback.length;t++)e._onStartCallback[t]();e._simulationStep()},function(n){for(console.error(n),t=0;t<e._onErrorCallback.length;t++)e._onErrorCallback[t](n.message?n.message:"Error during simulation")})}},{key:"_simulationStep",value:function(){this._perfMon.onSimulationStep();var t,e=(new Date).getTime(),n=this;this._updateModel(),this._updateAi(function(){if(n._simulationTimeout&&(clearTimeout(n._simulationTimeout),n._simulationTimeout=null),n._getTanksLeft()<=1||n._timeElapsed==n._timeLimit)for(n.stop(),n._updateView(),t=0;t<n._onFinishCallback.length;t++)n._onFinishCallback[t]();if(n._isRunning){var r=(new Date).getTime()-e,i=n._simulationStepDuration-r;for(i/=n._speedMultiplier,i=Math.round(i),t=0;t<n._onSimulationStepCallback.length;t++)n._onSimulationStepCallback[t]();n._timeElapsed=Math.min(n._timeElapsed+n._simulationStepDuration,n._timeLimit),i>0?(n._callStackCount=0,n._simulationTimeout=setTimeout(n._simulationStep.bind(n),i)):n._callStackCount>=n._callStackLimit?n._simulationTimeout=setTimeout(n._simulationStep.bind(n),1):(n._callStackCount++,n._simulationStep())}},function(e){for(console.error(e),t=0;t<n._onErrorCallback.length;t++)n._onErrorCallback[t](e.message?e.message:"Error during simulation")})}},{key:"addTank",value:function(t){if("object"!=(void 0===t?"undefined":i(t)))throw"AI definition must be an object";if(!this._battlefield)throw"Simulation not initialized";var e=this._battlefield.getStartSlot();if(!e)throw"No free space in the battlefield";var n=this._createTank(t);n.randomize(),n.moveTo(e.x,e.y),this._tankList.push(n),this._allTankList.push(n),this._allTankList.length>2&&(this._timeLimit+=2e3);var r=this._createAiWrapper(n,t);return this._aiList.push(r),r}},{key:"setSpeed",value:function(t){this._speedMultiplier=Math.max(.01,Number(t)),this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._renderer.setSpeed(t)}},{key:"setRendererQuality",value:function(t){isNaN(t)&&"auto"!=t||(isNaN(t)||(t=Math.min(1,Math.max(0,t))),this._rendererQuality=t)}},{key:"stop",value:function(){this._isRunning=!1,this._perfMon.stop(),this._renderer.stop(),this._simulationTimeout&&(clearTimeout(this._simulationTimeout),this._simulationTimeout=null),this._renderInterval&&(clearInterval(this._renderInterval),this._renderInterval=null);var t,e;for(e=0;e<this._aiList.length;e++)(t=this._aiList[e])&&t.deactivate();this._aiList=[]}},{key:"onStep",value:function(t){this._onSimulationStepCallback.push(t)}},{key:"onRender",value:function(t){this._onRenderStepCallback.push(t)}},{key:"onStart",value:function(t){this._onStartCallback.push(t)}},{key:"onFinish",value:function(t){this._onFinishCallback.push(t)}},{key:"onError",value:function(t){this._onErrorCallback.push(t)}},{key:"_activateAi",value:function(t,e){this._runInSequence(this._aiList,"activate",this._rngSeed,t,e)}},{key:"_updateAi",value:function(t,e){this._runInSequence(this._aiList,"simulationStep",null,t,e)}},{key:"_runInSequence",value:function(t,e,n,r,i){function o(){for(var t=[],e=arguments[1],n=arguments[0],r=2;r<arguments.length;r++)t.push(arguments[r]);return function(r){e.apply(n,t.concat(r))}}if(0==t.length)return r();var a,s=o(null,r),u=o(null,i);a=n?o(t[t.length-1],t[t.length-1][e],n,s,u):o(t[t.length-1],t[t.length-1][e],s,u);for(var l=t.length-2;l>=0;l--)a=n?o(t[l],t[l][e],n,a,u):o(t[l],t[l][e],a,u);a()}},{key:"_updateModel",value:function(){var t=void 0,e=void 0,n=void 0,r=void 0;for(t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&e.simulationStep(this._collisionResolver);var i=0;for(t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&e.energy<=0&&(i++,this._tankList[t]=null,this._explodedTankList.push(e),this._collisionResolver.removeTank(e),this._eventStore.add("tank_"+e.id,{type:"destroy",tank:e}));var o=[];for(t=0;t<this._aiList.length;t++)(r=this._aiList[t])&&(r.tank.energy<=0?(this._aiList[t]=null,r.deactivate()):o.push(r));for(this._aiList=o,t=0;t<this._tankList.length;t++)if((e=this._tankList[t])&&e.isShooting){var a=e.handleShoot();n=this._createBullet(e,a),this._bulletList.push(n),this._eventStore.add("tank_"+e.id,{type:"shoot",tank:e,bullet:n})}for(t=0;t<this._tankList.length;t++)if(e=this._tankList[t])for(var s=0;s<i;s++)e.onSurviveScore();for(t=0;t<this._bulletList.length;t++)(n=this._bulletList[t])&&(n.simulationStep(),this._collisionResolver.hitTestBullet(n)&&(this._bulletList[t]=null,this._explodedBulletList.push(n),this._collisionResolver.removeBullet(n),this._eventStore.add("bullet_"+n.id,{type:"explode",bullet:n})))}},{key:"_updateView",value:function(){"auto"==this._rendererQuality?this._renderer.quality=this._perfMon.qualityLevel:this._renderer.quality=this._rendererQuality;var t=void 0,e=void 0,n=void 0;for(this._renderer.preRender(),this._renderer.renderClock(this._timeElapsed,this._timeLimit),t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&this._renderer.renderTank(e,this._eventStore.get("tank_"+e.id));for(t=0;t<this._bulletList.length;t++)(n=this._bulletList[t])&&this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(;this._explodedTankList.length;)e=this._explodedTankList.pop(),this._renderer.renderTank(e,this._eventStore.get("tank_"+e.id));for(;this._explodedBulletList.length;)n=this._explodedBulletList.pop(),this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(this._renderer.renderTankStats(this._allTankList),this._renderer.postRender(),t=0;t<this._onRenderStepCallback.length;t++)this._onRenderStepCallback[t]();this._eventStore.clear()}},{key:"_getTanksLeft",value:function(){for(var t=0,e=0;e<this._tankList.length;e++)this._tankList[e]&&t++;return t}},{key:"_createAiWrapper",value:function(t,e){return new h(t,e)}},{key:"_createTank",value:function(t){return new a(t,this._nextTankId++)}},{key:"_createBullet",value:function(t,e){return new s(t,this._nextBulletId++,e)}},{key:"tankList",get:function(){return this._allTankList}},{key:"renderer",get:function(){return this._renderer}},{key:"battlefield",get:function(){return this._battlefield}},{key:"timeElapsed",get:function(){return this._timeElapsed}},{key:"timeLimit",get:function(){return this._timeLimit},set:function(t){this._timeLimit=t}}]),t}();t.exports=_},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){for(;t>180;)t-=360;for(;t<-180;)t+=360;return t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e,r){if(n(this,t),"object"!=(void 0===e?"undefined":i(e)))throw"AI definition must be an object";this._id=r,this._name=e.name,this._maxEnergy=100,this._energy=this._maxEnergy,this._x=0,this._y=0,this._lastX=0,this._lastY=0,this._angle=0,this._gunAngle=0,this._radarAngle=0,this._throttle=0,this._actualThrottle=0,this._speed=0,this._turn=0,this._gunTurn=0,this._radarTurn=0,this._wallHit=!1,this._enemyHit=!1,this._beingRammed=!1,this._radarRange=300,this._radarFocal=6,this._enemySpot=null,this._bulletsSpot=[],this._gunReloadTime=70,this._gunTimer=0,this._shootingPower=0,this._targetingAlarmTimer=0,this._debugData={},this._score=0,this._state=null,this._hasBoost=!1,this._maxBoost=400,this._boost=this._maxBoost,this._wallDistance=null,this._skin="zebra"}return o(t,[{key:"onEnemyHitScore",value:function(t){this._score+=t}},{key:"onEnemyKillScore",value:function(){this._score+=20}},{key:"onSurviveScore",value:function(){this._score+=10}},{key:"setThrottle",value:function(t){this._throttle=Math.min(1,Math.max(-1,t))}},{key:"setTurn",value:function(t){this._turn=Math.min(1,Math.max(-1,t))}},{key:"setGunTurn",value:function(t){this._gunTurn=Math.min(1,Math.max(-1,t))}},{key:"setRadarTurn",value:function(t){this._radarTurn=Math.min(1,Math.max(-1,t))}},{key:"setBoost",value:function(t){this._hasBoost=!!t}},{key:"setDebugData",value:function(t){this._debugData=t}},{key:"onWallHit",value:function(){this._wallHit=!0,this.onDamage(.2)}},{key:"onEnemyHit",value:function(){this._enemyHit=!0,this.onDamage(.2)}},{key:"onBeingRam",value:function(t){this._beingRammed=!0,this.onDamage(.1+.1*Math.round(8*t))}},{key:"onEnemySpot",value:function(t){this._enemySpot=t}},{key:"onBulletSpot",value:function(t){this._bulletsSpot.push(t)}},{key:"onWallSpot",value:function(t){this._wallDistance=t}},{key:"onTargetingAlarm",value:function(){this._targetingAlarmTimer=3}},{key:"onDamage",value:function(t){this._energy=Math.max(0,this._energy-t)}},{key:"moveTo",value:function(t,e){this._x=t,this._y=e,this._lastX=t,this._lastY=e}},{key:"handleShoot",value:function(){var t=this._shootingPower;return this._shootingPower=0,t}},{key:"shoot",value:function(t){t=Math.max(.1,Math.min(1,t)),this.isReloading||(this._gunTimer=Math.round(t*this._gunReloadTime),this._shootingPower=t)}},{key:"randomize",value:function(){this._angle=Math.round(360*Math.random())-180}},{key:"init",value:function(t){t&&t.SKIN&&(this._skin=t.SKIN)}},{key:"simulationStep",value:function(t){var e=this;if(0!=e._energy){e._hasBoost&&e._boost>0&&e._boost--;var n=e._x,i=e._y,o=e._throttle*(e.hasBoost?4:2),a=e.hasBoost?10:20;e._actualThrottle+=(o-e._actualThrottle)/a;var s=e._actualThrottle,u=e._angle*(Math.PI/180);e._x+=s*Math.cos(u),e._y+=s*Math.sin(u),e._wallHit=!1,e._enemyHit=!1;!t.checkTank(e)&&(e._x=n,e._y=i,e._actualThrottle=0),this._beingRammed&&(e._enemyHit=!0,this._beingRammed=!1),e._angle+=2*e._turn,e._radarAngle+=6*e._radarTurn,e._gunAngle+=3*e._gunTurn,e._angle=r(e._angle),e._radarAngle=r(e._radarAngle),e._gunAngle=r(e._gunAngle),t.updateTank(e),e._enemySpot=null,e._wallDistance=null,e._targetingAlarmTimer=Math.max(0,e._targetingAlarmTimer-1),t.scanTanks(e),t.scanBullets(e),t.scanWalls(e),e._gunTimer>0&&e._gunTimer--;for(var l=null,c=[];e._bulletsSpot.length;){var h=e._bulletsSpot.shift();c.push({id:h.id,x:h.x,y:h.y,angle:h.angle,speed:h.speed,damage:h.damage})}e._enemySpot&&(l={id:e._enemySpot.id,x:e._enemySpot.x,y:e._enemySpot.y,angle:e._enemySpot.angle,speed:e._enemySpot.speed,energy:e._enemySpot.energy});var f=e._x-e._lastX,p=e._y-e._lastY;e._speed=Math.sqrt(f*f+p*p),e._lastX=e._x,e._lastY=e._y,e._state={x:e._x,y:e._y,angle:e._angle,energy:e._energy,boost:e._boost,collisions:{wall:e._wallHit,enemy:e._enemyHit},radar:{angle:e._radarAngle,targetingAlarm:e.targetingAlarm,wallDistance:e._wallDistance,enemy:l,bullets:c},gun:{angle:e._gunAngle,reloading:e.isReloading}}}}},{key:"id",get:function(){return this._id}},{key:"skin",get:function(){return this._skin}},{key:"state",get:function(){return this._state}},{key:"energy",get:function(){return this._energy}},{key:"score",get:function(){return this._score}},{key:"maxEnergy",get:function(){return this._maxEnergy}},{key:"radarRange",get:function(){return this._radarRange}},{key:"radarFocal",get:function(){return this._radarFocal}},{key:"name",get:function(){return this._name}},{key:"fullName",get:function(){return this._name+" #"+this._id}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"speed",get:function(){return this._speed}},{key:"gunLength",get:function(){return 25}},{key:"angle",get:function(){return this._angle}},{key:"throttle",get:function(){return this._throttle}},{key:"hasBoost",get:function(){return this._hasBoost&&this._boost>0}},{key:"boost",get:function(){return this._boost}},{key:"maxBoost",get:function(){return this._maxBoost}},{key:"gunAngle",get:function(){return this._gunAngle}},{key:"radarAngle",get:function(){return this._radarAngle}},{key:"enemySpot",get:function(){return this._enemySpot}},{key:"targetingAlarm",get:function(){return this._targetingAlarmTimer>0}},{key:"debugData",get:function(){return this._debugData}},{key:"isShooting",get:function(){return this._shootingPower>0}},{key:"shootingPower",get:function(){return this._shootingPower}},{key:"isReloading",get:function(){return this._gunTimer>0}}]),t}();t.exports=a},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e,r,i){for(n(this,t),this._id=r,this._owner=e,this._angle=e.angle+e.gunAngle;this._angle>180;)this._angle-=360;for(;this._angle<-180;)this._angle+=360;this._x=e.x+e.gunLength*Math.cos(this._angle*(Math.PI/180)),this._y=e.y+e.gunLength*Math.sin(this._angle*(Math.PI/180)),this._speed=4,this._power=i,this._damage=.01*Math.round(1e3*i+300*i*i),this._exploded=!1}return r(t,[{key:"onWallHit",value:function(){this._exploded=!0}},{key:"onEnemyHit",value:function(t){this._exploded=!0,t.onDamage(this._damage)}},{key:"simulationStep",value:function(){this._x+=this._speed*Math.cos(this._angle*(Math.PI/180)),this._y+=this._speed*Math.sin(this._angle*(Math.PI/180))}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"angle",get:function(){return this._angle}},{key:"speed",get:function(){return this._speed}},{key:"damage",get:function(){return this._damage}},{key:"power",get:function(){return this._power}},{key:"owner",get:function(){return this._owner}},{key:"exploded",get:function(){return this._exploded}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e,r){n(this,t),this._width=null,this._height=null,this._startSlotList=[],this._offsetX=Math.round(1e4*Math.random()-5e3),this._offsetY=Math.round(1e4*Math.random()-5e3)}return r(t,[{key:"setSize",value:function(t,e){this._width=t-2*this.margin,this._height=e-2*this.margin,this._startSlotList=[];for(var n=this.minX+90;n<this.maxX-90;n+=90)for(var r=this.minY+90;r<this.maxY-90;r+=90)this._startSlotList.push({x:n,y:r});for(var i,o,a=this._startSlotList.length;0!==a;)o=Math.floor(Math.random()*a),a-=1,i=this._startSlotList[a],this._startSlotList[a]=this._startSlotList[o],this._startSlotList[o]=i}},{key:"getStartSlot",value:function(){return this._startSlotList.length?this._startSlotList.pop():null}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"margin",get:function(){return 25}},{key:"minX",get:function(){return this._offsetX+this.margin}},{key:"minY",get:function(){return this._offsetY+this.margin}},{key:"maxX",get:function(){return this._offsetX+this._width+this.margin}},{key:"maxY",get:function(){return this._offsetY+this._height+this.margin}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(){n(this,t),this._data=[]}return r(t,[{key:"add",value:function(t,e){this._data[t]||(this._data[t]=[]),this._data[t].push(e)}},{key:"get",value:function(t){return this._data[t]||(this._data[t]=[]),this._data[t]}},{key:"clear",value:function(t){this._data=[]}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(7);t.exports=function(){function t(){r(this,t),this._wallList=[],this._tankMap=[],this._bulletMap=[],this._radarBeamMap=[],this._battlefield=null}return i(t,[{key:"updateBattlefield",value:function(t){this._battlefield={minX:t.minX,minY:t.minY,maxX:t.maxX,maxY:t.maxY};var e;e=new o.Box(new o.Vector(t.minX-10,t.minY),10,t.height).toPolygon(),this._wallList.push(e),e=new o.Box(new o.Vector(t.minX,t.minY-10),t.width,10).toPolygon(),this._wallList.push(e),e=new o.Box(new o.Vector(t.maxX,t.minY),10,t.height).toPolygon(),this._wallList.push(e),e=new o.Box(new o.Vector(t.minX,t.maxY),t.width,10).toPolygon(),this._wallList.push(e)}},{key:"updateTank",value:function(t){var e=this._getTankShape(t);e.pos.x=t.x,e.pos.y=t.y}},{key:"removeBullet",value:function(t){this._bulletMap[t.id]=null}},{key:"removeTank",value:function(t){this._tankMap[t.id]=null,this._radarBeamMap[t.id]=null}},{key:"hitTestBullet",value:function(t){var e=this._getBulletShape(t),n=t.owner.energy?this._getTankShape(t.owner):null;e.pos.x=t.x,e.pos.y=t.y;var r,i;for(r in this._wallList)if(i=this._wallList[r],o.testCirclePolygon(e,i))return t.onWallHit(),!0;var a;for(r in this._tankMap)if((a=this._tankMap[r])&&a!=n&&o.testCircleCircle(e,a)){var s=a.tank.energy;return t.onEnemyHit(a.tank),t.owner.onEnemyHitScore(s-a.tank.energy),0==a.tank.energy&&t.owner.onEnemyKillScore(),!0}return!1}},{key:"checkTank",value:function(t){var e=this._getTankShape(t);e.pos.x=t.x,e.pos.y=t.y;var n,r;for(n in this._wallList)if(r=this._wallList[n],o.testCirclePolygon(e,r))return t.onWallHit(),!1;var i;for(n in this._tankMap)if((i=this._tankMap[n])&&i!=e&&o.testCircleCircle(e,i)){var a=i.tank.energy;return t.onEnemyHit(),i.tank.onBeingRam(t.speed),t.onEnemyHitScore(a-i.tank.energy),!1}return!0}},{key:"scanTanks",value:function(t){var e=this._getRadarBeamShape(t),n=this._getTankShape(t);e.setAngle((t.angle+t.radarAngle)*Math.PI/180),e.pos.x=t.x,e.pos.y=t.y;var r,i,a=[];for(r in this._tankMap)(i=this._tankMap[r])&&i!=n&&o.testPolygonCircle(e,i)&&a.push(i.tank);if(0==a.length)return!1;var s,u,l,c=null,h=t.radarRange;for(r in a)u=a[r].x-t.x,l=a[r].y-t.y,s=Math.sqrt(u*u+l*l),(!c||s<h)&&(c=a[r],h=s);return t.onEnemySpot(c),c.onTargetingAlarm(),!0}},{key:"scanBullets",value:function(t){var e=this._getRadarBeamShape(t);this._getTankShape(t);e.setAngle((t.angle+t.radarAngle)*Math.PI/180),e.pos.x=t.x,e.pos.y=t.y;var n,r,i=!1;for(n in this._bulletMap)(r=this._bulletMap[n])&&r.bullet.owner!=t&&o.testCirclePolygon(r,e)&&(t.onBulletSpot(r.bullet),i=!0);return i}},{key:"scanWalls",value:function(t){var e=this._getWallDistance(t);return e<t.radarRange&&(t.onWallSpot(e),!0)}},{key:"_getWallDistance",value:function(t){for(var e=t.angle+t.radarAngle;e>180;)e-=360;for(;e<-180;)e+=360;var n=t.y-this._battlefield.minY,r=this._battlefield.maxY-t.y,i=t.x-this._battlefield.minX,o=this._battlefield.maxX-t.x;if(-180==e||180==e)return i;if(0==e)return o;if(-90==e)return n;if(90==e)return r;var a,s;return e>-180&&e<-90?(a=i/Math.cos((e+180)*(Math.PI/180)),s=n/Math.sin((e+180)*(Math.PI/180))):e>-90&&e<0?(a=o/Math.cos(-e*(Math.PI/180)),s=n/Math.sin(-e*(Math.PI/180))):e>0&&e<90?(a=o/Math.cos(e*(Math.PI/180)),s=r/Math.sin(e*(Math.PI/180))):(a=i/Math.cos((180-e)*(Math.PI/180)),s=r/Math.sin((180-e)*(Math.PI/180))),Math.min(a,s)}},{key:"_getTankShape",value:function(t){if(!this._tankMap[t.id]){if(0==t.energy)throw"Cannot create shape for destroyed tank";var e=new o.Circle(new o.Vector(t.x,t.y),18);this._tankMap[t.id]=e,e.tank=t}return this._tankMap[t.id]}},{key:"_getBulletShape",value:function(t){if(!this._bulletMap[t.id]){if(t.exploded)throw"Cannot create shape for exploded bullet";var e=new o.Circle(new o.Vector(t.x,t.y),3);this._bulletMap[t.id]=e,e.bullet=t}return this._bulletMap[t.id]}},{key:"_getRadarBeamShape",value:function(t){if(!this._radarBeamMap[t.id]){if(0==t.energy)throw"Cannot create radar beam shape for destroyed tank";var e=t.radarRange*Math.tan(t.radarFocal*(Math.PI/180))/2,n=new o.Polygon(new o.Vector(t.x,t.y),[new o.Vector(0,3),new o.Vector(0,-3),new o.Vector(t.radarRange,-e),new o.Vector(t.radarRange,e)]);this._radarBeamMap[t.id]=n,n.tank=t}return this._radarBeamMap[t.id]}}]),t}()},function(t,e,n){var r,i;(function(t){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};/** @preserve SAT.js - Version 0.6.0 - Copyright 2012 - 2016 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
!function(a,s){n(9).amd?(r=s,void 0!==(i="function"==typeof r?r.call(e,n,e,t):r)&&(t.exports=i)):"object"===o(e)?t.exports=s():a.SAT=s()}(void 0,function(){function t(t,e){this.x=t||0,this.y=e||0}function e(e,n){this.pos=e||new t,this.r=n||0}function n(e,n){this.pos=e||new t,this.angle=0,this.offset=new t,this.setPoints(n||[])}function r(e,n,r){this.pos=e||new t,this.w=n||0,this.h=r||0}function i(){this.a=null,this.b=null,this.overlapN=new t,this.overlapV=new t,this.clear()}function o(t,e,n){for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=t.length,a=0;a<o;a++){var s=t[a].dot(e);s<r&&(r=s),s>i&&(i=s)}n[0]=r,n[1]=i}function a(t,e,n,r,i,a){var s=v.pop(),u=v.pop(),l=d.pop().copy(e).sub(t),c=l.dot(i);if(o(n,i,s),o(r,i,u),u[0]+=c,u[1]+=c,s[0]>u[1]||u[0]>s[1])return d.push(l),v.push(s),v.push(u),!0;if(a){var h=0;if(s[0]<u[0])if(a.aInB=!1,s[1]<u[1])h=s[1]-u[0],a.bInA=!1;else{var f=s[1]-u[0],p=u[1]-s[0];h=f<p?f:-p}else if(a.bInA=!1,s[1]>u[1])h=s[0]-u[1],a.aInB=!1;else{var f=s[1]-u[0],p=u[1]-s[0];h=f<p?f:-p}var _=Math.abs(h);_<a.overlap&&(a.overlap=_,a.overlapN.copy(i),h<0&&a.overlapN.reverse())}return d.push(l),v.push(s),v.push(u),!1}function s(t,e){var n=t.len2(),r=e.dot(t);return r<0?g:r>n?w:k}function u(t,e){var n=d.pop().copy(t).sub(e.pos),r=e.r*e.r,i=n.len2();return d.push(n),i<=r}function l(t,e){b.pos.copy(t),m.clear();var n=p(b,e,m);return n&&(n=m.aInB),n}function c(t,e,n){var r=d.pop().copy(e.pos).sub(t.pos),i=t.r+e.r,o=i*i,a=r.len2();if(a>o)return d.push(r),!1;if(n){var s=Math.sqrt(a);n.a=t,n.b=e,n.overlap=i-s,n.overlapN.copy(r.normalize()),n.overlapV.copy(r).scale(n.overlap),n.aInB=t.r<=e.r&&s<=e.r-t.r,n.bInA=e.r<=t.r&&s<=t.r-e.r}return d.push(r),!0}function h(t,e,n){for(var r=d.pop().copy(e.pos).sub(t.pos),i=e.r,o=i*i,a=t.calcPoints,u=a.length,l=d.pop(),c=d.pop(),h=0;h<u;h++){var f=h===u-1?0:h+1,p=0===h?u-1:h-1,_=0,y=null;l.copy(t.edges[h]),c.copy(r).sub(a[h]),n&&c.len2()>o&&(n.aInB=!1);var v=s(l,c);if(v===g){l.copy(t.edges[p]);var m=d.pop().copy(r).sub(a[p]);if((v=s(l,m))===w){var b=c.len();if(b>i)return d.push(r),d.push(l),d.push(c),d.push(m),!1;n&&(n.bInA=!1,y=c.normalize(),_=i-b)}d.push(m)}else if(v===w){if(l.copy(t.edges[f]),c.copy(r).sub(a[f]),(v=s(l,c))===g){var b=c.len();if(b>i)return d.push(r),d.push(l),d.push(c),!1;n&&(n.bInA=!1,y=c.normalize(),_=i-b)}}else{var k=l.perp().normalize(),b=c.dot(k),x=Math.abs(b);if(b>0&&x>i)return d.push(r),d.push(k),d.push(c),!1;n&&(y=k,_=i-b,(b>=0||_<2*i)&&(n.bInA=!1))}y&&n&&Math.abs(_)<Math.abs(n.overlap)&&(n.overlap=_,n.overlapN.copy(y))}return n&&(n.a=t,n.b=e,n.overlapV.copy(n.overlapN).scale(n.overlap)),d.push(r),d.push(l),d.push(c),!0}function f(t,e,n){var r=h(e,t,n);if(r&&n){var i=n.a,o=n.aInB;n.overlapN.reverse(),n.overlapV.reverse(),n.a=n.b,n.b=i,n.aInB=n.bInA,n.bInA=o}return r}function p(t,e,n){for(var r=t.calcPoints,i=r.length,o=e.calcPoints,s=o.length,u=0;u<i;u++)if(a(t.pos,e.pos,r,o,t.normals[u],n))return!1;for(var u=0;u<s;u++)if(a(t.pos,e.pos,r,o,e.normals[u],n))return!1;return n&&(n.a=t,n.b=e,n.overlapV.copy(n.overlapN).scale(n.overlap)),!0}var _={};_.Vector=t,_.V=t,t.prototype.copy=t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.perp=t.prototype.perp=function(){var t=this.x;return this.x=this.y,this.y=-t,this},t.prototype.rotate=t.prototype.rotate=function(t){var e=this.x,n=this.y;return this.x=e*Math.cos(t)-n*Math.sin(t),this.y=e*Math.sin(t)+n*Math.cos(t),this},t.prototype.reverse=t.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=t.prototype.normalize=function(){var t=this.len();return t>0&&(this.x=this.x/t,this.y=this.y/t),this},t.prototype.add=t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.sub=t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.scale=t.prototype.scale=function(t,e){return this.x*=t,this.y*=e||t,this},t.prototype.project=t.prototype.project=function(t){var e=this.dot(t)/t.len2();return this.x=e*t.x,this.y=e*t.y,this},t.prototype.projectN=t.prototype.projectN=function(t){var e=this.dot(t);return this.x=e*t.x,this.y=e*t.y,this},t.prototype.reflect=t.prototype.reflect=function(t){var e=this.x,n=this.y;return this.project(t).scale(2),this.x-=e,this.y-=n,this},t.prototype.reflectN=t.prototype.reflectN=function(t){var e=this.x,n=this.y;return this.projectN(t).scale(2),this.x-=e,this.y-=n,this},t.prototype.dot=t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.len2=t.prototype.len2=function(){return this.dot(this)},t.prototype.len=t.prototype.len=function(){return Math.sqrt(this.len2())},_.Circle=e,e.prototype.getAABB=e.prototype.getAABB=function(){var e=this.r;return new r(this.pos.clone().sub(new t(e,e)),2*e,2*e).toPolygon()},_.Polygon=n,n.prototype.setPoints=n.prototype.setPoints=function(e){if(!this.points||this.points.length!==e.length){var n,r=this.calcPoints=[],i=this.edges=[],o=this.normals=[];for(n=0;n<e.length;n++)r.push(new t),i.push(new t),o.push(new t)}return this.points=e,this._recalc(),this},n.prototype.setAngle=n.prototype.setAngle=function(t){return this.angle=t,this._recalc(),this},n.prototype.setOffset=n.prototype.setOffset=function(t){return this.offset=t,this._recalc(),this},n.prototype.rotate=n.prototype.rotate=function(t){for(var e=this.points,n=e.length,r=0;r<n;r++)e[r].rotate(t);return this._recalc(),this},n.prototype.translate=n.prototype.translate=function(t,e){for(var n=this.points,r=n.length,i=0;i<r;i++)n[i].x+=t,n[i].y+=e;return this._recalc(),this},n.prototype._recalc=function(){var t,e=this.calcPoints,n=this.edges,r=this.normals,i=this.points,o=this.offset,a=this.angle,s=i.length;for(t=0;t<s;t++){var u=e[t].copy(i[t]);u.x+=o.x,u.y+=o.y,0!==a&&u.rotate(a)}for(t=0;t<s;t++){var l=e[t],c=t<s-1?e[t+1]:e[0],h=n[t].copy(c).sub(l);r[t].copy(h).perp().normalize()}return this},n.prototype.getAABB=n.prototype.getAABB=function(){for(var e=this.calcPoints,n=e.length,i=e[0].x,o=e[0].y,a=e[0].x,s=e[0].y,u=1;u<n;u++){var l=e[u];l.x<i?i=l.x:l.x>a&&(a=l.x),l.y<o?o=l.y:l.y>s&&(s=l.y)}return new r(this.pos.clone().add(new t(i,o)),a-i,s-o).toPolygon()},_.Box=r,r.prototype.toPolygon=r.prototype.toPolygon=function(){var e=this.pos,r=this.w,i=this.h;return new n(new t(e.x,e.y),[new t,new t(r,0),new t(r,i),new t(0,i)])},_.Response=i,i.prototype.clear=i.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var d=[],y=0;y<10;y++)d.push(new t);for(var v=[],y=0;y<5;y++)v.push([]);var m=new i,b=new r(new t,1e-6,1e-6).toPolygon();_.isSeparatingAxis=a;var g=-1,k=0,w=1;return _.pointInCircle=u,_.pointInPolygon=l,_.testCircleCircle=c,_.testPolygonCircle=h,_.testCirclePolygon=f,_.testPolygonPolygon=p,_})}).call(e,n(8)(t))},function(t,e){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(11);t.exports=function(){function t(e,n){if(r(this,t),!e)throw"Tank is required";if(!n)throw"AiDefinition is required";this._tank=e,this._aiWorker=null,this._aiProcessingStart=0,this._aiProcessingCheckInterval=null,this._aiProcessingResolveCallback=null,this._aiProcessingRejectCallback=null,this._slowAiChances=10,this._onActivationCallback=[],this._onDectivationCallback=[],this._aiProcessingTimeLimit=3e3,this._aiDefinition=n,this._isReady=!1,this._controlData={THROTTLE:0,BOOST:0,TURN:0,RADAR_TURN:0,GUN_TURN:0,SHOOT:0,DEBUG:{}}}return o(t,[{key:"setProcessingLimit",value:function(t){this._aiProcessingTimeLimit=t}},{key:"onActivation",value:function(t){this._onActivationCallback.push(t)}},{key:"onDectivation",value:function(t){this._onDeactivationCallback.push(t)}},{key:"activate",value:function(t,e,n){if("number"!=typeof t)throw"seed must be a number, '"+(void 0===t?"undefined":i(t))+"' given";if("function"!=typeof e)throw"resolve callback must be a function, '"+(void 0===e?"undefined":i(e))+"' given";if("function"!=typeof n)throw"reject callback must be a function, '"+(void 0===n?"undefined":i(n))+"' given";var r=this;r._aiWorker=r._createWorker(this._aiDefinition),r._aiWorker.onerror=function(t){console.log(t),r._aiProcessingRejectCallback&&(r._aiProcessingRejectCallback({message:"Web Worker of '"+r._tank.fullName+"' returned an error: "+(t.message?t.message:"unknown"),performanceIssues:!1,tankName:r._tank.name,tankId:r._tank.id}),r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null)},r._aiProcessingCheckInterval&&(clearInterval(r._aiProcessingCheckInterval),r._aiProcessingCheckInterval=null),r._aiProcessingCheckInterval=setInterval(function(){if(r._aiProcessingRejectCallback){(new Date).getTime()-r._aiProcessingStart>r._aiProcessingTimeLimit&&(clearInterval(r._aiProcessingCheckInterval),r._aiProcessingCheckInterval=null,r._aiProcessingRejectCallback({message:"Simulation cannot be continued because "+r._tank.name+" #"+r._tank.id+" does not respond",performanceIssues:!0,tankName:r._tank.name,tankId:r._tank.id}))}},Math.max(r._aiDefinition.executionLimit,Math.round(r._aiProcessingTimeLimit/2))),r._aiWorker.onmessage=function(t){var e=t.data;if(r._aiProcessingResolveCallback){if("init"==e.type){r._configureTank(e.settings?e.settings:{}),r._isReady=!0;for(var n=0;n<r._onActivationCallback.length;n++)r._onActivationCallback[n].bind(r)()}else r._controlTank(e);var i,o=(new Date).getTime(),a=o-r._aiProcessingStart;if(a>r._aiDefinition.executionLimit&&"init"!=e.type&&(r._slowAiChances--,console.warn("Execution of AI for tank "+r._tank.name+" #"+r._tank.id+" takes too long ("+a+"ms). If problem repeats, AI will be terminated."),r._slowAiChances<=0))return i=r._aiProcessingRejectCallback,r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null,void i({message:"Simulation cannot be continued because "+r._tank.name+" #"+r._tank.id+" has performance issues",performanceIssues:!0,tankName:r._tank.name,tankId:r._tank.id});i=r._aiProcessingResolveCallback,r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null,i()}},r._aiProcessingStart=(new Date).getTime(),r._aiProcessingResolveCallback=e,r._aiProcessingRejectCallback=n,r._aiWorker.postMessage({command:"init",seed:t+":"+r._tank.id,settings:{SKIN:"zebra"},code:r._aiDefinition.code,initData:r._aiDefinition.initData})}},{key:"deactivate",value:function(){this._aiWorker&&(this._aiWorker.terminate(),this._aiWorker=null),this._aiProcessingCheckInterval&&(clearInterval(this._aiProcessingCheckInterval),this._aiProcessingCheckInterval=null);for(var t=0;t<this._onDectivationCallback.length;t++)this._onDectivationCallback[t].bind(this)()}},{key:"simulationStep",value:function(t,e){if("function"!=typeof t)throw"resolve callback must be a function, '"+(void 0===t?"undefined":i(t))+"' given";if("function"!=typeof e)throw"reject callback must be a function, '"+(void 0===e?"undefined":i(e))+"' given";if(!this._isReady)throw"AI of "+this._tank.fullName+" not initliazed";var n=this;if(n._aiWorker&&0==n._tank.energy)return n._aiWorker.terminate(),n._aiWorker=null,void t();n._aiProcessingStart=(new Date).getTime(),n._aiProcessingResolveCallback=t,n._aiProcessingRejectCallback=e,n._aiWorker.postMessage({command:"update",state:n._tank.state,control:n._controlData})}},{key:"_configureTank",value:function(t){var e={};-1!=["zebra","forest","black","tiger","desert","lava","ocean"].indexOf(t.SKIN)&&(e.SKIN=t.SKIN),this._tank.init(e)}},{key:"_controlTank",value:function(t){var e=this;e._controlData.THROTTLE=Number(t.THROTTLE),e._controlData.TURN=Number(t.TURN),e._controlData.GUN_TURN=Number(t.GUN_TURN),e._controlData.RADAR_TURN=Number(t.RADAR_TURN),e._controlData.SHOOT=Number(t.SHOOT),e._controlData.DEBUG=t.DEBUG,e._controlData.BOOST=t.BOOST?1:0,e._controlData.THROTTLE=isNaN(e._controlData.THROTTLE)?0:e._controlData.THROTTLE,e._controlData.TURN=isNaN(e._controlData.TURN)?0:e._controlData.TURN,e._controlData.GUN_TURN=isNaN(e._controlData.GUN_TURN)?0:e._controlData.GUN_TURN,e._controlData.RADAR_TURN=isNaN(e._controlData.RADAR_TURN)?0:e._controlData.RADAR_TURN,e._controlData.SHOOT=isNaN(e._controlData.SHOOT)?0:e._controlData.SHOOT,e._controlData.THROTTLE=Math.min(1,Math.max(-1,Number(e._controlData.THROTTLE))),e._controlData.TURN=Math.min(1,Math.max(-1,Number(e._controlData.TURN))),e._controlData.GUN_TURN=Math.min(1,Math.max(-1,Number(e._controlData.GUN_TURN))),e._controlData.RADAR_TURN=Math.min(1,Math.max(-1,Number(e._controlData.RADAR_TURN))),e._controlData.SHOOT=Math.min(1,Math.max(0,Number(e._controlData.SHOOT))),e._tank.setThrottle(e._controlData.THROTTLE),e._tank.setBoost(e._controlData.BOOST),e._tank.setTurn(e._controlData.TURN),e._tank.setRadarTurn(e._controlData.RADAR_TURN),e._tank.setGunTurn(e._controlData.GUN_TURN),e._tank.setDebugData(e._controlData.DEBUG),e._controlData.SHOOT&&e._tank.shoot(e._controlData.SHOOT),e._controlData.SHOOT=0}},{key:"_createWorker",value:function(t){return t.useSandbox?new Worker(t.filePath):new a}},{key:"tank",get:function(){return this._tank}},{key:"worker",get:function(){return this._aiWorker}}]),t}()},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),extendedMath=__webpack_require__(12),TankController=function(){function t(){_classCallCheck(this,t),this._initCallback=function(){},this._loopCallback=function(){}}return _createClass(t,[{key:"loop",value:function(t){this._loopCallback=t}},{key:"init",value:function(t){this._initCallback=t}}]),t}(),EvalWorker=function(){function EvalWorker(){_classCallCheck(this,EvalWorker),this.onmessage=function(t){},this._callStackLimit=100,this._callStackCount=0,this._tankController=new TankController}return _createClass(EvalWorker,[{key:"postMessage",value:function postMessage(inputData){var _this=this,response=null;if("init"==inputData.command){if(!inputData.code)throw"The code is required!";var seed=inputData.seed,settings=inputData.settings;inputData.initData&&(settings.initData=inputData.initData);var Math=extendedMath(),tank=this._tankController;eval(inputData.code),tank._initCallback(settings),response={data:{type:"init",settings:settings}}}else if("update"==inputData.command){var state=inputData.state,control=inputData.control;this._tankController._loopCallback?(this._tankController._loopCallback(state,control),response={data:control}):response={data:control}}this._callStackCount<this._callStackLimit?(this._callStackCount++,this.onmessage(response)):(this._callStackCount=0,setTimeout(function(){_this.onmessage(response)},1))}},{key:"terminate",value:function(){}}]),EvalWorker}();module.exports=EvalWorker},function(t,e){"use strict";t.exports=function(){var t={},e=["LN10","PI","E","LOG10E","SQRT2","LOG2E","SQRT1_2","LN2","cos","pow","log","tan","sqrt","ceil","asin","abs","max","exp","atan2","random","round","floor","acos","atan","min","sin"];for(var n in e)t[e[n]]=Math[e[n]];return t.deg={},t.rad={},t.deg.normalize=function(t){for(t=Number(t);t>180;)t-=360;for(;t<=-180;)t+=360;return t},t.rad.normalize=function(e){for(e=Number(e);e>t.PI;)e-=2*t.PI;for(;e<=-t.PI;)e+=2*t.PI;return e},t.deg2rad=function(e){return t.rad.normalize(e*(t.PI/180))},t.rad2deg=function(e){return t.deg.normalize(e*(180/t.PI))},t.rad.atan2=t.atan2,t.deg.atan2=function(e,n){return t.rad2deg(t.rad.atan2(e,n))},t.distance=function(e,n,r,i){var o=r-e,a=i-n;return t.sqrt(o*o+a*a)},t.randomRange=function(e,n){if(e>n)throw"The range is incorrect. First number must be lower than second";return e+t.random()*(n-e)},t}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(){n(this,t),this._simulationStepDuration=30,this._stepCounter=0,this._checkLoop=0,this._started=!1,this._desiredPerfomance=Math.floor(1e3/this._simulationStepDuration),this._actualPerfomance=this._desiredPerfomance,this._perfomanceIndex=1,this._desiredQuality=1,this._quality=this._desiredQuality,this._checkInterval=500}return r(t,[{key:"start",value:function(){this._started=!0;var t=this;this._checkLoop=setInterval(function(){t._check()},this._checkInterval)}},{key:"stop",value:function(){this._started=!1,this._checkLoop&&(clearInterval(this._checkLoop),this._checkLoop=null)}},{key:"setSimulationStepDuration",value:function(t){t!=this._simulationStepDuration&&(this._quality=this._desiredQuality),this._simulationStepDuration=t,this._desiredPerfomance=Math.floor(1e3/t)}},{key:"onSimulationStep",value:function(){this._started&&this._stepCounter++}},{key:"_check",value:function(){this._actualPerfomance=Math.ceil(this._stepCounter*(1e3/this._checkInterval)),this._stepCounter=0;var t=this._desiredPerfomance?this._actualPerfomance/this._desiredPerfomance:1;this._perfomanceIndex=(this._perfomanceIndex+t)/2,this._updateQuality()}},{key:"_updateQuality",value:function(){var t=2.5*this._perfomanceIndex-1.25;t=Math.max(0,Math.min(1,t));var e=-.5*this._perfomanceIndex+.45;this._perfomanceIndex>1?this._desiredQuality+=.1:this._desiredQuality-=e,this._desiredQuality=Math.max(0,Math.min(1,this._desiredQuality));var n=Math.max(t,this._desiredQuality);this._desiredQuality=(this._desiredQuality+n)/2,this._desiredQuality<this._quality?this._quality=this._desiredQuality:this._quality=(this._desiredQuality+9*this._quality)/10}},{key:"started",get:function(){return this._started}},{key:"desiredPerfomance",get:function(){return this._desiredPerfomance}},{key:"actualPerfomance",get:function(){return this._actualPerfomance}},{key:"qualityLevel",get:function(){return this._quality}}]),t}()},function(t,e,n){"use strict";var r=n(15),i=n(17),o=n(18),a=n(19),s=n(20),u=n(21),l=n(22);l.alea=r,l.xor128=i,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=u,t.exports=l},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t){var e=this,n=c();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function u(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new s(t),r=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,r&&("object"==(void 0===r?"undefined":i(r))&&u(r,n),o.state=function(){return u(n,{})}),o}function c(){var t=4022871197;return function(e){e=e.toString();for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)}}o&&o.exports?o.exports=l:n(9)&&n(16)?void 0!==(r=function(){return l}.call(e,n,e,o))&&(o.exports=r):this.alea=l}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function u(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new s(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,r&&("object"==(void 0===r?"undefined":i(r))&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n(9)&&n(16)?void 0!==(r=function(){return l}.call(e,n,e,o))&&(o.exports=r):this.xor128=l}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function u(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,r&&("object"==(void 0===r?"undefined":i(r))&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n(9)&&n(16)?void 0!==(r=function(){return l}.call(e,n,e,o))&&(o.exports=r):this.xorwow=l}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],t^=t>>>7,n=t^t<<24,t=r[i+1&7],n^=t^t>>>10,t=r[i+3&7],n^=t^t>>>3,t=r[i+4&7],n^=t^t<<7,t=r[i+7&7],t^=t<<13,n^=t^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(9)&&n(16)?void 0!==(r=function(){return u}.call(e,n,e,i))&&(i.exports=r):this.xorshift7=u}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,n=s[127&o]^=r+a,i=0==n?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=a,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(9)&&n(16)?void 0!==(r=function(){return u}.call(e,n,e,i))&&(i.exports=r):this.xor4096=u}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function u(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,r&&("object"==(void 0===r?"undefined":i(r))&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n(9)&&n(16)?void 0!==(r=function(){return l}.call(e,n,e,o))&&(o.exports=r):this.tychei=l}(0,"object"==i(t)&&t,n(9))}).call(e,n(8)(t))},function(t,e,n){var r;(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(o,a){function s(t,e,n){var r=[];e=1==e?{entropy:!0}:e||{};var i=h(c(e.entropy?[t,p(o)]:null==t?f():t,3),r),s=new u(r),_=function(){for(var t=s.g(v),e=b,n=0;t<g;)t=(t+n)*y,e*=y,n=s.g(1);for(;t>=k;)t/=2,e/=2,n>>>=1;return(t+n)/e};return _.int32=function(){return 0|s.g(4)},_.quick=function(){return s.g(4)/4294967296},_.double=_,h(p(s.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&l(r,s),t.state=function(){return l(s,{})}),n?(a[m]=t,e):t})(_,i,"global"in e?e.global:this==a,e.state)}function u(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<y;)a[i]=i++;for(i=0;i<y;i++)a[i]=a[o=w&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=w&i+1],n=n*y+a[w&(a[i]=a[o=w&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(y)}function l(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function c(t,e){var n,r=[],o=void 0===t?"undefined":i(t);if(e&&"object"==o)for(n in t)try{r.push(c(t[n],e-1))}catch(t){}return r.length?r:"string"==o?t:t+"\0"}function h(t,e){for(var n,r=t+"",i=0;i<r.length;)e[w&i]=w&(n^=19*e[w&i])+r.charCodeAt(i++);return p(e)}function f(){try{var t;return _&&(t=_.randomBytes)?t=t(y):(t=new Uint8Array(y),(d.crypto||d.msCrypto).getRandomValues(t)),p(t)}catch(t){var e=d.navigator,n=e&&e.plugins;return[+new Date,d,n,d.screen,p(o)]}}function p(t){return String.fromCharCode.apply(0,t)}var _,d=this,y=256,v=6,m="random",b=a.pow(y,v),g=a.pow(2,52),k=2*g,w=y-1;if(a["seed"+m]=s,h(a.random(),o),"object"==i(t)&&t.exports){t.exports=s;try{_=n(23)}catch(t){}}else void 0!==(r=function(){return s}.call(e,n,e,t))&&(t.exports=r)}([],Math)}).call(e,n(8)(t))},function(t,e){},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){n(this,t)}return r(t,[{key:"initBatlefield",value:function(t){}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"renderTank",value:function(t,e){}},{key:"renderClock",value:function(t,e){}},{key:"renderTankStats",value:function(t){}},{key:"renderBullet",value:function(t,e){}},{key:"setSpeed",value:function(t){}},{key:"stop",value:function(){}},{key:"quality",get:function(){return 1},set:function(t){}}]),t}();t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(26),l=n(40),c=n(41),h=n(42),f=n(44);t.exports=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._frameCounter=0,t._fpsLabel=null,t._scoreBoard=null,t}return o(e,t),a(e,[{key:"initBatlefield",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t);var n=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._fpsLabel=new PIXI.Text("FPS",n),this._fpsLabel.x=100,this._fpsLabel.y=5,this.stage.addChild(this._fpsLabel);var r=this;setInterval(function(){r._fpsLabel.text="FPS: "+r._frameCounter,r._frameCounter=0},1e3),n=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"}),this._scoreBoard=new PIXI.Text("scores",n),this._scoreBoard.x=t.margin+2,this._scoreBoard.y=t.margin+2,this._scoreBoard.alpha=.5,this.stage.addChild(this._scoreBoard)}},{key:"renderTankStats",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTankStats",this).call(this,t);var n,r=[];for(n=0;n<t.length;n++)r.push({name:t[n].fullName,energy:t[n].energy,value:t[n].score});r.sort(function(t,e){return t.value<e.value?1:t.value>e.value?-1:0});var i="";for(n=0;n<r.length;n++)i+=r[n].value.toFixed(3)+" - "+r[n].name+(0==r[n].energy?" [X]":"")+"\n";this._scoreBoard.text=i}},{key:"postRender",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._frameCounter++}},{key:"_createBattlefieldView",value:function(t){return new l(t)}},{key:"_createClockView",value:function(t){return new c(t)}},{key:"_createBulletView",value:function(t){return new h(t)}},{key:"_createTankView",value:function(t){return new f(t)}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(27),l=n(29),c=n(30),h=n(31),f=n(32);t.exports=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(n._name=t,"undefined"==typeof PIXI)throw"Pixi.js is required!";return n._masterContainer=new PIXI.Container,n._tankContainer=new PIXI.Container,n._bulletContainer=new PIXI.Container,n._hudContainer=new PIXI.Container,n._masterContainer.addChild(n._tankContainer),n._masterContainer.addChild(n._bulletContainer),n._masterContainer.addChild(n._hudContainer),n._renderer=null,n._stage=null,n._clockModel=new h,n._clockView=null,n._battlefieldView=null,window.devicePixelRatio>=2?n._rendererScale=2:n._rendererScale=1,n}return o(e,t),a(e,[{key:"initBatlefield",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t),this._masterContainer.x=-this.offsetX,this._masterContainer.y=-this.offsetY;var n={view:this._canvas,antialias:!1,backgroundColor:16777215,resolution:window.devicePixelRatio};this._renderer=new PIXI.autoDetectRenderer(t.width+2*t.margin,t.height+2*t.margin,n),this._stage=new PIXI.Container,this._battlefieldView=this._createBattlefieldView(t),this._clockView=this._createClockView(this._clockModel),this._stage.addChild(this._battlefieldView.view),this._stage.addChild(this._masterContainer),this._stage.addChild(this._clockView.view),this._renderer.render(this._stage)}},{key:"init",value:function(t){this._canvas=t}},{key:"loadAssets",value:function(t){if(!this._name)return void t();var e=new PIXI.loaders.Loader;e.after(f(PIXI));var n=2==this._rendererScale?"retina":"web";e.add("img/game_"+this._name+"_"+n+".json");var r=this;e.load(function(){r.onAssetsLoaded(),t()})}},{key:"onAssetsLoaded",value:function(){}},{key:"preRender",value:function(){this._battlefieldView.update()}},{key:"renderTank",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n);var r=this.getTankView(t.id);!r.parent&&r.isAlive&&(this._tankContainer.addChild(r.view),this._hudContainer.addChild(r.hudView))}},{key:"renderBullet",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n);var r=this.getBulletView(t.id);!r.parent&&r.isAlive&&this._bulletContainer.addChild(r.view)}},{key:"renderClock",value:function(t,e){this._clockModel.update(t,e),this._clockView.update()}},{key:"postRender",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._renderer.render(this._stage)}},{key:"_createTankView",value:function(t){return new c(t)}},{key:"_createBulletView",value:function(t){return new l(t)}},{key:"_createBattlefieldView",value:function(t){return new l(t)}},{key:"_createClockView",value:function(t){return new l(t)}},{key:"stage",get:function(){return this._stage}},{key:"battlefieldView",get:function(){return this._battlefieldView}},{key:"masterContainer",get:function(){return this._masterContainer}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(24),u=n(28);t.exports=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._tankMap=[],t._bulletMap=[],t._offsetX=0,t._offsetY=0,t._speedMultiplier=1,t}return o(e,t),a(e,[{key:"initBatlefield",value:function(t){this._offsetX=t.offsetX,this._offsetY=t.offsetY}},{key:"renderTank",value:function(t,e){this._renderModel(t,e,this._tankMap,this._createTankView)}},{key:"renderBullet",value:function(t,e){this._renderModel(t,e,this._bulletMap,this._createBulletView)}},{key:"getBulletView",value:function(t){return this._bulletMap[t]}},{key:"getTankView",value:function(t){return this._tankMap[t]}},{key:"setSpeed",value:function(t){this._speedMultiplier=t}},{key:"_renderModel",value:function(t,e,n,r){var i=null;return n[t.id]?i=n[t.id]:(i=r(t),n[t.id]=i),i.update(e),i}},{key:"_createTankView",value:function(t){return new u(t)}},{key:"_createBulletView",value:function(t){return new u(t)}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"speedMultiplier",get:function(){return this._speedMultiplier}}]),e}(s)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),this._model=e,this._view=null,this._isAlive=!0}return r(t,[{key:"destroy",value:function(){this._isAlive=!1}},{key:"update",value:function(t){}},{key:"isAlive",get:function(){return this._isAlive}},{key:"model",get:function(){return this._model}},{key:"view",get:function(){return this._view}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(28);t.exports=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._model=t,n._view=new PIXI.Container,n._create(n._view),n}return o(e,t),a(e,[{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),void 0!==this._model.x&&(this._view.x=this._model.x),void 0!==this._model.y&&(this._view.y=this._model.y),void 0!==this._model.angle&&(this._view.rotation=this._model.angle*(Math.PI/180))}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.view.parent&&this.view.parent.removeChild(this.view)}},{key:"_create",value:function(t){}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(29);t.exports=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._hudView=new PIXI.Container,n._createHud(n._hudView),n}return o(e,t),a(e,[{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.view.rotation=0,this.body.rotation=this.model.angle*(Math.PI/180),this.gun.rotation=(this.model.angle+this.model.gunAngle)*(Math.PI/180),this.radar.rotation=(this.model.angle+this.model.radarAngle)*(Math.PI/180),this.energyBar.scale.x=this.model.energy/this.model.maxEnergy,this.label.text=this.model.fullName,this.hudView.x=this.view.x,this.hudView.y=this.view.y;for(var n=0;n<t.length;n++)this._onEvent(t[n])}},{key:"_onEvent",value:function(t){switch(t.type){case"shoot":this._onShoot(t);break;case"destroy":this._onDestroy(t)}}},{key:"_onShoot",value:function(t){}},{key:"_onDestroy",value:function(t){this.destroy()}},{key:"_create",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_create",this).call(this,t),this._body=this._createBody(),this._gun=this._createGun(),this._radar=this._createRadar(),t.addChild(this._body),t.addChild(this._gun),t.addChild(this._radar)}},{key:"_createHud",value:function(t){this._label=this._createLabel(),this._energyBar=this._createEnergyBar(),t.addChild(this._createHudBackground()),t.addChild(this._energyBar),t.addChild(this._label)}},{key:"_createBody",value:function(){return new PIXI.Sprite}},{key:"_createGun",value:function(){return new PIXI.Sprite}},{key:"_createRadar",value:function(){return new PIXI.Sprite}},{key:"_createHudBackground",value:function(){return new PIXI.Sprite}},{key:"_createEnergyBar",value:function(){return new PIXI.Sprite}},{key:"_createLabel",value:function(){return new PIXI.Text}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.hudView.parent&&this.hudView.parent.removeChild(this.hudView)}},{key:"body",get:function(){return this._body}},{key:"hudView",get:function(){return this._hudView}},{key:"gun",get:function(){return this._gun}},{key:"radar",get:function(){return this._radar}},{key:"label",get:function(){return this._label}},{key:"energyBar",get:function(){return this._energyBar}}]),e}(u)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(){n(this,t)}return r(t,[{key:"construct",value:function(){this._msElapsed=0,this._msLimit=0}},{key:"update",value:function(t,e){this._msElapsed=t,this._msLimit=e}},{key:"msElapsed",get:function(){return this._msElapsed}},{key:"msLimit",get:function(){return this._msLimit}},{key:"text",get:function(){var t=Math.max(0,this._msLimit-this._msElapsed),e=Math.floor(t/1e3),n=t%1e3;for(e=e.toString();e.length<2;)e="0"+e;for(n=n.toString();n.length<3;)n="0"+n;return"0:"+e+"."+n}}]),t}()},function(t,e,n){"use strict";function r(t){var e=t.split("/");return e.pop(),e.join("/")}function i(t,e){var n=t;this.done=function(){0===--n&&e()}}var o=n(33).Resource;t.exports=function(t){return function(e,n){if(!e.data||e.type!==o.TYPE.JSON||!e.data.meta||"pixi-packer"!==e.data.meta.type)return n();if(e.data.meta.version>1)throw new Error("pixi-packer manifest version "+e.data.meta.version+" not supported");var a=this,s={crossOrigin:e.crossOrigin,loadType:o.LOAD_TYPE.IMAGE,parentResource:e},u=e.url.replace(a.baseUrl,""),l=r(u),c=e.data.resolution;e.data.spritesheets.length&&100===a.progress&&(a.progress=0);var h=new i(e.data.spritesheets.length,n);e.data.spritesheets.forEach(function(e){var n=e.image,r=l+"/"+e.image;a.add(n,r,s,function(n){n.texture.baseTexture.resolution=c,n.texture.baseTexture.update(),n.textures={},e.sprites.forEach(function(e){var r,i=new t.Rectangle(e.position.x/c,e.position.y/c,e.dimension.w/c,e.dimension.h/c);r=Number(t.VERSION.charAt(0))>=4?new t.Rectangle(0,0,e.dimension.w/c,e.dimension.h/c):i.clone();var o=null;e.trim&&(Number(t.VERSION.charAt(0))>=4?(o=new t.Rectangle(e.trim.x/c,e.trim.y/c,e.trim.w/c,e.trim.h/c),i.width=e.trim.w/c,i.height=e.trim.h/c):(o=new t.Rectangle(e.trim.x/c,e.trim.y/c,i.width,i.height),r.width=e.trim.w/c,r.height=e.trim.h/c)),n.textures[e.name]=new t.Texture(n.texture.baseTexture,i,r,o,!1),t.utils.TextureCache[e.name]=n.textures[e.name]}),h.done()})})}}},function(t,e,n){"use strict";var r=n(34).default,i=n(38).default,o=n(37),a=n(39);r.Resource=i,r.async=o,r.base64=a,t.exports=r,t.exports.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.__esModule=!0;var a="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":o(t)},s=n(35),u=r(s),l=n(36),c=r(l),h=n(37),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(h),p=n(38),_=r(p),d=/(#[\w-]+)?$/,y=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;i(this,t),this.baseUrl=n,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,n){return e._loadResource(t,n)},this._queue=f.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new u.default,this.onError=new u.default,this.onLoad=new u.default,this.onStart=new u.default,this.onComplete=new u.default}return t.prototype.add=function(t,e,n,r){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"===(void 0===t?"undefined":a(t))&&(r=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(r=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new _.default(t,e,n),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],u=0;u<o.children.length;++u)o.children[u].isComplete||s.push(o.children[u]);var l=o.progressChunk*(s.length+1),c=l/(s.length+2);o.children.push(this.resources[t]),o.progressChunk=c;for(var h=0;h<s.length;++h)s[h].progressChunk=c;this.resources[t].progressChunk=c}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},t.prototype._prepareUrl=function(t){var e=(0,c.default)(t,{strictMode:!0}),n=void 0;if(n=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=d.exec(n)[0];n=n.substr(0,n.length-r.length),-1!==n.indexOf("?")?n+="&"+this.defaultQueryString:n+="?"+this.defaultQueryString,n+=r}return n},t.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,f.eachSeries(this._beforeMiddleware,function(e,r){e.call(n,t,function(){r(t.isComplete?{}:null)})},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())},!0)},t.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),f.eachSeries(this._afterMiddleware,function(n,r){n.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&(e.progress=100,e._onComplete())},!0)},t}();e.default=y},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,r,i){void 0===r&&(r=!1),n(this,t),this._fn=e,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return i(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}(),a=function(){function t(){n(this,t),this._head=this._tail=void 0}return i(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return r(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return r(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=o,e.default=a,t.exports=e.default},function(t,e){"use strict";t.exports=function(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[n.key[o]]=r[o]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,function(t,e,r){e&&(i[n.q.name][e]=r)}),i}},function(t,e){"use strict";function n(){}function r(t,e,n,r){var i=0,o=t.length;!function a(s){if(s||i===o)return void(n&&n(s));r?setTimeout(function(){e(t[i++],a)},1):e(t[i++],a)}()}function i(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function o(t,e){function r(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(s.started=!0,null==t&&s.idle())return void setTimeout(function(){return s.drain()},1);var i={data:t,callback:"function"==typeof r?r:n};e?s._tasks.unshift(i):s._tasks.push(i),setTimeout(function(){return s.process()},1)}function o(t){return function(){a-=1,t.callback.apply(t,arguments),null!=arguments[0]&&s.error(arguments[0],t.data),a<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var a=0,s={_tasks:[],concurrency:e,saturated:n,unsaturated:n,buffer:e/4,empty:n,drain:n,error:n,started:!1,paused:!1,push:function(t,e){r(t,!1,e)},kill:function(){a=0,s.drain=n,s.started=!1,s._tasks=[]},unshift:function(t,e){r(t,!0,e)},process:function(){for(;!s.paused&&a<s.concurrency&&s._tasks.length;){var e=s._tasks.shift();0===s._tasks.length&&s.empty(),a+=1,a===s.concurrency&&s.saturated(),t(e.data,i(o(e)))}},length:function(){return s._tasks.length},running:function(){return a},idle:function(){return s._tasks.length+a===0},pause:function(){!0!==s.paused&&(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var t=1;t<=s.concurrency;t++)s.process()}}};return s}e.__esModule=!0,e.eachSeries=r,e.queue=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){}function a(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function s(t){return t.toString().replace("object ","")}e.__esModule=!0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(36),c=r(l),h=n(35),f=r(h),p=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),_=null,d=function(){function t(e,n,r){if(i(this,t),"string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=o,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new f.default,this.onProgress=new f.default,this.onComplete=new f.default,this.onAfterMiddleware=new f.default}return t.setExtensionLoadType=function(e,n){a(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){a(t._xhrTypeMap,e,n)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var n=this;if(!this.isLoading){if(this.isComplete)return void(e&&setTimeout(function(){return e(n)},1));switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:p&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return void this.abort("Unsupported element: "+t);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(s(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(s(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(s(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===r&&n.length>0?r=200:1223===r&&(r=204),2!=(r/100|0))return void this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(n,"text/xml")}else{var o=document.createElement("div");o.innerHTML=n,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,_||(_=document.createElement("a")),_.href=t,t=(0,c.default)(_.href,{strictMode:!0});var n=!t.port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&n&&r===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(r>-1?r:t.length,i>-1?i:t.length);t=t.substring(0,o),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},u(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();e.default=d,d.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},d.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},d.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},d.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},d._loadTypeMap={gif:d.LOAD_TYPE.IMAGE,png:d.LOAD_TYPE.IMAGE,bmp:d.LOAD_TYPE.IMAGE,jpg:d.LOAD_TYPE.IMAGE,jpeg:d.LOAD_TYPE.IMAGE,tif:d.LOAD_TYPE.IMAGE,tiff:d.LOAD_TYPE.IMAGE,webp:d.LOAD_TYPE.IMAGE,tga:d.LOAD_TYPE.IMAGE,svg:d.LOAD_TYPE.IMAGE,"svg+xml":d.LOAD_TYPE.IMAGE,mp3:d.LOAD_TYPE.AUDIO,ogg:d.LOAD_TYPE.AUDIO,wav:d.LOAD_TYPE.AUDIO,mp4:d.LOAD_TYPE.VIDEO,webm:d.LOAD_TYPE.VIDEO},d._xhrTypeMap={xhtml:d.XHR_RESPONSE_TYPE.DOCUMENT,html:d.XHR_RESPONSE_TYPE.DOCUMENT,htm:d.XHR_RESPONSE_TYPE.DOCUMENT,xml:d.XHR_RESPONSE_TYPE.DOCUMENT,tmx:d.XHR_RESPONSE_TYPE.DOCUMENT,svg:d.XHR_RESPONSE_TYPE.DOCUMENT,tsx:d.XHR_RESPONSE_TYPE.DOCUMENT,gif:d.XHR_RESPONSE_TYPE.BLOB,png:d.XHR_RESPONSE_TYPE.BLOB,bmp:d.XHR_RESPONSE_TYPE.BLOB,jpg:d.XHR_RESPONSE_TYPE.BLOB,jpeg:d.XHR_RESPONSE_TYPE.BLOB,tif:d.XHR_RESPONSE_TYPE.BLOB,tiff:d.XHR_RESPONSE_TYPE.BLOB,webp:d.XHR_RESPONSE_TYPE.BLOB,tga:d.XHR_RESPONSE_TYPE.BLOB,json:d.XHR_RESPONSE_TYPE.JSON,text:d.XHR_RESPONSE_TYPE.TEXT,txt:d.XHR_RESPONSE_TYPE.TEXT,ttf:d.XHR_RESPONSE_TYPE.BUFFER,otf:d.XHR_RESPONSE_TYPE.BUFFER},d.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},function(t,e){"use strict";function n(t){for(var e="",n=0;n<t.length;){for(var i=[0,0,0],o=[0,0,0,0],a=0;a<i.length;++a)n<t.length?i[a]=255&t.charCodeAt(n++):i[a]=0;o[0]=i[0]>>2,o[1]=(3&i[0])<<4|i[1]>>4,o[2]=(15&i[1])<<2|i[2]>>6,o[3]=63&i[2];switch(n-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var s=0;s<o.length;++s)e+=r.charAt(o[s])}return e}e.__esModule=!0,e.encodeBinary=n;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(29);t.exports=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=new PIXI.Graphics;e.beginFill(0),e.lineStyle(1,16776960,.8),e.drawRect(0,0,this.model.width+2*this.model.margin,this.model.height+2*this.model.margin),e.endFill(),t.addChild(e),e=new PIXI.Graphics,e.beginFill(0),e.lineStyle(1,16776960,.8),e.drawRect(this.model.margin,this.model.margin,this.model.width,this.model.height),e.endFill(),t.addChild(e)}},{key:"update",value:function(t){}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(29);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._label=new PIXI.Text("clock",e),this._label.x=5,this._label.y=5,t.addChild(this._label)}},{key:"update",value:function(t){this._label.setText(this.model.text)}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(43);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=new PIXI.Graphics;e.beginFill(65280,.5),e.drawCircle(0,0,5),e.endFill(),t.addChild(e)}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(29);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.view.scale.x=this.view.scale.y=.7*this.model.power+.3,this.model.exploded&&this.destroy()}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(30);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_createBody",value:function(){var t=new PIXI.Graphics;return t.lineStyle(1,16776960,.8),t.beginFill(65280,.5),t.drawRect(-15,-15,30,30),t.endFill(),t}},{key:"_createGun",value:function(){var t=new PIXI.Graphics;return t.beginFill(65280,.5),t.lineStyle(1,16776960,.8),t.drawCircle(0,0,10),t.drawRect(0,-3,30,6),t.endFill(),t}},{key:"_createRadar",value:function(){var t=new PIXI.Graphics;t.beginFill(65280,.5),t.lineStyle(1,16776960,.8),t.drawRect(-3,-10,6,20),t.endFill(),t.lineStyle(),t.beginFill(11206570,.1),t.moveTo(0,-3);var e=300*Math.tan(Math.PI/180*6)/2;return t.lineTo(300,-e),t.lineTo(300,e),t.lineTo(0,3),t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:65280}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.lineStyle(1,16776960,.8),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(65280,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(26),l=n(46),c=n(47),h=n(48),f=n(49);t.exports=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"bw"));return t._bigBoomAnim=[],t._smallBoomAnim=[],t._shakeTimer=0,t}return o(e,t),a(e,[{key:"onAssetsLoaded",value:function(){for(var t=0;t<=9;t++)this._bigBoomAnim.push(PIXI.Texture.fromFrame("big_boom_00"+t)),this._smallBoomAnim.push(PIXI.Texture.fromFrame("small_boom_00"+t))}},{key:"initBatlefield",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t)}},{key:"renderTank",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n),0==t.energy&&(this._shakeTimer=10,this._addExplosion(t.x,t.y,this._bigBoomAnim))}},{key:"renderBullet",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n),t.exploded&&this._addExplosion(t.x,t.y,this._smallBoomAnim)}},{key:"postRender",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY)}},{key:"_createBattlefieldView",value:function(t){return new l(t)}},{key:"_createClockView",value:function(t){return new c(t)}},{key:"_createBulletView",value:function(t){return new h(t)}},{key:"_createTankView",value:function(t){return new f(t)}},{key:"_addExplosion",value:function(t,e,n){var r=new PIXI.extras.AnimatedSprite(n);r.anchor.set(.5),this.masterContainer.addChild(r),r.x=t,r.y=e,r.loop=!1,r.onComplete=function(){this.stop(),this.parent.removeChild(this)},r.play()}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(29);t.exports=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("battlefield");t.addChild(e)}},{key:"update",value:function(t){}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(29);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new PIXI.Text("clock",e),this._label.x=10,this._label.y=580,t.addChild(this._label)}},{key:"update",value:function(t){this._label.setText(this.model.text)}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(43);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("bullet");e.anchor.set(.5),t.addChild(e)}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(30);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._shoot.alpha=this.model.isShooting?1:.7*this._shoot.alpha}},{key:"_createBody",value:function(){var t=PIXI.Sprite.fromFrame("tank_body");return t.anchor.set(.5),t}},{key:"_createGun",value:function(){var t=new PIXI.Container,e=PIXI.Sprite.fromFrame("tank_gun");return e.anchor.set(.3,.5),t.addChild(e),this._shoot=PIXI.Sprite.fromFrame("tank_shoot"),this._shoot.anchor.set(-1.2,.5),this._shoot.alpha=0,t.addChild(this._shoot),t}},{key:"_createRadar",value:function(){var t=PIXI.Sprite.fromFrame("tank_radar");return t.anchor.set(.5),t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:0}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(16711680,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(26),l=n(51),c=n(52),h=n(53),f=n(54),p=n(55);t.exports=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"brody"));return t._bigBoomAnim=[],t._shakeTimer=0,t._particleContainer=null,t._particleList=[],t._explosionList=[],t._settings=new p,t._masterContainer.addChild(t._bulletContainer),t._frameTimer=0,t._frameCounter=0,t._fpsInterval=null,t._fps=30,t}return o(e,t),a(e,[{key:"onAssetsLoaded",value:function(){var t;for(t=0;t<=22;t++)this._bigBoomAnim.push(PIXI.Texture.fromFrame("big_boom_0"+(t<10?"0"+t:t)))}},{key:"initBatlefield",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t),this.battlefieldView.configure(this._settings),this._particleContainer=new PIXI.particles.ParticleContainer(1e3,{position:!0,rotation:!0,alpha:!0}),this._masterContainer.addChild(this._particleContainer),this._masterContainer.addChild(this._hudContainer);var n=this;this._fpsInterval=setInterval(function(){n._fps=n._frameCounter,n._frameCounter=0},1e3)}},{key:"renderTank",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n);var r;for(r in n)if("destroy"==n[r].type){this._shakeTimer=10,this._addTankExplosion(t);break}var i=t.throttle>0?180:0,o=(t.angle+i)*(Math.PI/180);if(t.speed>1){var a=t.x+20*Math.cos(o-Math.PI/4)+7*Math.cos(o),u=t.y+20*Math.sin(o-Math.PI/4)+7*Math.sin(o),l=t.x+20*Math.cos(o+Math.PI/4)+7*Math.cos(o),c=t.y+20*Math.sin(o+Math.PI/4)+7*Math.sin(o);Math.random()<this.speedMultiplier&&(this._addDirt(a,u),this._addDirt(l,c))}}},{key:"renderBullet",value:function(t,n){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n),this.getBulletView(t.id).configure(this._settings),t.exploded&&(this._addBulletExplosion(t),this.battlefieldView.addBulletHole(t.x,t.y,t.power))}},{key:"preRender",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"preRender",this).call(this);var t,n,r=0;for(n=this._particleList.length-1;n>=0;n--)(t=this._particleList[n])&&(t.x+=this.speedMultiplier*t.speed*t.rotation*Math.cos(t.rotation),t.y+=this.speedMultiplier*t.speed*t.rotation*Math.sin(t.rotation),t.alpha=Math.max(0,t.alpha-this.speedMultiplier*t.alphaSpeed),t.lifetime-=this.speedMultiplier,t.lifetime<=0||r>this._settings.particleLimit?(t.parent.removeChild(t),this._particleList[n]=null):r++);for(n=0;n<this._explosionList.length;n++)this._explosionList[n]&&(this._explosionList[n].alpha=this._explosionList[n].alpha-.12*this.speedMultiplier,this._explosionList[n].alpha<.01&&(this._explosionList[n].parent.removeChild(this._explosionList[n]),this._explosionList[n]=null))}},{key:"postRender",value:function(){this._frameTimer++,this._frameCounter++,this._frameTimer%this._settings.dropFrames==0&&s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY,this._battlefieldView.view.x=10*Math.random()-5,this._battlefieldView.view.y=10*Math.random()-5):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY,this._battlefieldView.view.x=0,this._battlefieldView.view.y=0)}},{key:"stop",value:function(){this._fpsInterval&&clearInterval(this._fpsInterval)}},{key:"_addTankExplosion",value:function(t){this._addExplosion(t.x,t.y,this._bigBoomAnim),this.battlefieldView.addCrater(t.x,t.y),this._addSparks(t.x,t.y,300)}},{key:"_addBulletExplosion",value:function(t){this._addGlow(t.x,t.y,.3+.6*t.power);var e=5+40*t.power;this._addSparks(t.x,t.y,e)}},{key:"_createBattlefieldView",value:function(t){return new l(t)}},{key:"_createClockView",value:function(t){return new c(t)}},{key:"_createBulletView",value:function(t){return new h(t)}},{key:"_createTankView",value:function(t){return new f(t)}},{key:"_addExplosion",value:function(t,e,n){this._addGlow(t,e,5);var r=new PIXI.extras.AnimatedSprite(n);r.animationSpeed=this.speedMultiplier,r.anchor.set(.5),this.masterContainer.addChild(r),r.x=t,r.y=e,r.loop=!1,r.blendMode=PIXI.BLEND_MODES.ADD,r.onComplete=function(){this.stop(),this.parent.removeChild(this)},r.play()}},{key:"_addGlow",value:function(t,e,n){if(this._settings.showGlow){var r=PIXI.Sprite.fromFrame("glow");r.anchor.set(.5),r.scale.x=r.scale.y=n,r.alpha=.4,r.blendMode=PIXI.BLEND_MODES.ADD,r.x=t,r.y=e,this.masterContainer.addChild(r),this._explosionList.push(r)}}},{key:"_addSparks",value:function(t,e,n){n=Math.ceil(n*this._settings.quality);for(var r=0;r<n;r++){var i=PIXI.Sprite.fromFrame("spark");i.x=t,i.y=e,i.alphaSpeed=0,i.anchor.set(.5),i.speed=1+2*Math.random(),i.rotation=2*Math.random()*Math.PI,i.lifetime=5+5*Math.random(),this._particleContainer.addChild(i),this._particleList.push(i)}}},{key:"_addDirt",value:function(t,e){if(this._settings.showDirt)for(var n=0;n<5;n++){var r=Math.floor(3*Math.random()),i=PIXI.Sprite.fromFrame("dirt_"+r);i.x=t+4*Math.random()-2,i.y=e+4*Math.random()-2,i.anchor.set(.5),i.speed=0,i.alphaSpeed=.02+.02*Math.random(),i.rotation=0,i.alpha=.1+.4*Math.random(),i.lifetime=25,i.scale.x=i.scale.y=.5+2*Math.random(),this._particleContainer.addChild(i),this._particleList.push(i)}}},{key:"quality",get:function(){return this._settings.quality},set:function(t){this._settings.quality=t}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(29);t.exports=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._holeList=[],n._settings=null,n}return o(e,t),a(e,[{key:"configure",value:function(t){this._settings=t}},{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("battlefield");t.addChild(e);var n=new PIXI.Graphics;n.beginFill(255,1),n.moveTo(25,25),n.lineTo(875,25),n.lineTo(875,575),n.lineTo(90,575),n.lineTo(90,565),n.lineTo(25,565),n.lineTo(25,25),n.endFill(),this._craterContainer=new PIXI.Container,this._craterContainer.mask=n,t.addChild(this._craterContainer),t.addChild(n);var r=new PIXI.Graphics;r.beginFill(255,.4),r.moveTo(15,15),r.lineTo(885,15),r.lineTo(885,585),r.lineTo(80,585),r.lineTo(80,575),r.lineTo(15,575),r.lineTo(15,15),r.lineTo(25,25),r.lineTo(25,575),r.lineTo(80,575),r.lineTo(80,575),r.lineTo(875,575),r.lineTo(875,25),r.lineTo(25,25),r.endFill(),this._holesContainer=new PIXI.Container,this._holesContainer.mask=r,t.addChild(this._holesContainer),t.addChild(r)}},{key:"addCrater",value:function(t,e){var n=PIXI.Sprite.fromFrame("crater");n.anchor.set(.5),n.x=t-this.model.offsetX,n.y=e-this.model.offsetY,n.blendMode=PIXI.BLEND_MODES.MULTIPLY,n.alpha=.8,this._craterContainer.addChild(n)}},{key:"update",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this._holesContainer.visible=this._settings.skratchLimit>0,this._craterContainer.visible=this._settings.showCraters}},{key:"addBulletHole",value:function(t,e,n){var r=0;if(Math.abs(e-this.model.maxY)<10)e=this.model.maxY+3+3*Math.random();else if(Math.abs(e-this.model.minY)<10)e=this.model.minY-3-3*Math.random();else if(Math.abs(t-this.model.maxX)<10)t=this.model.maxX+3+3*Math.random(),r=Math.PI/2;else{if(!(Math.abs(t-this.model.minX)<10))return;t=this.model.minX-3-3*Math.random(),r=Math.PI/2}var i=PIXI.Sprite.fromFrame("hole");i.anchor.set(.5),i.x=t-this.model.offsetX,i.y=e-this.model.offsetY,i.rotation=r,i.scale.x=i.scale.y=.7+.5*n,this._holesContainer.addChild(i),this._holeList.push(i);for(var o=this._settings?this._settings.skratchLimit:20;this._holeList.length>o;)i=this._holeList.shift(),i.parent.removeChild(i)}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(29);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new PIXI.Text("clock",e),this._label.x=10,this._label.y=580,t.addChild(this._label)}},{key:"update",value:function(t){this._label.setText(this.model.text)}}]),e}(s)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(43);t.exports=function(t){function e(t,n){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"configure",value:function(t){this._settings=t}},{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._glow.visible=this._settings&&this._settings.showGlow}},{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("bullet");e.anchor.set(.5);var n=PIXI.Sprite.fromFrame("glow");n.anchor.set(.5),n.blendMode=PIXI.BLEND_MODES.ADD,n.alpha=.1,this._glow=n,t.addChild(n),t.addChild(e)}}]),e}(u)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(30);t.exports=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._lightTimer=0,n}return o(e,t),a(e,[{key:"update",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._shoot.alpha=.8*this._shoot.alpha,this._tankGun.x=.8*this._tankGun.x,this.radar.rotation=(-this.model.gunAngle+this._model.radarAngle)*(Math.PI/180),this._lightTimer=this.model.enemySpot?this._lightTimer+1:0,this._light.alpha=.5*-Math.cos(.25*this._lightTimer)+.5}},{key:"_onShoot",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_onShoot",this).call(this,t),this._tankGun.x=-1-3*t.bullet.power,this._shoot.alpha=1}},{key:"_create",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_create",this).call(this,t),this._tankGun.addChild(this.radar)}},{key:"_createBody",value:function(){var t=PIXI.Sprite.fromFrame("tank_body_"+this.model.skin);return t.anchor.set(.3,.5),t}},{key:"_createGun",value:function(){var t=new PIXI.Container,e=PIXI.Sprite.fromFrame("tank_gun_"+this.model.skin);return e.anchor.set(.3,.5),t.addChild(e),this._tankGun=e,this._shoot=PIXI.Sprite.fromFrame("tank_shoot"),this._shoot.anchor.set(.3,.5),this._shoot.alpha=0,this._light=PIXI.Sprite.fromFrame("tank_light"),this._light.anchor.set(.3,.5),this._light.alpha=0,t.addChild(this._shoot),t.addChild(this._light),t}},{key:"_createRadar",value:function(){var t=PIXI.Sprite.fromFrame("tank_radar_"+this.model.skin);return t.anchor.set(.2,.5),t.x=-5,t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:10,stroke:0,strokeThickness:2,fill:16777147}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(16777113,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}(u)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),this._particleLimit=1e3,this._skratchLimit=100,this._showDirt=!0,this._showGlow=!0,this._showCraters=!0,this._dropFrames=1,this._quality=1,this.quality=this._quality}return r(t,[{key:"dropFrames",get:function(){return this._dropFrames}},{key:"particleLimit",get:function(){return this._particleLimit}},{key:"skratchLimit",get:function(){return this._skratchLimit}},{key:"showDirt",get:function(){return this._showDirt}},{key:"showGlow",get:function(){return this._showGlow}},{key:"showCraters",get:function(){return this._showCraters}},{key:"quality",get:function(){return this._quality},set:function(t){t=Math.min(1,Math.max(0,t)),this._quality=t,this._particleLimit=Math.round(1e3*t*t),this._skratchLimit=Math.round(100*t),this._showDirt=t>.2,this._showGlow=t>.5,this._showCraters=t>.1,this._dropFrames=t>.3?1:t>.2?2:t>.1?3:4,this._quality=t}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=!1,o=function(){function t(){n(this,t),this._name="",this._code=null,this._initData=null,this._useSandbox=!0,this._executionLimit=100}return r(t,[{key:"fromFile",value:function(t,e){if(!t)throw"TankName is required";this._name=t,this._code=null,this._initData=void 0!==e?e:null}},{key:"fromCode",value:function(t,e,n){if(!t)throw"TankName is required";if(!e)throw"Code is required";e=e.replace(/importScripts\w*\([^\)]*\)/g,""),this._name=t,this._code=e,this._initData=void 0!==n?n:null}},{key:"disableSandbox",value:function(){if(!this._code)throw"Sandbox can be disabled for AI created from code only.";i||(console.warn("Disabling sandbox for AI! It could be dangerous."),i=!0),this._useSandbox=!1}},{key:"name",get:function(){return this._name}},{key:"executionLimit",get:function(){return this._executionLimit},set:function(t){this._executionLimit=t}},{key:"filePath",get:function(){return this._useSandbox?this._code?"tanks/lib/codeWorker.js":"tanks/"+this._name+".tank.js":null}},{key:"code",get:function(){return this._code}},{key:"initData",get:function(){return this._initData}},{key:"useSandbox",get:function(){return this._useSandbox}}]),t}();t.exports=o}]);
//# sourceMappingURL=jsbattle.min.js.map