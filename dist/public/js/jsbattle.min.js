var JsBattle=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(11),s=(i=a)&&i.__esModule?i:{default:i};var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._model=t,n._view=new PIXI.Container,n._create(n._view),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),void 0!==this._model.x&&(this._view.x=this._model.x),void 0!==this._model.y&&(this._view.y=this._model.y),void 0!==this._model.angle&&(this._view.rotation=this._model.angle*(Math.PI/180))}},{key:"destroy",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.view.parent&&this.view.parent.removeChild(this.view)}},{key:"_create",value:function(t){}}]),e}();e.default=u},function(t,e,n){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(1),s=(i=a)&&i.__esModule?i:{default:i};var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._hudView=new PIXI.Container,n._createHud(n._hudView),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.view.rotation=0,this.body.rotation=this.model.angle*(Math.PI/180),this.gun.rotation=(this.model.angle+this.model.gunAngle)*(Math.PI/180),this.radar.rotation=(this.model.angle+this.model.radarAngle)*(Math.PI/180),this.energyBar.scale.x=this.model.energy/this.model.maxEnergy,this.label.text=this.model.fullName,this.hudView.x=this.view.x,this.hudView.y=this.view.y;for(var n=0;n<t.length;n++)this._onEvent(t[n])}},{key:"_onEvent",value:function(t){switch(t.type){case"shoot":this._onShoot(t);break;case"destroy":this._onDestroy(t)}}},{key:"_onShoot",value:function(t){}},{key:"_onDestroy",value:function(t){this.destroy()}},{key:"_create",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_create",this).call(this,t),this._body=this._createBody(),this._gun=this._createGun(),this._radar=this._createRadar(),t.addChild(this._body),t.addChild(this._gun),t.addChild(this._radar)}},{key:"_createHud",value:function(t){this._label=this._createLabel(),this._energyBar=this._createEnergyBar(),t.addChild(this._createHudBackground()),t.addChild(this._energyBar),t.addChild(this._label)}},{key:"_createBody",value:function(){return new PIXI.Sprite}},{key:"_createGun",value:function(){return new PIXI.Sprite}},{key:"_createRadar",value:function(){return new PIXI.Sprite}},{key:"_createHudBackground",value:function(){return new PIXI.Sprite}},{key:"_createEnergyBar",value:function(){return new PIXI.Sprite}},{key:"_createLabel",value:function(){return new PIXI.Text}},{key:"destroy",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.hudView.parent&&this.hudView.parent.removeChild(this.hudView)}},{key:"body",get:function(){return this._body}},{key:"hudView",get:function(){return this._hudView}},{key:"gun",get:function(){return this._gun}},{key:"radar",get:function(){return this._radar}},{key:"label",get:function(){return this._label}},{key:"energyBar",get:function(){return this._energyBar}}]),e}();e.default=u},function(t,e,n){"use strict";var i=n(19),r=n(20),o=n(21),a=n(22),s=n(23),u=n(24),l=n(25);l.alea=i,l.xor128=r,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=u,t.exports=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"initBatlefield",value:function(t){}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"renderTank",value:function(t,e){}},{key:"renderClock",value:function(t,e){}},{key:"renderTankStats",value:function(t){}},{key:"renderBullet",value:function(t,e){}},{key:"setSpeed",value:function(t){}},{key:"stop",value:function(){}},{key:"quality",get:function(){return 1},set:function(t){}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=c(n(38)),a=c(n(1)),s=c(n(4)),u=c(n(39)),l=c(n(40));function c(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(n._name=t,"undefined"==typeof PIXI)throw"Pixi.js is required!";return n._masterContainer=new PIXI.Container,n._tankContainer=new PIXI.Container,n._bulletContainer=new PIXI.Container,n._hudContainer=new PIXI.Container,n._masterContainer.addChild(n._tankContainer),n._masterContainer.addChild(n._bulletContainer),n._masterContainer.addChild(n._hudContainer),n._renderer=null,n._stage=null,n._clockModel=new u.default,n._clockView=null,n._battlefieldView=null,window.devicePixelRatio>=2?n._rendererScale=2:n._rendererScale=1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"initBatlefield",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t),this._masterContainer.x=-this.offsetX,this._masterContainer.y=-this.offsetY;var n={view:this._canvas,antialias:!1,backgroundColor:16777215,resolution:window.devicePixelRatio};this._renderer=new PIXI.autoDetectRenderer(t.width+2*t.margin,t.height+2*t.margin,n),this._stage=new PIXI.Container,this._battlefieldView=this._createBattlefieldView(t),this._clockView=this._createClockView(this._clockModel),this._stage.addChild(this._battlefieldView.view),this._stage.addChild(this._masterContainer),this._stage.addChild(this._clockView.view),this._renderer.render(this._stage)}},{key:"init",value:function(t){this._canvas=t}},{key:"loadAssets",value:function(t){if(this._name){var e=new PIXI.loaders.Loader;e.after((0,l.default)(PIXI));var n=2==this._rendererScale?"retina":"web";e.add("img/game_"+this._name+"_"+n+".json");var i=this;e.load(function(){i.onAssetsLoaded(),t()})}else t()}},{key:"onAssetsLoaded",value:function(){}},{key:"preRender",value:function(){this._battlefieldView.update()}},{key:"renderTank",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n);var i=this.getTankView(t.id);!i.parent&&i.isAlive&&(this._tankContainer.addChild(i.view),this._hudContainer.addChild(i.hudView))}},{key:"renderBullet",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n);var i=this.getBulletView(t.id);!i.parent&&i.isAlive&&this._bulletContainer.addChild(i.view)}},{key:"renderClock",value:function(t,e){this._clockModel.update(t,e),this._clockView.update()}},{key:"postRender",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._renderer.render(this._stage)}},{key:"_createTankView",value:function(t){return new s.default(t)}},{key:"_createBulletView",value:function(t){return new a.default(t)}},{key:"_createBattlefieldView",value:function(t){return new a.default(t)}},{key:"_createClockView",value:function(t){return new a.default(t)}},{key:"stage",get:function(){return this._stage}},{key:"battlefieldView",get:function(){return this._battlefieldView}},{key:"masterContainer",get:function(){return this._masterContainer}}]),e}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"update",value:function(t){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.view.scale.x=this.view.scale.y=.7*this.model.power+.3,this.model.exploded&&this.destroy()}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(10),a=(i=o)&&i.__esModule?i:{default:i};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._version=2,this._aiList=[],this._rngSeed=(new Date).getTime(),this._teamMode=!1}return r(t,[{key:"addAiDefinition",value:function(t){this._aiList.push(t)}},{key:"setTeamMode",value:function(t){this._teamMode=t}},{key:"getTeamMode",value:function(){return this._teamMode}},{key:"setRngSeed",value:function(t){this._rngSeed=t}},{key:"getVersion",value:function(){return this._version}},{key:"getAiList",value:function(){return this._aiList}},{key:"getRngSeed",value:function(){return this._rngSeed}},{key:"encode",value:function(){var t={version:this._version,rngSeed:this._rngSeed,teamMode:this._teamMode,aiList:[]},e=!0,n=!1,i=void 0;try{for(var r,o=this._aiList[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;t.aiList.push(a.toJSON())}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return JSON.stringify(t)}},{key:"decode",value:function(t){var e=void 0;try{e=JSON.parse(t)}catch(t){throw new Error("Cannot parse UBD file! "+t)}if(this._version!=e.version)throw new Error("Version of UBD does not match. Version "+e.version+" is not supported. Please convert to version "+this._version);this._rngSeed=e.rngSeed,this._teamMode=e.teamMode;var n=void 0,i=!0,r=!1,o=void 0;try{for(var s,u=e.aiList[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;(n=new a.default).fromJSON(l),this._aiList.push(n)}}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"clone",value:function(){var e=new t;e.setRngSeed(this.getRngSeed()),e.setTeamMode(this.getTeamMode());var n=this.getAiList(),i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;u.clone(),e.addAiDefinition(u)}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return e}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=!1,o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=(new Date).getTime().toString();e=e.substr(e.length-6,6)+""+Math.round(1e7*Math.random()),e=(e=Number(e)).toString(35),this._name="",this._team=e,this._code=null,this._initData=null,this._useSandbox=!0,this._executionLimit=100}return i(t,[{key:"toJSON",value:function(){return{name:this._name,team:this._team,code:this._code,initData:this._initData,useSandbox:this._useSandbox,executionLimit:this.executionLimit}}},{key:"fromJSON",value:function(t){this._name=t.name,this._team=t.team,this._code=t.code,this._initData=t.initData,this._useSandbox=t.useSandbox,this._executionLimit=t.executionLimit}},{key:"clone",value:function(){var e=new t;return e.fromJSON(this.toJSON()),e}},{key:"fromFile",value:function(t,e){if(!t)throw"TankName is required";this._name=t,this._code=null,this._initData=void 0!==e?e:null}},{key:"fromCode",value:function(t,e,n){if(!t)throw"TankName is required";if(!e)throw"Code is required";e=e.replace(/importScripts\w*\([^\)]*\)/g,""),this._name=t,this._code=e,this._initData=void 0!==n?n:null}},{key:"assignToTeam",value:function(t){this._team=t}},{key:"disableSandbox",value:function(){if(!this._code)throw"Sandbox can be disabled for AI created from code only.";r||(console.warn("Disabling sandbox for AI! It could be dangerous."),r=!0),this._useSandbox=!1}},{key:"name",get:function(){return this._name}},{key:"teamName",get:function(){return this._team}},{key:"executionLimit",get:function(){return this._executionLimit},set:function(t){this._executionLimit=t}},{key:"filePath",get:function(){return this._useSandbox?this._code?"tanks/lib/codeWorker.js":"tanks/"+this._name+".tank.js":null}},{key:"code",get:function(){return this._code}},{key:"initData",get:function(){return this._initData}},{key:"useSandbox",get:function(){return this._useSandbox}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._model=e,this._view=null,this._isAlive=!0}return i(t,[{key:"destroy",value:function(){this._isAlive=!1}},{key:"update",value:function(t){}},{key:"isAlive",get:function(){return this._isAlive}},{key:"model",get:function(){return this._model}},{key:"view",get:function(){return this._view}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,n,i){void 0===n&&(n=!1),r(this,t),this._fn=e,this._once=n,this._thisArg=i,this._next=this._prev=this._owner=null}return i(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function a(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var s=function(){function t(){r(this,t),this._head=this._tail=void 0}return i(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return a(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return a(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();s.MiniSignalBinding=o,e.default=s,t.exports=e.default},function(t,e,n){"use strict";t.exports=function(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),r={},o=14;o--;)r[n.key[o]]=i[o]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,function(t,e,i){e&&(r[n.q.name][e]=i)}),r}},function(t,e,n){"use strict";function i(){}function r(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}e.__esModule=!0,e.eachSeries=function(t,e,n,i){var r=0,o=t.length;!function a(s){s||r===o?n&&n(s):i?setTimeout(function(){e(t[r++],a)},1):e(t[r++],a)}()},e.queue=function(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var n=0,o={_tasks:[],concurrency:e,saturated:i,unsaturated:i,buffer:e/4,empty:i,drain:i,error:i,started:!1,paused:!1,push:function(t,e){a(t,!1,e)},kill:function(){n=0,o.drain=i,o.started=!1,o._tasks=[]},unshift:function(t,e){a(t,!0,e)},process:function(){for(;!o.paused&&n<o.concurrency&&o._tasks.length;){var e=o._tasks.shift();0===o._tasks.length&&o.empty(),(n+=1)===o.concurrency&&o.saturated(),t(e.data,r(s(e)))}},length:function(){return o._tasks.length},running:function(){return n},idle:function(){return o._tasks.length+n===0},pause:function(){!0!==o.paused&&(o.paused=!0)},resume:function(){if(!1!==o.paused){o.paused=!1;for(var t=1;t<=o.concurrency;t++)o.process()}}};function a(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(o.started=!0,null==t&&o.idle())setTimeout(function(){return o.drain()},1);else{var r={data:t,callback:"function"==typeof n?n:i};e?o._tasks.unshift(r):o._tasks.push(r),setTimeout(function(){return o.process()},1)}}function s(t){return function(){n-=1,t.callback.apply(t,arguments),null!=arguments[0]&&o.error(arguments[0],t.data),n<=o.concurrency-o.buffer&&o.unsaturated(),o.idle()&&o.drain(),o.process()}}return o}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(13)),o=a(n(12));function a(t){return t&&t.__esModule?t:{default:t}}var s=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),u=null;function l(){}var c=function(){function t(e,n,i){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=l,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new o.default,this.onProgress=new o.default,this.onComplete=new o.default,this.onAfterMiddleware=new o.default}return t.setExtensionLoadType=function(e,n){h(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){h(t._xhrTypeMap,e,n)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(n)},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:s&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=n,i},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(f(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(f(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(f(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===i&&n.length>0?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(n,"text/xml")}else{var o=document.createElement("div");o.innerHTML=n,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,u||(u=document.createElement("a")),u.href=t;var n=!(t=(0,r.default)(u.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,i=t.protocol?t.protocol+":":"";return t.host===e.hostname&&n&&i===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var i=t.indexOf("?"),r=t.indexOf("#"),o=Math.min(i>-1?i:t.length,r>-1?r:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function h(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function f(t){return t.toString().replace("object ","")}e.default=c,c.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},c.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},c.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},c.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},c._loadTypeMap={gif:c.LOAD_TYPE.IMAGE,png:c.LOAD_TYPE.IMAGE,bmp:c.LOAD_TYPE.IMAGE,jpg:c.LOAD_TYPE.IMAGE,jpeg:c.LOAD_TYPE.IMAGE,tif:c.LOAD_TYPE.IMAGE,tiff:c.LOAD_TYPE.IMAGE,webp:c.LOAD_TYPE.IMAGE,tga:c.LOAD_TYPE.IMAGE,svg:c.LOAD_TYPE.IMAGE,"svg+xml":c.LOAD_TYPE.IMAGE,mp3:c.LOAD_TYPE.AUDIO,ogg:c.LOAD_TYPE.AUDIO,wav:c.LOAD_TYPE.AUDIO,mp4:c.LOAD_TYPE.VIDEO,webm:c.LOAD_TYPE.VIDEO},c._xhrTypeMap={xhtml:c.XHR_RESPONSE_TYPE.DOCUMENT,html:c.XHR_RESPONSE_TYPE.DOCUMENT,htm:c.XHR_RESPONSE_TYPE.DOCUMENT,xml:c.XHR_RESPONSE_TYPE.DOCUMENT,tmx:c.XHR_RESPONSE_TYPE.DOCUMENT,svg:c.XHR_RESPONSE_TYPE.DOCUMENT,tsx:c.XHR_RESPONSE_TYPE.DOCUMENT,gif:c.XHR_RESPONSE_TYPE.BLOB,png:c.XHR_RESPONSE_TYPE.BLOB,bmp:c.XHR_RESPONSE_TYPE.BLOB,jpg:c.XHR_RESPONSE_TYPE.BLOB,jpeg:c.XHR_RESPONSE_TYPE.BLOB,tif:c.XHR_RESPONSE_TYPE.BLOB,tiff:c.XHR_RESPONSE_TYPE.BLOB,webp:c.XHR_RESPONSE_TYPE.BLOB,tga:c.XHR_RESPONSE_TYPE.BLOB,json:c.XHR_RESPONSE_TYPE.JSON,text:c.XHR_RESPONSE_TYPE.TEXT,txt:c.XHR_RESPONSE_TYPE.TEXT,ttf:c.XHR_RESPONSE_TYPE.BUFFER,otf:c.XHR_RESPONSE_TYPE.BUFFER},c.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},function(t,e,n){"use strict";var i=h(n(17)),r=h(n(6)),o=h(n(37)),a=h(n(48)),s=h(n(53)),u=h(n(59)),l=h(n(10)),c=h(n(9));function h(t){return t&&t.__esModule?t:{default:t}}t.exports={createSimulation:function(t){return t=t||new r.default,new i.default(t)},createAiDefinition:function(){return new l.default},createUBD:function(){return new c.default},createRenderer:function(t){switch(t){case"debug":return new o.default;case"bw":return new a.default;case"brody":return new s.default;case"void":return new u.default;default:throw"Unknown rederer "+t}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=_(n(18)),a=_(n(27)),s=_(n(28)),u=_(n(29)),l=_(n(30)),c=_(n(31)),h=_(n(33)),f=_(n(36)),d=_(n(9)),p=_(n(5));function _(t){return t&&t.__esModule?t:{default:t}}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._aiList=[],this._allTankList=[],this._tankList=[],this._bulletList=[],this._explodedTankList=[],this._explodedBulletList=[],this._battlefield=null,this._simulationTimeout=null,this._renderInterval=null,this._simulationStepDuration=17,this._renderStepDuration=30,this._renderer=e,this._isRunning=!1,this._collisionResolver=new c.default,this._rngSeed=(new Date).getTime()+Math.round(1e6*Math.random()),this._rng=(0,p.default)(this._rngSeed),this._speedMultiplier=1,this._onSimulationStepCallback=[],this._onRenderStepCallback=[],this._onFinishCallback=[],this._onErrorCallback=[],this._onStartCallback=[],this._timeElapsed=0,this._timeLimit=3e4,this._eventStore=new l.default,this._nextTankId=1,this._nextBulletId=1,this._rendererQuality="auto",this._perfMon=new f.default,this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._callStackLimit=Number.MAX_VALUE,this._callStackCount=0,this._teamMap=[],this._teamList=[],this._ultimateBattleDescriptor=new d.default}return r(t,[{key:"setRngSeed",value:function(t){this._rngSeed=t,this._ultimateBattleDescriptor.setRngSeed(t),this._rng=(0,p.default)(this._rngSeed)}},{key:"getRngSeed",value:function(){return this._rngSeed}},{key:"getRandom",value:function(){return this._rng()}},{key:"init",value:function(t,e){this._battlefield=new u.default,this._battlefield.setSize(t,e),this._battlefield.randomize(this._rng()),this._renderer.initBatlefield(this._battlefield),this._collisionResolver.updateBattlefield(this._battlefield)}},{key:"start",value:function(){this._isRunning=!0;var t=void 0,e=this;this._renderInterval&&(clearInterval(this._renderInterval),this._renderInterval=null),this._activateAi(function(){for(e._renderInterval=setInterval(function(){e._updateView()},e._renderStepDuration),e._simulationTimeout&&clearTimeout(e._simulationTimeout),e._perfMon.start(),t=0;t<e._onStartCallback.length;t++)e._onStartCallback[t]();e._simulationStep()},function(n){for(console.error(n),t=0;t<e._onErrorCallback.length;t++)e._onErrorCallback[t](n.message?n.message:"Error during simulation")})}},{key:"_simulationStep",value:function(){this._perfMon.onSimulationStep();var t=(new Date).getTime(),e=this,n=void 0;this._updateModel(),this._updateAi(function(){if(e._simulationTimeout&&(clearTimeout(e._simulationTimeout),e._simulationTimeout=null),e._getTeamsLeft()<=1||e._timeElapsed==e._timeLimit)for(e.stop(),e._updateModel(),e._updateView(),n=0;n<e._onFinishCallback.length;n++)e._onFinishCallback[n]();if(e._isRunning){var i=(new Date).getTime()-t,r=e._simulationStepDuration-i;for(r/=e._speedMultiplier,r=Math.round(r),n=0;n<e._onSimulationStepCallback.length;n++)e._onSimulationStepCallback[n]();e._timeElapsed=Math.min(e._timeElapsed+e._simulationStepDuration,e._timeLimit),r>0?(e._callStackCount=0,e._simulationTimeout=setTimeout(e._simulationStep.bind(e),r)):e._callStackCount>=e._callStackLimit?e._simulationTimeout=setTimeout(e._simulationStep.bind(e),1):(e._callStackCount++,e._simulationStep())}},function(t){for(console.error(t),n=0;n<e._onErrorCallback.length;n++)e._onErrorCallback[n](t.message?t.message:"Error during simulation")})}},{key:"addTank",value:function(t){if("object"!=(void 0===t?"undefined":i(t)))throw"AI definition must be an object";if(!this._battlefield)throw"Simulation not initialized";if(!t.teamName)throw"Team name cannot be empty!";var e=this._battlefield.getStartSlot();if(!e)throw"No free space in the battlefield";this._ultimateBattleDescriptor.addAiDefinition(t),this._ultimateBattleDescriptor.setTeamMode(this.hasTeams());var n=this._createTank(t);n.randomize(this.getRandom()),n.moveTo(e.x,e.y),this._tankList.push(n),this._allTankList.push(n),this._allTankList.length>2&&(this._timeLimit+=2e3),this._teamMap[t.teamName]||(this._teamMap[t.teamName]=new a.default(t.teamName),this._teamList.push(this._teamMap[t.teamName])),this._teamMap[t.teamName].addTank(n);var r=this._createAiWrapper(n,t);return this._aiList.push(r),r}},{key:"setSpeed",value:function(t){this._speedMultiplier=Math.max(.01,Number(t)),this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._renderer.setSpeed(t)}},{key:"setRendererQuality",value:function(t){isNaN(t)&&"auto"!=t||(isNaN(t)||(t=Math.min(1,Math.max(0,t))),this._rendererQuality=t)}},{key:"stop",value:function(){this._isRunning=!1,this._perfMon.stop(),this._renderer.stop(),this._simulationTimeout&&(clearTimeout(this._simulationTimeout),this._simulationTimeout=null),this._renderInterval&&(clearInterval(this._renderInterval),this._renderInterval=null);var t=void 0,e=void 0;for(e=0;e<this._aiList.length;e++)(t=this._aiList[e])&&t.deactivate();this._aiList=[]}},{key:"onStep",value:function(t){this._onSimulationStepCallback.push(t)}},{key:"onRender",value:function(t){this._onRenderStepCallback.push(t)}},{key:"onStart",value:function(t){this._onStartCallback.push(t)}},{key:"onFinish",value:function(t){this._onFinishCallback.push(t)}},{key:"onError",value:function(t){this._onErrorCallback.push(t)}},{key:"createUltimateBattleDescriptor",value:function(){return this._ultimateBattleDescriptor.clone()}},{key:"hasTeams",value:function(){return this._teamList.length!=this._tankList.length}},{key:"_activateAi",value:function(t,e){this._runInSequence(this._aiList,"activate",this._rng(),t,e)}},{key:"_updateAi",value:function(t,e){this._runInSequence(this._aiList,"simulationStep",null,t,e)}},{key:"_runInSequence",value:function(t,e,n,i,r){if(0==t.length)return i();function o(){for(var t=[],e=arguments[1],n=arguments[0],i=2;i<arguments.length;i++)t.push(arguments[i]);return function(i){e.apply(n,t.concat(i))}}var a=o(null,i),s=o(null,r),u=void 0;u=n?o(t[t.length-1],t[t.length-1][e],n,a,s):o(t[t.length-1],t[t.length-1][e],a,s);for(var l=t.length-2;l>=0;l--)u=n?o(t[l],t[l][e],n,u,s):o(t[l],t[l][e],u,s);u()}},{key:"_updateModel",value:function(){var t=void 0,e=void 0,n=void 0,i=void 0;for(t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&e.simulationStep(this._collisionResolver);var r=0;for(t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&e.energy<=0&&(r++,this._tankList[t]=null,this._explodedTankList.push(e),this._collisionResolver.removeTank(e),this._eventStore.add("tank_"+e.id,{type:"destroy",tank:e}));var o=[];for(t=0;t<this._aiList.length;t++)(i=this._aiList[t])&&(i.tank.energy<=0?(this._aiList[t]=null,i.deactivate()):o.push(i));for(this._aiList=o,t=0;t<this._tankList.length;t++)if((e=this._tankList[t])&&e.isShooting){var a=e.handleShoot();n=this._createBullet(e,a),this._bulletList.push(n),this._eventStore.add("tank_"+e.id,{type:"shoot",tank:e,bullet:n})}for(t=0;t<this._tankList.length;t++)if(e=this._tankList[t])for(var s=0;s<r;s++)e.onSurviveScore();for(t=0;t<this._bulletList.length;t++)(n=this._bulletList[t])&&(n.simulationStep(),this._collisionResolver.hitTestBullet(n)&&(this._bulletList[t]=null,this._explodedBulletList.push(n),this._collisionResolver.removeBullet(n),this._eventStore.add("bullet_"+n.id,{type:"explode",bullet:n})));for(t in this._teamMap)this._teamMap[t].processMessages()}},{key:"_updateView",value:function(){"auto"==this._rendererQuality?this._renderer.quality=this._perfMon.qualityLevel:this._renderer.quality=this._rendererQuality;var t=void 0,e=void 0,n=void 0;for(this._renderer.preRender(),this._renderer.renderClock(this._timeElapsed,this._timeLimit),t=0;t<this._tankList.length;t++)(e=this._tankList[t])&&this._renderer.renderTank(e,this._eventStore.get("tank_"+e.id));for(t=0;t<this._bulletList.length;t++)(n=this._bulletList[t])&&this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(;this._explodedTankList.length;)e=this._explodedTankList.pop(),this._renderer.renderTank(e,this._eventStore.get("tank_"+e.id));for(;this._explodedBulletList.length;)n=this._explodedBulletList.pop(),this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(this._renderer.renderTankStats(this._allTankList),this._renderer.postRender(),t=0;t<this._onRenderStepCallback.length;t++)this._onRenderStepCallback[t]();this._eventStore.clear()}},{key:"_getTeamsLeft",value:function(){var t=0;for(var e in this._teamMap)this._teamMap[e].isAlive&&t++;return t}},{key:"_createAiWrapper",value:function(t,e){return new h.default(t,e)}},{key:"_createTank",value:function(t){return new o.default(t,this._nextTankId++)}},{key:"_createBullet",value:function(t,e){return new s.default(t,this._nextBulletId++,e)}},{key:"tankList",get:function(){return this._allTankList}},{key:"teamList",get:function(){return this._teamList}},{key:"renderer",get:function(){return this._renderer}},{key:"battlefield",get:function(){return this._battlefield}},{key:"timeElapsed",get:function(){return this._timeElapsed}},{key:"timeLimit",get:function(){return this._timeLimit},set:function(t){this._timeLimit=t}}]),t}();e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(5),s=(i=a)&&i.__esModule?i:{default:i};function u(t){for(;t>180;)t-=360;for(;t<-180;)t+=360;return t}var l=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"object"!=(void 0===e?"undefined":r(e)))throw"AI definition must be an object";this._id=n,this._name=e.name,this._team=null,this._maxEnergy=100,this._energy=this._maxEnergy,this._x=0,this._y=0,this._lastX=0,this._lastY=0,this._angle=0,this._gunAngle=0,this._radarAngle=0,this._throttle=0,this._actualThrottle=0,this._speed=0,this._turn=0,this._gunTurn=0,this._radarTurn=0,this._wallHit=!1,this._enemyHit=!1,this._allyHit=!1,this._beingRammed=!1,this._radarRange=300,this._radarFocal=6,this._enemySpot=null,this._allySpot=null,this._bulletsSpot=[],this._gunReloadTime=70,this._gunTimer=0,this._shootingPower=0,this._targetingAlarmTimer=0,this._debugData={},this._score=0,this._state=null,this._hasBoost=!1,this._maxBoost=400,this._boost=this._maxBoost,this._wallDistance=null,this._skin="zebra"}return o(t,[{key:"onEnemyHitScore",value:function(t){this._score+=t}},{key:"onEnemyKillScore",value:function(){this._score+=20}},{key:"onSurviveScore",value:function(){this._score+=10}},{key:"setThrottle",value:function(t){this._throttle=Math.min(1,Math.max(-1,t))}},{key:"setTurn",value:function(t){this._turn=Math.min(1,Math.max(-1,t))}},{key:"setGunTurn",value:function(t){this._gunTurn=Math.min(1,Math.max(-1,t))}},{key:"setRadarTurn",value:function(t){this._radarTurn=Math.min(1,Math.max(-1,t))}},{key:"setBoost",value:function(t){this._hasBoost=!!t}},{key:"setDebugData",value:function(t){this._debugData=t}},{key:"onWallHit",value:function(){this._wallHit=!0,this.onDamage(.2)}},{key:"onEnemyHit",value:function(){this._enemyHit=!0,this.onDamage(.2)}},{key:"onAllyHit",value:function(){this._allyHit=!0,this.onDamage(.2)}},{key:"onBeingRam",value:function(t){this._beingRammed=!0,this.onDamage(.1+.1*Math.round(8*t))}},{key:"onEnemySpot",value:function(t){this._enemySpot=t}},{key:"onAllySpot",value:function(t){this._allySpot=t}},{key:"onBulletSpot",value:function(t){this._bulletsSpot.push(t)}},{key:"onWallSpot",value:function(t){this._wallDistance=t}},{key:"onTargetingAlarm",value:function(){this._targetingAlarmTimer=3}},{key:"isAlly",value:function(t){return!!this._team&&(!!t.team&&this._team.name==t.team.name)}},{key:"onDamage",value:function(t){this._energy=Math.max(0,this._energy-t)}},{key:"moveTo",value:function(t,e){this._x=t,this._y=e,this._lastX=t,this._lastY=e}},{key:"handleShoot",value:function(){var t=this._shootingPower;return this._shootingPower=0,t}},{key:"shoot",value:function(t){t=Math.max(.1,Math.min(1,t)),this.isReloading||(this._gunTimer=Math.round(t*this._gunReloadTime),this._shootingPower=t)}},{key:"randomize",value:function(t){void 0===t&&(t=(new Date).getTime()+Math.round(1e6*Math.random()));var e=(0,s.default)(t);this._angle=Math.round(360*e())-180}},{key:"init",value:function(t){t&&t.SKIN&&(this._skin=t.SKIN)}},{key:"simulationStep",value:function(t){if(0!=this._energy){this._hasBoost&&this._boost>0&&this._boost--;var e=this._x,n=this._y,i=this._throttle*(this.hasBoost?4:2),r=this.hasBoost?10:20;this._actualThrottle+=(i-this._actualThrottle)/r;var o=this._actualThrottle,a=this._angle*(Math.PI/180);this._x+=o*Math.cos(a),this._y+=o*Math.sin(a),this._wallHit=!1,this._enemyHit=!1,this._allyHit=!1,!t.checkTank(this)&&(this._x=e,this._y=n,this._actualThrottle=0),this._beingRammed&&(this._enemyHit=!0,this._beingRammed=!1),this._angle+=2*this._turn,this._radarAngle+=6*this._radarTurn,this._gunAngle+=3*this._gunTurn,this._angle=u(this._angle),this._radarAngle=u(this._radarAngle),this._gunAngle=u(this._gunAngle),t.updateTank(this),this._enemySpot=null,this._allySpot=null,this._wallDistance=null,this._targetingAlarmTimer=Math.max(0,this._targetingAlarmTimer-1),t.scanTanks(this),t.scanBullets(this),t.scanWalls(this),this._gunTimer>0&&this._gunTimer--;for(var s=null,l=null,c=[];this._bulletsSpot.length;){var h=this._bulletsSpot.shift();c.push({id:h.id,x:h.x,y:h.y,angle:h.angle,speed:h.speed,damage:h.damage})}this._enemySpot&&(s={id:this._enemySpot.id,x:this._enemySpot.x,y:this._enemySpot.y,angle:this._enemySpot.angle,speed:this._enemySpot.speed,energy:this._enemySpot.energy}),this._allySpot&&(l={id:this._allySpot.id,x:this._allySpot.x,y:this._allySpot.y,angle:this._allySpot.angle,speed:this._allySpot.speed,energy:this._allySpot.energy});var f=this._x-this._lastX,d=this._y-this._lastY;this._speed=Math.sqrt(f*f+d*d),this._lastX=this._x,this._lastY=this._y,this._state={x:this._x,y:this._y,angle:this._angle,energy:this._energy,boost:this._boost,collisions:{wall:this._wallHit,enemy:this._enemyHit,ally:this._allyHit},radar:{angle:this._radarAngle,targetingAlarm:this.targetingAlarm,wallDistance:this._wallDistance,enemy:s,ally:l,bullets:c},gun:{angle:this._gunAngle,reloading:this.isReloading},radio:{inbox:this.team?this.team.getMessages(this.id):[]}}}}},{key:"id",get:function(){return this._id}},{key:"skin",get:function(){return this._skin}},{key:"state",get:function(){return this._state}},{key:"energy",get:function(){return this._energy}},{key:"score",get:function(){return this._score}},{key:"maxEnergy",get:function(){return this._maxEnergy}},{key:"radarRange",get:function(){return this._radarRange}},{key:"radarFocal",get:function(){return this._radarFocal}},{key:"name",get:function(){return this._name}},{key:"fullName",get:function(){return this._name+" #"+this._id}},{key:"team",get:function(){return this._team}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"speed",get:function(){return this._speed}},{key:"gunLength",get:function(){return 25}},{key:"angle",get:function(){return this._angle}},{key:"throttle",get:function(){return this._throttle}},{key:"hasBoost",get:function(){return this._hasBoost&&this._boost>0}},{key:"boost",get:function(){return this._boost}},{key:"maxBoost",get:function(){return this._maxBoost}},{key:"gunAngle",get:function(){return this._gunAngle}},{key:"radarAngle",get:function(){return this._radarAngle}},{key:"enemySpot",get:function(){return this._enemySpot}},{key:"allySpot",get:function(){return this._allySpot}},{key:"targetingAlarm",get:function(){return this._targetingAlarmTimer>0}},{key:"debugData",get:function(){return this._debugData}},{key:"isShooting",get:function(){return this._shootingPower>0}},{key:"shootingPower",get:function(){return this._shootingPower}},{key:"isReloading",get:function(){return this._gunTimer>0}}]),t}();e.default=l},function(t,e,n){"use strict";(function(t){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new function(t){var e,n=this,i=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,i&&("object"==(void 0===i?"undefined":r(i))&&s(i,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n(0)&&n(3)?void 0===(i=function(){return u}.call(e,n,e,o))||(o.exports=i):this.alea=u}(0,"object"==r(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new function(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==(void 0===i?"undefined":r(i))&&s(i,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n(0)&&n(3)?void 0===(i=function(){return u}.call(e,n,e,o))||(o.exports=i):this.xor128=u}(0,"object"==r(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==(void 0===i?"undefined":r(i))&&s(i,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n(0)&&n(3)?void 0===(i=function(){return u}.call(e,n,e,o))||(o.exports=i):this.xorwow=u}(0,"object"==r(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i;!function(t,r,o){function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=s:n(0)&&n(3)?void 0===(i=function(){return s}.call(e,n,e,r))||(r.exports=i):this.xorshift7=s}(0,"object"==("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i;!function(t,r,o){function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,o=e.i;return e.w=i=i+1640531527|0,n=r[o+34&127],t=r[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[o]=n^t,e.i=o,n+(i^i>>>16)|0},function(t,e){var n,i,r,o,a,s=[],u=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,u=Math.max(u,e.length)),r=0,o=-32;o<u;++o)e&&(i^=e.charCodeAt((o+32)%e.length)),0===o&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(a=a+1640531527|0,r=0==(n=s[127&o]^=i+a)?r+1:0);for(r>=128&&(s[127&(e&&e.length||0)]=-1),r=127,o=512;o>0;--o)i=s[r+34&127],n=s[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,s[r]=i^n;t.w=a,t.X=s,t.i=r}(e,t)}(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=s:n(0)&&n(3)?void 0===(i=function(){return s}.call(e,n,e,r))||(r.exports=i):this.xor4096=s}(0,"object"==("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o,a){function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==(void 0===i?"undefined":r(i))&&s(i,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n(0)&&n(3)?void 0===(i=function(){return u}.call(e,n,e,o))||(o.exports=i):this.tychei=u}(0,"object"==r(t)&&t,n(0))}).call(e,n(2)(t))},function(t,e,n){"use strict";(function(t){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(o,a){var s,u=this,l=256,c=6,h="random",f=a.pow(l,c),d=a.pow(2,52),p=2*d,_=l-1;function y(t,e,n){var i=[],y=m(function t(e,n){var i,o=[],a=void 0===e?"undefined":r(e);if(n&&"object"==a)for(i in e)try{o.push(t(e[i],n-1))}catch(t){}return o.length?o:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,b(o)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(l):(t=new Uint8Array(l),(u.crypto||u.msCrypto).getRandomValues(t)),b(t)}catch(t){var e=u.navigator,n=e&&e.plugins;return[+new Date,u,n,u.screen,b(o)]}}():t,3),i),g=new function(t){var e,n=t.length,i=this,r=0,o=i.i=i.j=0,a=i.S=[];n||(t=[n++]);for(;r<l;)a[r]=r++;for(r=0;r<l;r++)a[r]=a[o=_&o+t[r%n]+(e=a[r])],a[o]=e;(i.g=function(t){for(var e,n=0,r=i.i,o=i.j,a=i.S;t--;)e=a[r=_&r+1],n=n*l+a[_&(a[r]=a[o=_&o+e])+(a[o]=e)];return i.i=r,i.j=o,n})(l)}(i),k=function(){for(var t=g.g(c),e=f,n=0;t<d;)t=(t+n)*l,e*=l,n=g.g(1);for(;t>=p;)t/=2,e/=2,n>>>=1;return(t+n)/e};return k.int32=function(){return 0|g.g(4)},k.quick=function(){return g.g(4)/4294967296},k.double=k,m(b(g.S),o),(e.pass||n||function(t,e,n,i){return i&&(i.S&&v(i,g),t.state=function(){return v(g,{})}),n?(a[h]=t,e):t})(k,y,"global"in e?e.global:this==a,e.state)}function v(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,i=t+"",r=0;r<i.length;)e[_&r]=_&(n^=19*e[_&r])+i.charCodeAt(r++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(a["seed"+h]=y,m(a.random(),o),"object"==r(t)&&t.exports){t.exports=y;try{s=n(26)}catch(t){}}else void 0===(i=function(){return y}.call(e,n,e,t))||(t.exports=i)}([],Math)}).call(e,n(2)(t))},function(t,e){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._members=[],this._inboxMap=[],this._outboxMap=[]}return i(t,[{key:"addTank",value:function(t){if(t.team)throw"Tank "+t.fullName+" is already assigned to team "+t.team.name;for(var e in this._members)if(this._members[e].id==t.id)return;this._members.push(t),t._team=this,this._inboxMap[t.id]=[],this._outboxMap[t.id]=[]}},{key:"getMessages",value:function(t){return this._outboxMap[t]}},{key:"sendMessages",value:function(t,e){for(var n in this._inboxMap)n!=t&&(this._inboxMap[n]=this._inboxMap[n].concat(e))}},{key:"processMessages",value:function(){var t=void 0;for(t in this._inboxMap)this._outboxMap[t]=this._inboxMap[t],this._inboxMap[t]=[]}},{key:"size",get:function(){return this._members.length}},{key:"name",get:function(){return this._name}},{key:"aliveCount",get:function(){for(var t=0,e=0;e<this._members.length;e++)this._members[e].energy>0&&t++;return t}},{key:"score",get:function(){for(var t=0,e=0;e<this._members.length;e++)t+=this._members[e].score;return t}},{key:"energy",get:function(){for(var t=0,e=0;e<this._members.length;e++)t+=this._members[e].energy;return t}},{key:"maxEnergy",get:function(){for(var t=0,e=0;e<this._members.length;e++)t+=this._members[e].maxEnergy;return t}},{key:"isAlive",get:function(){return this.aliveCount>0}},{key:"members",get:function(){return this._members}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e,n,i){for(!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=n,this._owner=e,this._angle=e.angle+e.gunAngle;this._angle>180;)this._angle-=360;for(;this._angle<-180;)this._angle+=360;this._x=e.x+e.gunLength*Math.cos(this._angle*(Math.PI/180)),this._y=e.y+e.gunLength*Math.sin(this._angle*(Math.PI/180)),this._speed=4,this._power=i,this._damage=.01*Math.round(1e3*i+300*i*i),this._exploded=!1}return i(t,[{key:"onWallHit",value:function(){this._exploded=!0}},{key:"onEnemyHit",value:function(t){this._exploded=!0,t.onDamage(this._damage)}},{key:"simulationStep",value:function(){this._x+=this._speed*Math.cos(this._angle*(Math.PI/180)),this._y+=this._speed*Math.sin(this._angle*(Math.PI/180))}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"angle",get:function(){return this._angle}},{key:"speed",get:function(){return this._speed}},{key:"damage",get:function(){return this._damage}},{key:"power",get:function(){return this._power}},{key:"owner",get:function(){return this._owner}},{key:"exploded",get:function(){return this._exploded}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(5),a=(i=o)&&i.__esModule?i:{default:i};var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._width=null,this._height=null,this._startSlotList=[],this._offsetX=0,this._offsetY=0}return r(t,[{key:"setSize",value:function(t,e){this._width=t-2*this.margin,this._height=e-2*this.margin}},{key:"randomize",value:function(t){void 0===t&&(t=(new Date).getTime()+Math.round(1e6*Math.random()));var e=(0,a.default)(t);this._offsetX=Math.round(1e4*e()-5e3),this._offsetY=Math.round(1e4*e()-5e3),this._startSlotList=[];for(var n=this.minX+90;n<this.maxX-90;n+=90)for(var i=this.minY+90;i<this.maxY-90;i+=90)this._startSlotList.push({x:n,y:i});for(var r=this._startSlotList.length,o=void 0,s=void 0;0!==r;)s=Math.floor(e()*r),r-=1,o=this._startSlotList[r],this._startSlotList[r]=this._startSlotList[s],this._startSlotList[s]=o}},{key:"getStartSlot",value:function(){return this._startSlotList.length?this._startSlotList.pop():null}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"margin",get:function(){return 25}},{key:"minX",get:function(){return this._offsetX+this.margin}},{key:"minY",get:function(){return this._offsetY+this.margin}},{key:"maxX",get:function(){return this._offsetX+this._width+this.margin}},{key:"maxY",get:function(){return this._offsetY+this._height+this.margin}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=[]}return i(t,[{key:"add",value:function(t,e){this._data[t]||(this._data[t]=[]),this._data[t].push(e)}},{key:"get",value:function(t){return this._data[t]||(this._data[t]=[]),this._data[t]}},{key:"clear",value:function(t){this._data=[]}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(32),a=(i=o)&&i.__esModule?i:{default:i};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._wallList=[],this._tankMap=[],this._bulletMap=[],this._radarBeamMap=[],this._battlefield=null}return r(t,[{key:"updateBattlefield",value:function(t){this._battlefield={minX:t.minX,minY:t.minY,maxX:t.maxX,maxY:t.maxY};var e=void 0;e=new a.default.Box(new a.default.Vector(t.minX-10,t.minY),10,t.height).toPolygon(),this._wallList.push(e),e=new a.default.Box(new a.default.Vector(t.minX,t.minY-10),t.width,10).toPolygon(),this._wallList.push(e),e=new a.default.Box(new a.default.Vector(t.maxX,t.minY),10,t.height).toPolygon(),this._wallList.push(e),e=new a.default.Box(new a.default.Vector(t.minX,t.maxY),t.width,10).toPolygon(),this._wallList.push(e)}},{key:"updateTank",value:function(t){var e=this._getTankShape(t);e.pos.x=t.x,e.pos.y=t.y}},{key:"removeBullet",value:function(t){this._bulletMap[t.id]=null}},{key:"removeTank",value:function(t){this._tankMap[t.id]=null,this._radarBeamMap[t.id]=null}},{key:"hitTestBullet",value:function(t){var e=this._getBulletShape(t),n=t.owner.energy?this._getTankShape(t.owner):null;e.pos.x=t.x,e.pos.y=t.y;var i=void 0,r=void 0;for(i in this._wallList)if(r=this._wallList[i],a.default.testCirclePolygon(e,r))return t.onWallHit(),!0;var o=void 0;for(i in this._tankMap)if((o=this._tankMap[i])&&o!=n&&a.default.testCircleCircle(e,o)){var s=o.tank.energy;return t.onEnemyHit(o.tank),t.owner.isAlly(o.tank)||t.owner.onEnemyHitScore(s-o.tank.energy),0==o.tank.energy&&t.owner.onEnemyKillScore(),!0}return!1}},{key:"checkTank",value:function(t){var e=this._getTankShape(t);e.pos.x=t.x,e.pos.y=t.y;var n=void 0,i=void 0,r=void 0;for(n in this._wallList)if(r=this._wallList[n],i=a.default.testCirclePolygon(e,r))return t.onWallHit(),!1;var o=void 0;for(n in this._tankMap)if((o=this._tankMap[n])&&o!=e){i=a.default.testCircleCircle(e,o);var s=t.isAlly(o.tank);if(i){if(s)return t.onAllyHit(),!1;var u=o.tank.energy;return t.onEnemyHit(),o.tank.onBeingRam(t.speed),t.onEnemyHitScore(u-o.tank.energy),!1}}return!0}},{key:"scanTanks",value:function(t){var e=this._getRadarBeamShape(t),n=this._getTankShape(t);e.setAngle((t.angle+t.radarAngle)*Math.PI/180),e.pos.x=t.x,e.pos.y=t.y;var i=void 0,r=void 0,o=[];for(i in this._tankMap)(r=this._tankMap[i])&&r!=n&&a.default.testPolygonCircle(e,r)&&o.push(r.tank);if(0==o.length)return!1;var s=null,u=t.radarRange,l=null,c=t.radarRange,h=void 0,f=void 0,d=void 0,p=void 0;for(i in o)f=o[i].x-t.x,d=o[i].y-t.y,h=Math.sqrt(f*f+d*d),(p=o[i].isAlly(t))||s&&!(h<u)?p&&(!l||h<c)&&(l=o[i],c=h):(s=o[i],u=h);return l&&t.onAllySpot(l),s&&(t.onEnemySpot(s),s.onTargetingAlarm()),!0}},{key:"scanBullets",value:function(t){var e=this._getRadarBeamShape(t);e.setAngle((t.angle+t.radarAngle)*Math.PI/180),e.pos.x=t.x,e.pos.y=t.y;var n=void 0,i=void 0,r=!1;for(n in this._bulletMap)(i=this._bulletMap[n])&&i.bullet.owner!=t&&a.default.testCirclePolygon(i,e)&&(t.onBulletSpot(i.bullet),r=!0);return r}},{key:"scanWalls",value:function(t){var e=this._getWallDistance(t);return e<t.radarRange&&(t.onWallSpot(e),!0)}},{key:"_getWallDistance",value:function(t){for(var e=t.angle+t.radarAngle;e>180;)e-=360;for(;e<-180;)e+=360;var n=t.y-this._battlefield.minY,i=this._battlefield.maxY-t.y,r=t.x-this._battlefield.minX,o=this._battlefield.maxX-t.x;if(-180==e||180==e)return r;if(0==e)return o;if(-90==e)return n;if(90==e)return i;var a=void 0,s=void 0;return e>-180&&e<-90?(a=r/Math.cos((e+180)*(Math.PI/180)),s=n/Math.sin((e+180)*(Math.PI/180))):e>-90&&e<0?(a=o/Math.cos(-e*(Math.PI/180)),s=n/Math.sin(-e*(Math.PI/180))):e>0&&e<90?(a=o/Math.cos(e*(Math.PI/180)),s=i/Math.sin(e*(Math.PI/180))):(a=r/Math.cos((180-e)*(Math.PI/180)),s=i/Math.sin((180-e)*(Math.PI/180))),Math.min(a,s)}},{key:"_getTankShape",value:function(t){if(!this._tankMap[t.id]){if(0==t.energy)throw"Cannot create shape for destroyed tank";var e=new a.default.Circle(new a.default.Vector(t.x,t.y),18);this._tankMap[t.id]=e,e.tank=t}return this._tankMap[t.id]}},{key:"_getBulletShape",value:function(t){if(!this._bulletMap[t.id]){if(t.exploded)throw"Cannot create shape for exploded bullet";var e=new a.default.Circle(new a.default.Vector(t.x,t.y),3);this._bulletMap[t.id]=e,e.bullet=t}return this._bulletMap[t.id]}},{key:"_getRadarBeamShape",value:function(t){if(!this._radarBeamMap[t.id]){if(0==t.energy)throw"Cannot create radar beam shape for destroyed tank";var e=t.radarRange*Math.tan(t.radarFocal*(Math.PI/180))/2,n=new a.default.Polygon(new a.default.Vector(t.x,t.y),[new a.default.Vector(0,3),new a.default.Vector(0,-3),new a.default.Vector(t.radarRange,-e),new a.default.Vector(t.radarRange,e)]);this._radarBeamMap[t.id]=n,n.tank=t}return this._radarBeamMap[t.id]}}]),t}();e.default=s},function(t,e,n){"use strict";var i,r;"function"==typeof Symbol&&Symbol.iterator;void 0===(r="function"==typeof(i=function(){var t={};function e(t,e){this.x=t||0,this.y=e||0}function n(t,n){this.pos=t||new e,this.r=n||0}function i(t,n){this.pos=t||new e,this.angle=0,this.offset=new e,this.setPoints(n||[])}function r(t,n,i){this.pos=t||new e,this.w=n||0,this.h=i||0}function o(){this.a=null,this.b=null,this.overlapN=new e,this.overlapV=new e,this.clear()}t.Vector=e,t.V=e,e.prototype.copy=e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.perp=e.prototype.perp=function(){var t=this.x;return this.x=this.y,this.y=-t,this},e.prototype.rotate=e.prototype.rotate=function(t){var e=this.x,n=this.y;return this.x=e*Math.cos(t)-n*Math.sin(t),this.y=e*Math.sin(t)+n*Math.cos(t),this},e.prototype.reverse=e.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.normalize=e.prototype.normalize=function(){var t=this.len();return t>0&&(this.x=this.x/t,this.y=this.y/t),this},e.prototype.add=e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.sub=e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.scale=e.prototype.scale=function(t,e){return this.x*=t,this.y*=e||t,this},e.prototype.project=e.prototype.project=function(t){var e=this.dot(t)/t.len2();return this.x=e*t.x,this.y=e*t.y,this},e.prototype.projectN=e.prototype.projectN=function(t){var e=this.dot(t);return this.x=e*t.x,this.y=e*t.y,this},e.prototype.reflect=e.prototype.reflect=function(t){var e=this.x,n=this.y;return this.project(t).scale(2),this.x-=e,this.y-=n,this},e.prototype.reflectN=e.prototype.reflectN=function(t){var e=this.x,n=this.y;return this.projectN(t).scale(2),this.x-=e,this.y-=n,this},e.prototype.dot=e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len2=e.prototype.len2=function(){return this.dot(this)},e.prototype.len=e.prototype.len=function(){return Math.sqrt(this.len2())},t.Circle=n,n.prototype.getAABB=n.prototype.getAABB=function(){var t=this.r;return new r(this.pos.clone().sub(new e(t,t)),2*t,2*t).toPolygon()},t.Polygon=i,i.prototype.setPoints=i.prototype.setPoints=function(t){if(!this.points||this.points.length!==t.length){var n,i=this.calcPoints=[],r=this.edges=[],o=this.normals=[];for(n=0;n<t.length;n++)i.push(new e),r.push(new e),o.push(new e)}return this.points=t,this._recalc(),this},i.prototype.setAngle=i.prototype.setAngle=function(t){return this.angle=t,this._recalc(),this},i.prototype.setOffset=i.prototype.setOffset=function(t){return this.offset=t,this._recalc(),this},i.prototype.rotate=i.prototype.rotate=function(t){for(var e=this.points,n=e.length,i=0;i<n;i++)e[i].rotate(t);return this._recalc(),this},i.prototype.translate=i.prototype.translate=function(t,e){for(var n=this.points,i=n.length,r=0;r<i;r++)n[r].x+=t,n[r].y+=e;return this._recalc(),this},i.prototype._recalc=function(){var t,e=this.calcPoints,n=this.edges,i=this.normals,r=this.points,o=this.offset,a=this.angle,s=r.length;for(t=0;t<s;t++){var u=e[t].copy(r[t]);u.x+=o.x,u.y+=o.y,0!==a&&u.rotate(a)}for(t=0;t<s;t++){var l=e[t],c=t<s-1?e[t+1]:e[0],h=n[t].copy(c).sub(l);i[t].copy(h).perp().normalize()}return this},i.prototype.getAABB=i.prototype.getAABB=function(){for(var t=this.calcPoints,n=t.length,i=t[0].x,o=t[0].y,a=t[0].x,s=t[0].y,u=1;u<n;u++){var l=t[u];l.x<i?i=l.x:l.x>a&&(a=l.x),l.y<o?o=l.y:l.y>s&&(s=l.y)}return new r(this.pos.clone().add(new e(i,o)),a-i,s-o).toPolygon()},i.prototype.getCentroid=i.prototype.getCentroid=function(){for(var t=this.calcPoints,n=t.length,i=0,r=0,o=0,a=0;a<n;a++){var s=t[a],u=a===n-1?t[0]:t[a+1],l=s.x*u.y-u.x*s.y;i+=(s.x+u.x)*l,r+=(s.y+u.y)*l,o+=l}return new e(i/=o*=3,r/=o)},t.Box=r,r.prototype.toPolygon=r.prototype.toPolygon=function(){var t=this.pos,n=this.w,r=this.h;return new i(new e(t.x,t.y),[new e,new e(n,0),new e(n,r),new e(0,r)])},t.Response=o,o.prototype.clear=o.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var a=[],s=0;s<10;s++)a.push(new e);var u=[];for(s=0;s<5;s++)u.push([]);var l=new o,c=new r(new e,1e-6,1e-6).toPolygon();function h(t,e,n){for(var i=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=t.length,a=0;a<o;a++){var s=t[a].dot(e);s<i&&(i=s),s>r&&(r=s)}n[0]=i,n[1]=r}function f(t,e,n,i,r,o){var s=u.pop(),l=u.pop(),c=a.pop().copy(e).sub(t),f=c.dot(r);if(h(n,r,s),h(i,r,l),l[0]+=f,l[1]+=f,s[0]>l[1]||l[0]>s[1])return a.push(c),u.push(s),u.push(l),!0;if(o){var d,p,_=0;if(s[0]<l[0])if(o.aInB=!1,s[1]<l[1])_=s[1]-l[0],o.bInA=!1;else _=(d=s[1]-l[0])<(p=l[1]-s[0])?d:-p;else if(o.bInA=!1,s[1]>l[1])_=s[0]-l[1],o.aInB=!1;else _=(d=s[1]-l[0])<(p=l[1]-s[0])?d:-p;var y=Math.abs(_);y<o.overlap&&(o.overlap=y,o.overlapN.copy(r),_<0&&o.overlapN.reverse())}return a.push(c),u.push(s),u.push(l),!1}function d(t,e){var n=t.len2(),i=e.dot(t);return i<0?p:i>n?y:_}t.isSeparatingAxis=f;var p=-1,_=0,y=1;function v(t,e,n){for(var i=a.pop().copy(e.pos).sub(t.pos),r=e.r,o=r*r,s=t.calcPoints,u=s.length,l=a.pop(),c=a.pop(),h=0;h<u;h++){var f=h===u-1?0:h+1,_=0===h?u-1:h-1,v=0,m=null;l.copy(t.edges[h]),c.copy(i).sub(s[h]),n&&c.len2()>o&&(n.aInB=!1);var b=d(l,c);if(b===p){l.copy(t.edges[_]);var g=a.pop().copy(i).sub(s[_]);if((b=d(l,g))===y){if((w=c.len())>r)return a.push(i),a.push(l),a.push(c),a.push(g),!1;n&&(n.bInA=!1,m=c.normalize(),v=r-w)}a.push(g)}else if(b===y){if(l.copy(t.edges[f]),c.copy(i).sub(s[f]),(b=d(l,c))===p){if((w=c.len())>r)return a.push(i),a.push(l),a.push(c),!1;n&&(n.bInA=!1,m=c.normalize(),v=r-w)}}else{var k=l.perp().normalize(),w=c.dot(k),O=Math.abs(w);if(w>0&&O>r)return a.push(i),a.push(k),a.push(c),!1;n&&(m=k,v=r-w,(w>=0||v<2*r)&&(n.bInA=!1))}m&&n&&Math.abs(v)<Math.abs(n.overlap)&&(n.overlap=v,n.overlapN.copy(m))}return n&&(n.a=t,n.b=e,n.overlapV.copy(n.overlapN).scale(n.overlap)),a.push(i),a.push(l),a.push(c),!0}function m(t,e,n){for(var i=t.calcPoints,r=i.length,o=e.calcPoints,a=o.length,s=0;s<r;s++)if(f(t.pos,e.pos,i,o,t.normals[s],n))return!1;for(s=0;s<a;s++)if(f(t.pos,e.pos,i,o,e.normals[s],n))return!1;return n&&(n.a=t,n.b=e,n.overlapV.copy(n.overlapN).scale(n.overlap)),!0}return t.pointInCircle=function(t,e){var n=a.pop().copy(t).sub(e.pos),i=e.r*e.r,r=n.len2();return a.push(n),r<=i},t.pointInPolygon=function(t,e){c.pos.copy(t),l.clear();var n=m(c,e,l);return n&&(n=l.aInB),n},t.testCircleCircle=function(t,e,n){var i=a.pop().copy(e.pos).sub(t.pos),r=t.r+e.r,o=r*r,s=i.len2();if(s>o)return a.push(i),!1;if(n){var u=Math.sqrt(s);n.a=t,n.b=e,n.overlap=r-u,n.overlapN.copy(i.normalize()),n.overlapV.copy(i).scale(n.overlap),n.aInB=t.r<=e.r&&u<=e.r-t.r,n.bInA=e.r<=t.r&&u<=t.r-e.r}return a.push(i),!0},t.testPolygonCircle=v,t.testCirclePolygon=function(t,e,n){var i=v(e,t,n);if(i&&n){var r=n.a,o=n.aInB;n.overlapN.reverse(),n.overlapV.reverse(),n.a=n.b,n.b=r,n.aInB=n.bInA,n.bInA=o}return i},t.testPolygonPolygon=m,t})?i.call(e,n,e,t):i)||(t.exports=r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(34),s=(i=a)&&i.__esModule?i:{default:i};var u=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw"Tank is required";if(!n)throw"AiDefinition is required";this._tank=e,this._aiWorker=null,this._aiProcessingStart=0,this._aiProcessingCheckInterval=null,this._aiProcessingResolveCallback=null,this._aiProcessingRejectCallback=null,this._slowAiChances=10,this._onActivationCallback=[],this._onDectivationCallback=[],this._aiProcessingTimeLimit=3e3,this._aiDefinition=n,this._isReady=!1,this._controlData={THROTTLE:0,BOOST:0,TURN:0,RADAR_TURN:0,GUN_TURN:0,SHOOT:0,OUTBOX:[],DEBUG:{}}}return o(t,[{key:"setProcessingLimit",value:function(t){this._aiProcessingTimeLimit=t}},{key:"onActivation",value:function(t){this._onActivationCallback.push(t)}},{key:"onDectivation",value:function(t){this._onDeactivationCallback.push(t)}},{key:"_formatError",value:function(t){if(!t.message)return"unknown";var e=t.message;return t.lineno&&(e="Line #"+t.lineno+": "+e),e}},{key:"activate",value:function(t,e,n){if("number"!=typeof t)throw"seed must be a number, '"+(void 0===t?"undefined":r(t))+"' given";if("function"!=typeof e)throw"resolve callback must be a function, '"+(void 0===e?"undefined":r(e))+"' given";if("function"!=typeof n)throw"reject callback must be a function, '"+(void 0===n?"undefined":r(n))+"' given";var i=this;i._aiWorker=i._createWorker(this._aiDefinition),i._aiWorker.onerror=function(t){console.error(t),i._aiProcessingRejectCallback&&(i._aiProcessingRejectCallback({message:"Web Worker of '"+i._tank.fullName+"' returned an error: "+i._formatError(t),performanceIssues:!1,tankName:i._tank.name,tankId:i._tank.id}),i._aiProcessingResolveCallback=null,i._aiProcessingRejectCallback=null)},i._aiProcessingCheckInterval&&(clearInterval(i._aiProcessingCheckInterval),i._aiProcessingCheckInterval=null),i._aiProcessingCheckInterval=setInterval(function(){i._aiProcessingRejectCallback&&((new Date).getTime()-i._aiProcessingStart>i._aiProcessingTimeLimit&&(clearInterval(i._aiProcessingCheckInterval),i._aiProcessingCheckInterval=null,i._aiProcessingRejectCallback({message:"Simulation cannot be continued because "+i._tank.name+" #"+i._tank.id+" does not respond",performanceIssues:!0,tankName:i._tank.name,tankId:i._tank.id})))},Math.max(i._aiDefinition.executionLimit,Math.round(i._aiProcessingTimeLimit/2))),i._aiWorker.onmessage=function(t){var e=t.data;if(i._aiProcessingResolveCallback){if("init"==e.type){i._configureTank(e.settings?e.settings:{}),i._isReady=!0;for(var n=0;n<i._onActivationCallback.length;n++)i._onActivationCallback[n].bind(i)()}else i._controlTank(e);var r=void 0,o=(new Date).getTime()-i._aiProcessingStart;if(o>i._aiDefinition.executionLimit&&"init"!=e.type&&(i._slowAiChances--,console.warn("Execution of AI for tank "+i._tank.name+" #"+i._tank.id+" takes too long ("+o+"ms). If problem repeats, AI will be terminated."),i._slowAiChances<=0))return r=i._aiProcessingRejectCallback,i._aiProcessingResolveCallback=null,i._aiProcessingRejectCallback=null,void r({message:"Simulation cannot be continued because "+i._tank.name+" #"+i._tank.id+" has performance issues",performanceIssues:!0,tankName:i._tank.name,tankId:i._tank.id});r=i._aiProcessingResolveCallback,i._aiProcessingResolveCallback=null,i._aiProcessingRejectCallback=null,r()}};var o=null;o=i._tank.team&&i._tank.team.size>1?{name:i._tank.team.name,mates:i._tank.team.members.map(function(t){return t.id})}:{name:i._tank.fullName,mates:[i._tank.id]};var a={id:i._tank.id,team:o};i._aiDefinition.initData&&(a.initData=i._aiDefinition.initData),i._aiProcessingStart=(new Date).getTime(),i._aiProcessingResolveCallback=e,i._aiProcessingRejectCallback=n,i._aiWorker.postMessage({command:"init",seed:t+":"+i._tank.id,settings:{SKIN:"zebra"},info:a,code:i._aiDefinition.code})}},{key:"deactivate",value:function(){this._aiWorker&&(this._aiWorker.terminate(),this._aiWorker=null),this._aiProcessingCheckInterval&&(clearInterval(this._aiProcessingCheckInterval),this._aiProcessingCheckInterval=null);for(var t=0;t<this._onDectivationCallback.length;t++)this._onDectivationCallback[t].bind(this)()}},{key:"simulationStep",value:function(t,e){if("function"!=typeof t)throw"resolve callback must be a function, '"+(void 0===t?"undefined":r(t))+"' given";if("function"!=typeof e)throw"reject callback must be a function, '"+(void 0===e?"undefined":r(e))+"' given";if(!this._isReady)throw"AI of "+this._tank.fullName+" not initliazed";if(this._aiWorker&&0==this._tank.energy)return this._aiWorker.terminate(),this._aiWorker=null,void t();this._aiProcessingStart=(new Date).getTime(),this._aiProcessingResolveCallback=t,this._aiProcessingRejectCallback=e,this._aiWorker.postMessage({command:"update",state:this._tank.state,control:this._controlData})}},{key:"_configureTank",value:function(t){var e={};-1!=["zebra","forest","black","tiger","desert","lava","ocean"].indexOf(t.SKIN)&&(e.SKIN=t.SKIN),this._tank.init(e)}},{key:"_controlTank",value:function(t){this._controlData.THROTTLE=Number(t.THROTTLE),this._controlData.TURN=Number(t.TURN),this._controlData.GUN_TURN=Number(t.GUN_TURN),this._controlData.RADAR_TURN=Number(t.RADAR_TURN),this._controlData.SHOOT=Number(t.SHOOT),this._controlData.DEBUG=t.DEBUG,this._controlData.BOOST=t.BOOST?1:0,this._controlData.THROTTLE=isNaN(this._controlData.THROTTLE)?0:this._controlData.THROTTLE,this._controlData.TURN=isNaN(this._controlData.TURN)?0:this._controlData.TURN,this._controlData.GUN_TURN=isNaN(this._controlData.GUN_TURN)?0:this._controlData.GUN_TURN,this._controlData.RADAR_TURN=isNaN(this._controlData.RADAR_TURN)?0:this._controlData.RADAR_TURN,this._controlData.SHOOT=isNaN(this._controlData.SHOOT)?0:this._controlData.SHOOT,this._controlData.THROTTLE=Math.min(1,Math.max(-1,Number(this._controlData.THROTTLE))),this._controlData.TURN=Math.min(1,Math.max(-1,Number(this._controlData.TURN))),this._controlData.GUN_TURN=Math.min(1,Math.max(-1,Number(this._controlData.GUN_TURN))),this._controlData.RADAR_TURN=Math.min(1,Math.max(-1,Number(this._controlData.RADAR_TURN))),this._controlData.SHOOT=Math.min(1,Math.max(0,Number(this._controlData.SHOOT))),this._tank.setThrottle(this._controlData.THROTTLE),this._tank.setBoost(this._controlData.BOOST),this._tank.setTurn(this._controlData.TURN),this._tank.setRadarTurn(this._controlData.RADAR_TURN),this._tank.setGunTurn(this._controlData.GUN_TURN),this._tank.setDebugData(this._controlData.DEBUG),this._controlData.SHOOT&&this._tank.shoot(this._controlData.SHOOT),this._controlData.SHOOT=0;var e=[];for(var n in t.OUTBOX)e.push(JSON.parse(JSON.stringify(t.OUTBOX[n])));this._tank.team&&this._tank.team.sendMessages(this._tank.id,e),this._controlData.OUTBOX=[]}},{key:"_createWorker",value:function(t){return t.useSandbox?new Worker(t.filePath):new s.default}},{key:"tank",get:function(){return this._tank}},{key:"worker",get:function(){return this._aiWorker}}]),t}();e.default=u},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var extendedMath=__webpack_require__(35),TankController=function(){function t(){_classCallCheck(this,t),this._initCallback=function(){},this._loopCallback=function(){}}return _createClass(t,[{key:"loop",value:function(t){this._loopCallback=t}},{key:"init",value:function(t){this._initCallback=t}}]),t}(),EvalWorker=function(){function EvalWorker(){_classCallCheck(this,EvalWorker),this.onmessage=function(t){},this._callStackLimit=100,this._callStackCount=0,this._tankController=new TankController}return _createClass(EvalWorker,[{key:"postMessage",value:function postMessage(inputData){var _this=this,response=null;if("init"==inputData.command){if(!inputData.code)throw"The code is required!";var settings=inputData.settings,info=inputData.info,Math=extendedMath(),tank=this._tankController;eval(inputData.code),tank._initCallback(settings,info),response={data:{type:"init",settings:settings}}}else if("update"==inputData.command){var state=inputData.state,control=inputData.control;this._tankController._loopCallback?(this._tankController._loopCallback(state,control),response={data:control}):response={data:control}}this._callStackCount<this._callStackLimit?(this._callStackCount++,this.onmessage(response)):(this._callStackCount=0,setTimeout(function(){_this.onmessage(response)},1))}},{key:"terminate",value:function(){}}]),EvalWorker}();exports.default=EvalWorker},function(t,e,n){"use strict";t.exports=function(){var t={},e=["LN10","PI","E","LOG10E","SQRT2","LOG2E","SQRT1_2","LN2","cos","pow","log","tan","sqrt","ceil","asin","abs","max","exp","atan2","random","round","floor","acos","atan","min","sin"];for(var n in e)t[e[n]]=Math[e[n]];return t.deg={},t.rad={},t.deg.normalize=function(t){for(t=Number(t);t>180;)t-=360;for(;t<=-180;)t+=360;return t},t.rad.normalize=function(e){for(e=Number(e);e>t.PI;)e-=2*t.PI;for(;e<=-t.PI;)e+=2*t.PI;return e},t.deg2rad=function(e){return t.rad.normalize(e*(t.PI/180))},t.rad2deg=function(e){return t.deg.normalize(e*(180/t.PI))},t.rad.atan2=t.atan2,t.deg.atan2=function(e,n){return t.rad2deg(t.rad.atan2(e,n))},t.distance=function(e,n,i,r){var o=i-e,a=r-n;return t.sqrt(o*o+a*a)},t.randomRange=function(e,n){if(e>n)throw"The range is incorrect. First number must be lower than second";return e+t.random()*(n-e)},t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._simulationStepDuration=30,this._stepCounter=0,this._checkLoop=0,this._started=!1,this._desiredPerfomance=Math.floor(1e3/this._simulationStepDuration),this._actualPerfomance=this._desiredPerfomance,this._perfomanceIndex=1,this._desiredQuality=1,this._quality=this._desiredQuality,this._checkInterval=500}return i(t,[{key:"start",value:function(){this._started=!0;var t=this;this._checkLoop=setInterval(function(){t._check()},this._checkInterval)}},{key:"stop",value:function(){this._started=!1,this._checkLoop&&(clearInterval(this._checkLoop),this._checkLoop=null)}},{key:"setSimulationStepDuration",value:function(t){t!=this._simulationStepDuration&&(this._quality=this._desiredQuality),this._simulationStepDuration=t,this._desiredPerfomance=Math.floor(1e3/t)}},{key:"onSimulationStep",value:function(){this._started&&this._stepCounter++}},{key:"_check",value:function(){this._actualPerfomance=Math.ceil(this._stepCounter*(1e3/this._checkInterval)),this._stepCounter=0;var t=this._desiredPerfomance?this._actualPerfomance/this._desiredPerfomance:1;this._perfomanceIndex=(this._perfomanceIndex+t)/2,this._updateQuality()}},{key:"_updateQuality",value:function(){var t=2.5*this._perfomanceIndex-1.25;t=Math.max(0,Math.min(1,t));var e=-.5*this._perfomanceIndex+.45;this._perfomanceIndex>1?this._desiredQuality+=.1:this._desiredQuality-=e,this._desiredQuality=Math.max(0,Math.min(1,this._desiredQuality));var n=Math.max(t,this._desiredQuality);this._desiredQuality=(this._desiredQuality+n)/2,this._desiredQuality<this._quality?this._quality=this._desiredQuality:this._quality=(this._desiredQuality+9*this._quality)/10}},{key:"started",get:function(){return this._started}},{key:"desiredPerfomance",get:function(){return this._desiredPerfomance}},{key:"actualPerfomance",get:function(){return this._actualPerfomance}},{key:"qualityLevel",get:function(){return this._quality}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=c(n(7)),a=c(n(44)),s=c(n(45)),u=c(n(46)),l=c(n(47));function c(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._frameCounter=0,t._fpsLabel=null,t._scoreBoard=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"initBatlefield",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t);var n=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._fpsLabel=new PIXI.Text("FPS",n),this._fpsLabel.x=100,this._fpsLabel.y=5,this.stage.addChild(this._fpsLabel);var i=this;setInterval(function(){i._fpsLabel.text="FPS: "+i._frameCounter,i._frameCounter=0},1e3),n=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"}),this._scoreBoard=new PIXI.Text("scores",n),this._scoreBoard.x=t.margin+2,this._scoreBoard.y=t.margin+2,this._scoreBoard.alpha=.5,this.stage.addChild(this._scoreBoard)}},{key:"renderTankStats",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTankStats",this).call(this,t);var n=[],i=void 0;for(i=0;i<t.length;i++)n.push({name:t[i].fullName,energy:t[i].energy,value:t[i].score});n.sort(function(t,e){return t.value<e.value?1:t.value>e.value?-1:0});var o="";for(i=0;i<n.length;i++)o+=n[i].value.toFixed(3)+" - "+n[i].name+(0==n[i].energy?" [X]":"")+"\n";this._scoreBoard.text=o}},{key:"postRender",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._frameCounter++}},{key:"_createBattlefieldView",value:function(t){return new a.default(t)}},{key:"_createClockView",value:function(t){return new s.default(t)}},{key:"_createBulletView",value:function(t){return new u.default(t)}},{key:"_createTankView",value:function(t){return new l.default(t)}}]),e}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(6)),o=a(n(11));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._tankMap=[],t._bulletMap=[],t._offsetX=0,t._offsetY=0,t._speedMultiplier=1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"initBatlefield",value:function(t){this._offsetX=t.offsetX,this._offsetY=t.offsetY}},{key:"renderTank",value:function(t,e){this._renderModel(t,e,this._tankMap,this._createTankView)}},{key:"renderBullet",value:function(t,e){this._renderModel(t,e,this._bulletMap,this._createBulletView)}},{key:"getBulletView",value:function(t){return this._bulletMap[t]}},{key:"getTankView",value:function(t){return this._tankMap[t]}},{key:"setSpeed",value:function(t){this._speedMultiplier=t}},{key:"_renderModel",value:function(t,e,n,i){var r=null;return n[t.id]?r=n[t.id]:(r=i(t),n[t.id]=r),r.update(e),r}},{key:"_createTankView",value:function(t){return new o.default(t)}},{key:"_createBulletView",value:function(t){return new o.default(t)}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"speedMultiplier",get:function(){return this._speedMultiplier}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"construct",value:function(){this._msElapsed=0,this._msLimit=0}},{key:"update",value:function(t,e){this._msElapsed=t,this._msLimit=e}},{key:"msElapsed",get:function(){return this._msElapsed}},{key:"msLimit",get:function(){return this._msLimit}},{key:"text",get:function(){var t=Math.max(0,this._msLimit-this._msElapsed),e=Math.floor(t/1e3),n=t%1e3;for(e=e.toString();e.length<2;)e="0"+e;for(n=n.toString();n.length<3;)n="0"+n;return"0:"+e+"."+n}}]),t}();e.default=r},function(t,e,n){"use strict";var i=n(41).Resource;t.exports=function(t){return function(e,n){if(!e.data||e.type!==i.TYPE.JSON||!e.data.meta||"pixi-packer"!==e.data.meta.type)return n();if(e.data.meta.version>1)throw new Error("pixi-packer manifest version "+e.data.meta.version+" not supported");var r,o=this,a={crossOrigin:e.crossOrigin,loadType:i.LOAD_TYPE.IMAGE,parentResource:e},s=e.url.replace(o.baseUrl,""),u=((r=s.split("/")).pop(),r.join("/")),l=e.data.resolution;e.data.spritesheets.length&&100===o.progress&&(o.progress=0);var c=new function(t,e){var n=t;this.done=function(){0==--n&&e()}}(e.data.spritesheets.length,n);e.data.spritesheets.forEach(function(e){var n=e.image,i=u+"/"+e.image;o.add(n,i,a,function(n){n.texture.baseTexture.resolution=l,n.texture.baseTexture.update(),n.textures={},e.sprites.forEach(function(e){var i,r=new t.Rectangle(e.position.x/l,e.position.y/l,e.dimension.w/l,e.dimension.h/l);i=Number(t.VERSION.charAt(0))>=4?new t.Rectangle(0,0,e.dimension.w/l,e.dimension.h/l):r.clone();var o=null;e.trim&&(Number(t.VERSION.charAt(0))>=4?(o=new t.Rectangle(e.trim.x/l,e.trim.y/l,e.trim.w/l,e.trim.h/l),r.width=e.trim.w/l,r.height=e.trim.h/l):(o=new t.Rectangle(e.trim.x/l,e.trim.y/l,r.width,r.height),i.width=e.trim.w/l,i.height=e.trim.h/l)),n.textures[e.name]=new t.Texture(n.texture.baseTexture,r,i,o,!1),t.utils.TextureCache[e.name]=n.textures[e.name]}),c.done()})})}}},function(t,e,n){"use strict";var i=n(42).default,r=n(15).default,o=n(14),a=n(43);i.Resource=r,i.async=o,i.base64=a,t.exports=i,t.exports.default=i},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return void 0===t?"undefined":i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":i(t)},o=l(n(12)),a=l(n(13)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(14)),u=l(n(15));function l(t){return t&&t.__esModule?t:{default:t}}var c=/(#[\w-]+)?$/,h=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=n,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,n){return e._loadResource(t,n)},this._queue=s.queue(this._boundLoadResource,i),this._queue.pause(),this.resources={},this.onProgress=new o.default,this.onError=new o.default,this.onLoad=new o.default,this.onStart=new o.default,this.onComplete=new o.default}return t.prototype.add=function(t,e,n,i){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===(void 0===t?"undefined":r(t))&&(i=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(i=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new u.default(t,e,n),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var a=n.parentResource,s=[],l=0;l<a.children.length;++l)a.children[l].isComplete||s.push(a.children[l]);var c=a.progressChunk*(s.length+1)/(s.length+2);a.children.push(this.resources[t]),a.progressChunk=c;for(var h=0;h<s.length;++h)s[h].progressChunk=c;this.resources[t].progressChunk=c}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},t.prototype._prepareUrl=function(t){var e=(0,a.default)(t,{strictMode:!0}),n=void 0;if(n=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=c.exec(n)[0];-1!==(n=n.substr(0,n.length-i.length)).indexOf("?")?n+="&"+this.defaultQueryString:n+="?"+this.defaultQueryString,n+=i}return n},t.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,s.eachSeries(this._beforeMiddleware,function(e,i){e.call(n,t,function(){i(t.isComplete?{}:null)})},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())},!0)},t.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),s.eachSeries(this._afterMiddleware,function(n,i){n.call(e,t,i)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&(e.progress=100,e._onComplete())},!0)},t}();e.default=h},function(t,e,n){"use strict";e.__esModule=!0,e.encodeBinary=function(t){var e="",n=0;for(;n<t.length;){for(var r=[0,0,0],o=[0,0,0,0],a=0;a<r.length;++a)n<t.length?r[a]=255&t.charCodeAt(n++):r[a]=0;o[0]=r[0]>>2,o[1]=(3&r[0])<<4|r[1]>>4,o[2]=(15&r[1])<<2|r[2]>>6,o[3]=63&r[2];var s=n-(t.length-1);switch(s){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var u=0;u<o.length;++u)e+=i.charAt(o[u])}return e};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=new PIXI.Graphics;e.beginFill(0),e.lineStyle(1,16776960,.8),e.drawRect(0,0,this.model.width+2*this.model.margin,this.model.height+2*this.model.margin),e.endFill(),t.addChild(e),(e=new PIXI.Graphics).beginFill(0),e.lineStyle(1,16776960,.8),e.drawRect(this.model.margin,this.model.margin,this.model.width,this.model.height),e.endFill(),t.addChild(e)}},{key:"update",value:function(t){}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._label=new PIXI.Text("clock",e),this._label.x=5,this._label.y=5,t.addChild(this._label)}},{key:"update",value:function(t){this._label.text=this.model.text}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(8),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=new PIXI.Graphics;e.beginFill(65280,.5),e.drawCircle(0,0,5),e.endFill(),t.addChild(e)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(4),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_createBody",value:function(){var t=new PIXI.Graphics;return t.lineStyle(1,16776960,.8),t.beginFill(65280,.5),t.drawRect(-15,-15,30,30),t.endFill(),t}},{key:"_createGun",value:function(){var t=new PIXI.Graphics;return t.beginFill(65280,.5),t.lineStyle(1,16776960,.8),t.drawCircle(0,0,10),t.drawRect(0,-3,30,6),t.endFill(),t}},{key:"_createRadar",value:function(){var t=new PIXI.Graphics;t.beginFill(65280,.5),t.lineStyle(1,16776960,.8),t.drawRect(-3,-10,6,20),t.endFill(),t.lineStyle(),t.beginFill(11206570,.1),t.moveTo(0,-3);var e=300*Math.tan(Math.PI/180*6)/2;return t.lineTo(300,-e),t.lineTo(300,e),t.lineTo(0,3),t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:65280}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.lineStyle(1,16776960,.8),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(65280,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=c(n(7)),a=c(n(49)),s=c(n(50)),u=c(n(51)),l=c(n(52));function c(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"bw"));return t._bigBoomAnim=[],t._smallBoomAnim=[],t._shakeTimer=0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"onAssetsLoaded",value:function(){for(var t=0;t<=9;t++)this._bigBoomAnim.push(PIXI.Texture.fromFrame("big_boom_00"+t)),this._smallBoomAnim.push(PIXI.Texture.fromFrame("small_boom_00"+t))}},{key:"initBatlefield",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t)}},{key:"renderTank",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n),0==t.energy&&(this._shakeTimer=10,this._addExplosion(t.x,t.y,this._bigBoomAnim))}},{key:"renderBullet",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n),t.exploded&&this._addExplosion(t.x,t.y,this._smallBoomAnim)}},{key:"postRender",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY)}},{key:"_createBattlefieldView",value:function(t){return new a.default(t)}},{key:"_createClockView",value:function(t){return new s.default(t)}},{key:"_createBulletView",value:function(t){return new u.default(t)}},{key:"_createTankView",value:function(t){return new l.default(t)}},{key:"_addExplosion",value:function(t,e,n){var i=new PIXI.extras.AnimatedSprite(n);i.anchor.set(.5),this.masterContainer.addChild(i),i.x=t,i.y=e,i.loop=!1,i.onComplete=function(){this.stop(),this.parent.removeChild(this)},i.play()}}]),e}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("battlefield");t.addChild(e)}},{key:"update",value:function(t){}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new PIXI.Text("clock",e),this._label.x=10,this._label.y=580,t.addChild(this._label)}},{key:"update",value:function(t){this._label.text=this.model.text}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(8),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("bullet");e.anchor.set(.5),t.addChild(e)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(4),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"update",value:function(t){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._shoot.alpha=this.model.isShooting?1:.7*this._shoot.alpha}},{key:"_createBody",value:function(){var t=PIXI.Sprite.fromFrame("tank_body");return t.anchor.set(.5),t}},{key:"_createGun",value:function(){var t=new PIXI.Container,e=PIXI.Sprite.fromFrame("tank_gun");return e.anchor.set(.3,.5),t.addChild(e),this._shoot=PIXI.Sprite.fromFrame("tank_shoot"),this._shoot.anchor.set(-1.2,.5),this._shoot.alpha=0,t.addChild(this._shoot),t}},{key:"_createRadar",value:function(){var t=PIXI.Sprite.fromFrame("tank_radar");return t.anchor.set(.5),t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:12,fill:0}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(16711680,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=h(n(7)),a=h(n(54)),s=h(n(55)),u=h(n(56)),l=h(n(57)),c=h(n(58));function h(t){return t&&t.__esModule?t:{default:t}}var f=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"brody"));return t._bigBoomAnim=[],t._shakeTimer=0,t._particleContainer=null,t._particleList=[],t._explosionList=[],t._settings=new c.default,t._masterContainer.addChild(t._bulletContainer),t._frameTimer=0,t._frameCounter=0,t._fpsInterval=null,t._fps=30,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),i(e,[{key:"onAssetsLoaded",value:function(){var t=void 0;for(t=0;t<=22;t++)this._bigBoomAnim.push(PIXI.Texture.fromFrame("big_boom_0"+(t<10?"0"+t:t)))}},{key:"initBatlefield",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initBatlefield",this).call(this,t),this.battlefieldView.configure(this._settings),this._particleContainer=new PIXI.particles.ParticleContainer(1e3,{position:!0,rotation:!0,alpha:!0}),this._masterContainer.addChild(this._particleContainer),this._masterContainer.addChild(this._hudContainer);var n=this;this._fpsInterval=setInterval(function(){n._fps=n._frameCounter,n._frameCounter=0},1e3)}},{key:"renderTank",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderTank",this).call(this,t,n);var i=void 0;for(i in n)if("destroy"==n[i].type){this._shakeTimer=10,this._addTankExplosion(t);break}var o=t.throttle>0?180:0,a=(t.angle+o)*(Math.PI/180);if(t.speed>1){var s=t.x+20*Math.cos(a-Math.PI/4)+7*Math.cos(a),u=t.y+20*Math.sin(a-Math.PI/4)+7*Math.sin(a),l=t.x+20*Math.cos(a+Math.PI/4)+7*Math.cos(a),c=t.y+20*Math.sin(a+Math.PI/4)+7*Math.sin(a);Math.random()<this.speedMultiplier&&(this._addDirt(s,u),this._addDirt(l,c))}}},{key:"renderBullet",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"renderBullet",this).call(this,t,n),this.getBulletView(t.id).configure(this._settings),t.exploded&&(this._addBulletExplosion(t),this.battlefieldView.addBulletHole(t.x,t.y,t.power))}},{key:"preRender",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"preRender",this).call(this);var t=void 0,n=0,i=void 0;for(i=this._particleList.length-1;i>=0;i--)(t=this._particleList[i])&&(t.x+=this.speedMultiplier*t.speed*t.rotation*Math.cos(t.rotation),t.y+=this.speedMultiplier*t.speed*t.rotation*Math.sin(t.rotation),t.alpha=Math.max(0,t.alpha-this.speedMultiplier*t.alphaSpeed),t.lifetime-=this.speedMultiplier,t.lifetime<=0||n>this._settings.particleLimit?(t.parent.removeChild(t),this._particleList[i]=null):n++);for(i=0;i<this._explosionList.length;i++)this._explosionList[i]&&(this._explosionList[i].alpha=this._explosionList[i].alpha-.12*this.speedMultiplier,this._explosionList[i].alpha<.01&&(this._explosionList[i].parent.removeChild(this._explosionList[i]),this._explosionList[i]=null))}},{key:"postRender",value:function(){this._frameTimer++,this._frameCounter++,this._frameTimer%this._settings.dropFrames==0&&r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY,this._battlefieldView.view.x=10*Math.random()-5,this._battlefieldView.view.y=10*Math.random()-5):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY,this._battlefieldView.view.x=0,this._battlefieldView.view.y=0)}},{key:"stop",value:function(){this._fpsInterval&&clearInterval(this._fpsInterval)}},{key:"_addTankExplosion",value:function(t){this._addExplosion(t.x,t.y,this._bigBoomAnim),this.battlefieldView.addCrater(t.x,t.y),this._addSparks(t.x,t.y,300)}},{key:"_addBulletExplosion",value:function(t){this._addGlow(t.x,t.y,.3+.6*t.power);var e=5+40*t.power;this._addSparks(t.x,t.y,e)}},{key:"_createBattlefieldView",value:function(t){return new a.default(t)}},{key:"_createClockView",value:function(t){return new s.default(t)}},{key:"_createBulletView",value:function(t){return new u.default(t)}},{key:"_createTankView",value:function(t){return new l.default(t)}},{key:"_addExplosion",value:function(t,e,n){this._addGlow(t,e,5);var i=new PIXI.extras.AnimatedSprite(n);i.animationSpeed=this.speedMultiplier,i.anchor.set(.5),this.masterContainer.addChild(i),i.x=t,i.y=e,i.loop=!1,i.blendMode=PIXI.BLEND_MODES.ADD,i.onComplete=function(){this.stop(),this.parent.removeChild(this)},i.play()}},{key:"_addGlow",value:function(t,e,n){if(this._settings.showGlow){var i=PIXI.Sprite.fromFrame("glow");i.anchor.set(.5),i.scale.x=i.scale.y=n,i.alpha=.4,i.blendMode=PIXI.BLEND_MODES.ADD,i.x=t,i.y=e,this.masterContainer.addChild(i),this._explosionList.push(i)}}},{key:"_addSparks",value:function(t,e,n){n=Math.ceil(n*this._settings.quality);for(var i=0;i<n;i++){var r=PIXI.Sprite.fromFrame("spark");r.x=t,r.y=e,r.alphaSpeed=0,r.anchor.set(.5),r.speed=1+2*Math.random(),r.rotation=2*Math.random()*Math.PI,r.lifetime=5+5*Math.random(),this._particleContainer.addChild(r),this._particleList.push(r)}}},{key:"_addDirt",value:function(t,e){if(this._settings.showDirt)for(var n=0;n<5;n++){var i=Math.floor(3*Math.random()),r=PIXI.Sprite.fromFrame("dirt_"+i);r.x=t+4*Math.random()-2,r.y=e+4*Math.random()-2,r.anchor.set(.5),r.speed=0,r.alphaSpeed=.02+.02*Math.random(),r.rotation=0,r.alpha=.1+.4*Math.random(),r.lifetime=25,r.scale.x=r.scale.y=.5+2*Math.random(),this._particleContainer.addChild(r),this._particleList.push(r)}}},{key:"quality",get:function(){return this._settings.quality},set:function(t){this._settings.quality=t}}]),e}();e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._holeList=[],n._settings=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"configure",value:function(t){this._settings=t}},{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("battlefield");t.addChild(e);var n=new PIXI.Graphics;n.beginFill(255,1),n.moveTo(25,25),n.lineTo(875,25),n.lineTo(875,575),n.lineTo(90,575),n.lineTo(90,565),n.lineTo(25,565),n.lineTo(25,25),n.endFill(),this._craterContainer=new PIXI.Container,this._craterContainer.mask=n,t.addChild(this._craterContainer),t.addChild(n);var i=new PIXI.Graphics;i.beginFill(255,.4),i.moveTo(15,15),i.lineTo(885,15),i.lineTo(885,585),i.lineTo(80,585),i.lineTo(80,575),i.lineTo(15,575),i.lineTo(15,15),i.lineTo(25,25),i.lineTo(25,575),i.lineTo(80,575),i.lineTo(80,575),i.lineTo(875,575),i.lineTo(875,25),i.lineTo(25,25),i.endFill(),this._holesContainer=new PIXI.Container,this._holesContainer.mask=i,t.addChild(this._holesContainer),t.addChild(i)}},{key:"addCrater",value:function(t,e){var n=PIXI.Sprite.fromFrame("crater");n.anchor.set(.5),n.x=t-this.model.offsetX,n.y=e-this.model.offsetY,n.blendMode=PIXI.BLEND_MODES.MULTIPLY,n.alpha=.8,this._craterContainer.addChild(n)}},{key:"update",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this._holesContainer.visible=this._settings.skratchLimit>0,this._craterContainer.visible=this._settings.showCraters}},{key:"addBulletHole",value:function(t,e,n){var i=0;if(Math.abs(e-this.model.maxY)<10)e=this.model.maxY+3+3*Math.random();else if(Math.abs(e-this.model.minY)<10)e=this.model.minY-3-3*Math.random();else if(Math.abs(t-this.model.maxX)<10)t=this.model.maxX+3+3*Math.random(),i=Math.PI/2;else{if(!(Math.abs(t-this.model.minX)<10))return;t=this.model.minX-3-3*Math.random(),i=Math.PI/2}var r=PIXI.Sprite.fromFrame("hole");r.anchor.set(.5),r.x=t-this.model.offsetX,r.y=e-this.model.offsetY,r.rotation=i,r.scale.x=r.scale.y=.7+.5*n,this._holesContainer.addChild(r),this._holeList.push(r);for(var o=this._settings?this._settings.skratchLimit:20;this._holeList.length>o;)(r=this._holeList.shift()).parent.removeChild(r)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_create",value:function(t){var e=new PIXI.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new PIXI.Text("clock",e),this._label.x=10,this._label.y=580,t.addChild(this._label)}},{key:"update",value:function(t){this._label.text=this.model.text}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(8),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"configure",value:function(t){this._settings=t}},{key:"update",value:function(t){(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._glow.visible=this._settings&&this._settings.showGlow}},{key:"_create",value:function(t){var e=PIXI.Sprite.fromFrame("bullet");e.anchor.set(.5);var n=PIXI.Sprite.fromFrame("glow");n.anchor.set(.5),n.blendMode=PIXI.BLEND_MODES.ADD,n.alpha=.1,this._glow=n,t.addChild(n),t.addChild(e)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(4),s=(i=a)&&i.__esModule?i:{default:i};var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._lightTimer=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this._shoot.alpha=.8*this._shoot.alpha,this._tankGun.x=.8*this._tankGun.x,this.radar.rotation=(-this.model.gunAngle+this._model.radarAngle)*(Math.PI/180),this._lightTimer=this.model.enemySpot?this._lightTimer+1:0,this._light.alpha=.5*-Math.cos(.25*this._lightTimer)+.5}},{key:"_onShoot",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_onShoot",this).call(this,t),this._tankGun.x=-1-3*t.bullet.power,this._shoot.alpha=1}},{key:"_create",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_create",this).call(this,t),this._tankGun.addChild(this.radar)}},{key:"_createBody",value:function(){var t=PIXI.Sprite.fromFrame("tank_body_"+this.model.skin);return t.anchor.set(.3,.5),t}},{key:"_createGun",value:function(){var t=new PIXI.Container,e=PIXI.Sprite.fromFrame("tank_gun_"+this.model.skin);return e.anchor.set(.3,.5),t.addChild(e),this._tankGun=e,this._shoot=PIXI.Sprite.fromFrame("tank_shoot"),this._shoot.anchor.set(.3,.5),this._shoot.alpha=0,this._light=PIXI.Sprite.fromFrame("tank_light"),this._light.anchor.set(.3,.5),this._light.alpha=0,t.addChild(this._shoot),t.addChild(this._light),t}},{key:"_createRadar",value:function(){var t=PIXI.Sprite.fromFrame("tank_radar_"+this.model.skin);return t.anchor.set(.2,.5),t.x=-5,t}},{key:"_createLabel",value:function(){var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:10,stroke:0,strokeThickness:2,fill:16777147}),e=new PIXI.Text("",t);return e.anchor.set(.5,.5),e.x=0,e.y=-40,e}},{key:"_createHudBackground",value:function(){var t=new PIXI.Graphics;return t.beginFill(0,1),t.drawRect(-26,-3,52,6),t.y=-30,t}},{key:"_createEnergyBar",value:function(){var t=new PIXI.Graphics;return t.beginFill(16777113,1),t.drawRect(0,-2,50,4),t.x=-25,t.y=-30,t}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._particleLimit=1e3,this._skratchLimit=100,this._showDirt=!0,this._showGlow=!0,this._showCraters=!0,this._dropFrames=1,this._quality=1,this.quality=this._quality}return i(t,[{key:"dropFrames",get:function(){return this._dropFrames}},{key:"particleLimit",get:function(){return this._particleLimit}},{key:"skratchLimit",get:function(){return this._skratchLimit}},{key:"showDirt",get:function(){return this._showDirt}},{key:"showGlow",get:function(){return this._showGlow}},{key:"showCraters",get:function(){return this._showCraters}},{key:"quality",get:function(){return this._quality},set:function(t){t=Math.min(1,Math.max(0,t)),this._quality=t,this._particleLimit=Math.round(1e3*t*t),this._skratchLimit=Math.round(100*t),this._showDirt=t>.2,this._showGlow=t>.5,this._showCraters=t>.1,this._dropFrames=t>.3?1:t>.2?2:t>.1?3:4,this._quality=t}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(6),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"renderTank",value:function(t,e){}},{key:"renderBullet",value:function(t,e){}},{key:"loadAssets",value:function(t){t()}},{key:"init",value:function(){}}]),e}();e.default=s}]);
//# sourceMappingURL=jsbattle.min.js.map