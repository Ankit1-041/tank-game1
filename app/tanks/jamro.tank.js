// figure it out on your own :)
var JamroTank=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";importScripts("lib/tank.js");var r,i,a,o,u=n(1),s=n(4),h=n(5),c=n(9),l=null;tank.init(function(t){(t=t||{}).SKIN=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.reverse().map(function(t,n){return String.fromCharCode(t-e-52-n)}).join("")}(19,173)+891..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.reverse().map(function(t,n){return String.fromCharCode(t-e-28-n)}).join("")}(23,152)+28..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.reverse().map(function(t,n){return String.fromCharCode(t-e-48-n)}).join("")}(35,199),r=new u,i=new s,a=new h(r),o=new c}),tank.loop(function(t,e){l&&Math.distance(t.x,t.y,l.x,l.y),r.loop(t);var n=r.tanks.findClosest();i.setEnemy(n),i.setEnemyCount(r.tanks.count),i.update(t.x,t.y,t.angle+t.radar.angle,t.collisions.enemy),e.RADAR_TURN=i.turnOutput,t.collisions.wall?a.setEnemy(null):a.setEnemy(n),a.update(t),e.THROTTLE=a.throttleOutput,e.TURN=a.turnOutput,e.BOOST=a.boostOutput,o.setEnemy(n),o.update(t.x,t.y,t.angle,t.gun.angle,t.radar.angle),e.GUN_TURN=o.turnOutput,e.SHOOT=o.shootOutput,l=t,e.DEBUG=430..toString(36).toLowerCase()+16..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-71)}).join("")+26..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-39)}).join("")+496068..toString(36).toLowerCase()+16..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-71)}).join("")+10..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-39)}).join("")+916..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-71)}).join("")+function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.reverse().map(function(t,n){return String.fromCharCode(t-e-7-n)}).join("")}(9,134,132,118,134)+18..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.reverse().map(function(t,n){return String.fromCharCode(t-e-54-n)}).join("")}(11,119,115,117,99,176,176)+30..toString(36).toLowerCase().split("").map(function(t){return String.fromCharCode(t.charCodeAt()+-71)}).join("")+(0).toString(36).toLowerCase()})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),o=n(3);t.exports=function(){function t(){r(this,t),this._bulletMemory=new o({lifetime:40,force:4}),this._tankMemory=new a({lifetime:40,force:2}),this._wallN=void 0,this._wallS=void 0,this._wallW=void 0,this._wallE=void 0,this._debug={}}return i(t,[{key:"loop",value:function(t){this._bulletMemory.predict(),this._bulletMemory.add(t.radar.bullets),this._tankMemory.predict(),t.radar.enemy&&this._tankMemory.add(t.radar.enemy);var e=Math.deg.normalize(t.angle+t.radar.angle);t.radar.wallDistance&&e<-85&&e>-95&&(this._wallN=t.y-t.radar.wallDistance),t.radar.wallDistance&&e>85&&e<95&&(this._wallS=t.y+t.radar.wallDistance),t.radar.wallDistance&&e>-5&&e<5&&(this._wallE=t.x+t.radar.wallDistance),t.radar.wallDistance&&(e>175||e<-175)&&(this._wallW=t.x-t.radar.wallDistance)}},{key:"getForceVector",value:function(t,e){var n=this._tankMemory.getForceVector(t,e),r=this._bulletMemory.getForceVector(t,e),i=this._getWallForceVector(t,e),a=n.x+r.x+i.x,o=n.y+r.y+i.y,u=n.value+r.value+i.value;return this._debug.tankForce=1e6*n.value,this._debug.bulletForce=1e6*r.value,this._debug.wallForce=1e6*i.value,{x:a,y:o,r:Math.distance(0,0,a,o),value:u}}},{key:"_getWallForceVector",value:function(t,e){var n,r=0,i=0,a=0;return void 0!==this._wallN&&(n=(n=Math.abs(e-this._wallN))?1/(n*n*n):1,a+=n*=100,i+=n),void 0!==this._wallS&&(n=(n=Math.abs(this._wallS-e))?1/(n*n*n):1,a+=n*=100,i-=n),void 0!==this._wallE&&(n=(n=Math.abs(t-this._wallE))?1/(n*n*n):1,a+=n*=100,r-=n,n),void 0!==this._wallW&&(n=(n=Math.abs(this._wallW-t))?1/(n*n*n):1,a+=n*=100,r+=n,n),{x:r,y:i,r:Math.distance(0,0,r,i),value:a}}},{key:"debug",get:function(){return this._debug}},{key:"bullets",get:function(){return this._bulletMemory}},{key:"tanks",get:function(){return this._tankMemory}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),e||(e={}),this._map=[],this._permanentMap=[],this._count=0,this._lifetime=e.lifetime?e.lifetime:30,this._force=e.force?e.force:1}return r(t,[{key:"findClosestPermanent",value:function(t,e){return this._findClosest(t,e,this._permanentMap)}},{key:"findClosest",value:function(t,e){return this._findClosest(t,e,this._map)}},{key:"_findClosest",value:function(t,e,n){var r,i,a,o=null;for(i in n)if(a=n[i]){var u=Math.distance(t,e,a.x,a.y);(!o||r>u)&&(r=u,o=a)}return o}},{key:"predict",value:function(){var t,e,n;this._count=0;for(t in this._map)if(n=this._map[t])if(n.age>this._lifetime)this._map[t]=null;else if(0==n.age?n.radarTime++:n.radarTime=0,n.age++,n.x+=n.vx,n.y+=n.vy,this._count++,void 0!==n.energy){for(;n.energyDropHistory.length>100;)n.energyDropHistory.shift();for(n.energyDropSum=0,e=0;e<n.energyDropHistory.length;e++)n.energyDropSum+=n.energyDropHistory[e];n.energyDropRate=n.energyDropSum/n.energyDropHistory.length}}},{key:"add",value:function(t){if(!Array.isArray(t))return this._addSingle(t);var e,n;for(e=0;e<t.length;e++)n=t[e],this._addSingle(n)}},{key:"getForceVector",value:function(t,e){var n,r,i={x:0,y:0,r:0,value:0};for(n in this._map)(r=this._map[n])&&this._getObjForceVector(r,i,t,e);return i.r=Math.distance(0,0,i.x,i.y),i}},{key:"_getObjForceVector",value:function(t,e,n,r){var t,i,a,o;i=Math.distance(n,r,t.x,t.y),a=(n-t.x)/i,o=(r-t.y)/i,i=i?1/(i*i):1,a*=i*=this._force,o*=i,e.x+=a,e.y+=o,e.value+=i}},{key:"_addSingle",value:function(t){if(t.age=0,t.radarTime=0,t.vx=t.speed*Math.cos(t.angle*(Math.PI/180)),t.vy=t.speed*Math.sin(t.angle*(Math.PI/180)),this._permanentMap[t.id]&&(t.radarTime=this._permanentMap[t.id].radarTime),void 0!==t.energy&&(t.energyDropSum=0,t.energyDropRate=void 0,t.energyDropHistory=[]),void 0!==t.energy&&this._permanentMap[t.id]&&this._permanentMap[t.id].energy){var e=(t.energy-this._permanentMap[t.id].energy)/this._permanentMap[t.id].age;t.energyDropHistory=this._permanentMap[t.id].energyDropHistory,t.energyDropSum=this._permanentMap[t.id].energyDropSum,t.energyDropRate=this._permanentMap[t.id].energyDropRate,t.energyDropHistory.push(e)}this._map[t.id]=t,this._permanentMap[t.id]=t}},{key:"count",get:function(){return this._count}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(2);t.exports=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,u),o(e,[{key:"_getObjForceVector",value:function(t,e,n,r){var i=Math.tan(t.angle*(Math.PI/180)),a=t.y-i*t.x,o=i?-1/i:0x3a052cf8639b6a,u=r-o*n,s=i-o!=0?(u-a)/(i-o):NaN,h=i*s+a,c=Math.distance(n,r,s,h),l=(n-s)/c,y=(r-h)/c,f=Math.distance(n,r,t.x,t.y);void 0!==t.lastDistance?t.distanceSpeed=f-t.lastDistance:t.distanceSpeed=0,t.lastDistance=f,t.distanceSpeed>0&&f>100||(c=c?1/(f*f):1,c*=this._force,l*=c*=1+.5*t.damage/13,y*=c,isNaN(l)||isNaN(y)||isNaN(c)||(e.x+=l,e.y+=y,e.value+=c))}}]),e}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(){n(this,t),this._enemy=null,this._radarTurnDirection=1,this._focusTime=120,this._searchTime=60,this._timer=0,this._enemyCount=0,this._turnOutput=this._radarTurnDirection}return r(t,[{key:"setEnemy",value:function(t){this._enemy=t}},{key:"setEnemyCount",value:function(t){this._enemyCount=t}},{key:"update",value:function(t,e,n,r){if(this._timer++,this._enemy&&r&&Math.distance(t,e,this._enemy.x,this._enemy.y)<100&&(this._enemy=this._focusTime+1),this._enemy)if(this._timer>this._focusTime&&this._timer<this._focusTime+this._searchTime)this._search();else if(this._timer>this._focusTime+this._searchTime)this._reset();else{var i=Math.deg.atan2(this._enemy.y-e,this._enemy.x-t),a=Math.deg.normalize(i-n);this._turnOutput=.2*a,this._radarTurnDirection=this._turnOutput>0?1:-1}else this._search()}},{key:"_search",value:function(){this._turnOutput=this._radarTurnDirection}},{key:"_reset",value:function(){this._timer=0,this._enemyCount<=1?this._focusTime+=60:this._focusTime=120,this._search()}},{key:"turnOutput",get:function(){return this._turnOutput}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(6),o=n(7),u=n(8);t.exports=function(){function t(e){r(this,t),this._followStrategy=new a(e),this._ramStrategy=new o(e),this._searchStrategy=new u(e),this._strategy=this._followStrategy,this._debug={},this._enemy=null,this._ramTimer=0}return i(t,[{key:"setEnemy",value:function(t){this._enemy=t,this._strategy.setEnemy(t)}},{key:"update",value:function(t){this._ramTimer=Math.max(0,this._ramTimer-1),this._enemy&&this._enemy.energyDropRate>-.05&&this._enemy.age<5&&this._enemy.radarTime>200&&(this._ramTimer=700),this._enemy&&this._ramTimer>0?(this._strategy=this._ramStrategy,this._debug.strategy="ram"):this._enemy?(this._strategy=this._followStrategy,this._debug.strategy="ram"):(this._strategy=this._searchStrategy,this._debug.strategy="search"),this._strategy.update(t),this._debug.strategyDebug=this._strategy.debug,this._debug.radarTime=this._enemy?this._enemy.radarTime:null,this._debug.energyDropRate=this._enemy?this._enemy.energyDropRate:null,this._debug.ramTimer=this._ramTimer}},{key:"debug",get:function(){return this._debug}},{key:"throttleOutput",get:function(){return this._strategy.throttleOutput}},{key:"turnOutput",get:function(){return this._strategy.turnOutput}},{key:"boostOutput",get:function(){return this._strategy.boostOutput}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),this._map=e,this._boostOutput=0,this._turnOutput=0,this._throttleOutput=0,this._enemy=null,this._debug={},this._targetDistance=250}return r(t,[{key:"setEnemy",value:function(t){this._enemy=t}},{key:"update",value:function(t){var e=t.x,n=t.y,r=t.angle,i=(t.collisions.enemy,this._map.getForceVector(e,n));if(this._enemy){var a=Math.distance(e,n,this._enemy.x,this._enemy.y);this._enemy&&this._enemy.energyDropRate>-.05?this._targetDistance=100:this._targetDistance=Math.min(250,this._targetDistance+1);var o=this._targetDistance-a,u=this._targetDistance>a?-1:1,s=a?(this._enemy.x-e)/a:0,h=a?(this._enemy.y-n)/a:0;o*=o,s*=o*=1e-7*u,h*=o,o=Math.abs(o),i.x+=s,i.y+=h,i.value+=o,i.r=Math.distance(0,0,i.x,i.y),this._debug={targetDistance:this._targetDistance,distance:a,r:1e6*o}}i.r?(i.x=i.value*(i.x/i.r),i.y=i.value*(i.y/i.r)):(i.x=0,i.y=0);var c=Math.deg.atan2(i.y,i.x),l=1,y=Math.deg.normalize(c-r);y>90?(y-=180,l=-1):y<-90&&(y+=180,l=-1),this._turnOutput=.2*y,Math.abs(y)<90?(this._throttleOutput=l,this._boostOutput=1e3*i.r>1.3?1:0):(this._throttleOutput=0,this._boostOutput=0)}},{key:"debug",get:function(){return this._debug}},{key:"throttleOutput",get:function(){return this._throttleOutput}},{key:"turnOutput",get:function(){return this._turnOutput}},{key:"boostOutput",get:function(){return this._boostOutput}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),this._map=e,this._boostOutput=0,this._turnOutput=0,this._throttleOutput=0,this._enemy=null,this._debug={},this._goBackTimer=0}return r(t,[{key:"setEnemy",value:function(t){this._enemy=t}},{key:"update",value:function(t){var e=t.x,n=t.y,r=t.angle,i=t.collisions.enemy;this._goBackTimer=Math.max(0,this._goBackTimer-1);var a=this._map.getForceVector(e,n),o=Number.MAX_VALUE;if(this._enemy){var u=Math.distance(e,n,this._enemy.x,this._enemy.y),s=u?(this._enemy.x-e)/u:0,h=u?(this._enemy.y-n)/u:0;u=u?1/u*u:0,s*=u*=10,h*=u,u=Math.abs(u),a.x+=s,a.y+=h,a.value+=u,a.r=Math.distance(0,0,a.x,a.y),o=u}a.r?(a.x=a.value*(a.x/a.r),a.y=a.value*(a.y/a.r)):(a.x=0,a.y=0);var c=Math.deg.atan2(a.y,a.x),l=1,y=Math.deg.normalize(c-r);y>90?(y-=180,l=-1):y<-90&&(y+=180,l=-1),i&&(this._goBackTimer=30),this._goBackTimer>0&&(l*=-1),this._turnOutput=.2*y,Math.abs(y)<90?this._throttleOutput=l:this._throttleOutput=0,this._boostOutput=o<100&&0==this._goBackTimer?1:0}},{key:"debug",get:function(){return this._debug}},{key:"throttleOutput",get:function(){return this._throttleOutput}},{key:"turnOutput",get:function(){return this._turnOutput}},{key:"boostOutput",get:function(){return this._boostOutput}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){n(this,t),this._map=e,this._turnDirection=Math.random()<.5?1:-1,this._turnTimer=Math.round(Math.randomRange(0,30))}return r(t,[{key:"setEnemy",value:function(t){this._enemy=t}},{key:"update",value:function(t){(t.collisions.wall||t.collisions.enemy)&&(this._turnTimer=Math.round(Math.randomRange(20,50))),this._turnTimer>0?(this._turnTimer--,this._throttleOutput=0,this._turnOutput=this._turnDirection):(this._throttleOutput=1,this._turnOutput=0),this._boostOutput=0}},{key:"debug",get:function(){return this._debug}},{key:"throttleOutput",get:function(){return this._throttleOutput}},{key:"turnOutput",get:function(){return this._turnOutput}},{key:"boostOutput",get:function(){return this._boostOutput}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(){n(this,t),this._turnOutput=0,this._shootOutput=0,this._enemy=null}return r(t,[{key:"setEnemy",value:function(t){this._enemy=t}},{key:"update",value:function(t,e,n,r,i){var a,o=n+r;if(!this._enemy)return a=Math.deg.normalize(i-r),this._turnOutput=.2*a,void(this._shootOutput=0);var u,s,h=this._enemy.x,c=this._enemy.y,l=this._enemy.speed,y=this._enemy.angle*(Math.PI/180);u=0,s=1;for(var f=0;f<10&&Math.abs(s)>=1;f++)u+=s=Math.distance(t,e,h,c)/4-u,h=this._enemy.x+u*l*Math.cos(y),c=this._enemy.y+u*l*Math.sin(y);var _=Math.deg.atan2(c-e,h-t);a=Math.deg.normalize(_-o),this._turnOutput=.2*a;var p=Math.min(1,Math.max(.1,(10-this._enemy.age)/10));this._enemy&&this._enemy.energyDropRate>-.05&&(p=.1),Math.abs(a)<4+4*(1-p)?this._shootOutput=p:this._shootOutput=0}},{key:"turnOutput",get:function(){return this._turnOutput}},{key:"shootOutput",get:function(){return this._shootOutput}}]),t}()}]);
