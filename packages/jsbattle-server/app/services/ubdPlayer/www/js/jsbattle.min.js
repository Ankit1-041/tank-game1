!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=78)}([function(e,t){e.exports=PIXI},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e=l(["(",")"]);return o=function(){return e},e}function i(){var e=l([""," "," ",""]);return i=function(){return e},e}function a(){var e=l(["!",""]);return a=function(){return e},e}function u(){var e=l(["Object.keys(",")"]);return u=function(){return e},e}function s(){var e=l(["","[","]"]);return s=function(){return e},e}function c(){var e=l(["",".length"]);return c=function(){return e},e}function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function p(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k(this,n)}}function k(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t&&P(e.prototype,t),n&&P(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;var x=n(17),E=n(21),C=n(17);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return C._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return C.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return C.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return C.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return C.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return C.stringify}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return C.Name}});var T=n(21);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return T.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return T.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return T.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return T.varKinds}}),t.operators={GT:new x._Code(">"),GTE:new x._Code(">="),LT:new x._Code("<"),LTE:new x._Code("<="),EQ:new x._Code("==="),NEQ:new x._Code("!=="),NOT:new x._Code("!"),OR:new x._Code("||"),AND:new x._Code("&&")};var R=function(){function e(){O(this,e)}return j(e,[{key:"optimizeNodes",value:function(){return this}},{key:"optimizeNames",value:function(e,t){return this}}]),e}(),A=function(e){_(n,e);var t=w(n);function n(e,r,o){var i;return O(this,n),(i=t.call(this)).varKind=e,i.name=r,i.rhs=o,i}return j(n,[{key:"render",value:function(e){var t=e.es5,n=e._n,r=t?E.varKinds.var:this.varKind,o=void 0===this.rhs?"":" = ".concat(this.rhs);return"".concat(r," ").concat(this.name).concat(o,";")+n}},{key:"optimizeNames",value:function(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=te(this.rhs,e,t)),this}},{key:"names",get:function(){return this.rhs instanceof x._CodeOrName?this.rhs.names:{}}}]),n}(R),D=function(e){_(n,e);var t=w(n);function n(e,r,o){var i;return O(this,n),(i=t.call(this)).lhs=e,i.rhs=r,i.sideEffects=o,i}return j(n,[{key:"render",value:function(e){var t=e._n;return"".concat(this.lhs," = ").concat(this.rhs,";")+t}},{key:"optimizeNames",value:function(e,t){if(!(this.lhs instanceof x.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=te(this.rhs,e,t),this}},{key:"names",get:function(){return ee(this.lhs instanceof x.Name?{}:v({},this.lhs.names),this.rhs)}}]),n}(R),M=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).label=e,r.names={},r}return j(n,[{key:"render",value:function(e){var t=e._n;return"".concat(this.label,":")+t}}]),n}(R),N=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).label=e,r.names={},r}return j(n,[{key:"render",value:function(e){var t=e._n,n=this.label?" ".concat(this.label):"";return"break".concat(n,";")+t}}]),n}(R),I=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).error=e,r}return j(n,[{key:"render",value:function(e){var t=e._n;return"throw ".concat(this.error,";")+t}},{key:"names",get:function(){return this.error.names}}]),n}(R),L=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).code=e,r}return j(n,[{key:"render",value:function(e){var t=e._n;return"".concat(this.code,";")+t}},{key:"optimizeNodes",value:function(){return"".concat(this.code)?this:void 0}},{key:"optimizeNames",value:function(e,t){return this.code=te(this.code,e,t),this}},{key:"names",get:function(){return this.code instanceof x._CodeOrName?this.code.names:{}}}]),n}(R),$=function(e){_(n,e);var t=w(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return O(this,n),(e=t.call(this)).nodes=r,e}return j(n,[{key:"render",value:function(e){return this.nodes.reduce((function(t,n){return t+n.render(e)}),"")}},{key:"optimizeNodes",value:function(){for(var e=this.nodes,t=e.length;t--;){var n=e[t].optimizeNodes();Array.isArray(n)?e.splice.apply(e,[t,1].concat(p(n))):n?e[t]=n:e.splice(t,1)}return e.length>0?this:void 0}},{key:"optimizeNames",value:function(e,t){for(var n=this.nodes,r=n.length;r--;){var o=n[r];o.optimizeNames(e,t)||(ne(e,o.names),n.splice(r,1))}return n.length>0?this:void 0}},{key:"names",get:function(){return this.nodes.reduce((function(e,t){return Z(e,t.names)}),{})}}]),n}(R),V=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return j(n,[{key:"render",value:function(e){return"{"+e._n+h(S(n.prototype),"render",this).call(this,e)+"}"+e._n}}]),n}($),z=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return n}($),B=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return n}(V);B.kind="else";var U=function(e){_(n,e);var t=w(n);function n(e,r){var o;return O(this,n),(o=t.call(this,r)).condition=e,o}return j(n,[{key:"render",value:function(e){var t="if(".concat(this.condition,")")+h(S(n.prototype),"render",this).call(this,e);return this.else&&(t+="else "+this.else.render(e)),t}},{key:"optimizeNodes",value:function(){h(S(n.prototype),"optimizeNodes",this).call(this);var e=this.condition;if(!0===e)return this.nodes;var t=this.else;if(t){var r=t.optimizeNodes();t=this.else=Array.isArray(r)?new B(r):r}return t?!1===e?t instanceof n?t:t.nodes:this.nodes.length?this:new n(re(e),t instanceof n?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}},{key:"optimizeNames",value:function(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),h(S(n.prototype),"optimizeNames",this).call(this,e,t)||this.else)return this.condition=te(this.condition,e,t),this}},{key:"names",get:function(){var e=h(S(n.prototype),"names",this);return ee(e,this.condition),this.else&&Z(e,this.else.names),e}}]),n}(V);U.kind="if";var F=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return n}(V);F.kind="for";var q=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).iteration=e,r}return j(n,[{key:"render",value:function(e){return"for(".concat(this.iteration,")")+h(S(n.prototype),"render",this).call(this,e)}},{key:"optimizeNames",value:function(e,t){if(h(S(n.prototype),"optimizeNames",this).call(this,e,t))return this.iteration=te(this.iteration,e,t),this}},{key:"names",get:function(){return Z(h(S(n.prototype),"names",this),this.iteration.names)}}]),n}(F),H=function(e){_(n,e);var t=w(n);function n(e,r,o,i){var a;return O(this,n),(a=t.call(this)).varKind=e,a.name=r,a.from=o,a.to=i,a}return j(n,[{key:"render",value:function(e){var t=e.es5?E.varKinds.var:this.varKind,r=this.name,o=this.from,i=this.to;return"for(".concat(t," ").concat(r,"=").concat(o,"; ").concat(r,"<").concat(i,"; ").concat(r,"++)")+h(S(n.prototype),"render",this).call(this,e)}},{key:"names",get:function(){var e=ee(h(S(n.prototype),"names",this),this.from);return ee(e,this.to)}}]),n}(F),G=function(e){_(n,e);var t=w(n);function n(e,r,o,i){var a;return O(this,n),(a=t.call(this)).loop=e,a.varKind=r,a.name=o,a.iterable=i,a}return j(n,[{key:"render",value:function(e){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+h(S(n.prototype),"render",this).call(this,e)}},{key:"optimizeNames",value:function(e,t){if(h(S(n.prototype),"optimizeNames",this).call(this,e,t))return this.iterable=te(this.iterable,e,t),this}},{key:"names",get:function(){return Z(h(S(n.prototype),"names",this),this.iterable.names)}}]),n}(F),K=function(e){_(n,e);var t=w(n);function n(e,r,o){var i;return O(this,n),(i=t.call(this)).name=e,i.args=r,i.async=o,i}return j(n,[{key:"render",value:function(e){var t=this.async?"async ":"";return"".concat(t,"function ").concat(this.name,"(").concat(this.args,")")+h(S(n.prototype),"render",this).call(this,e)}}]),n}(V);K.kind="func";var X=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return j(n,[{key:"render",value:function(e){return"return "+h(S(n.prototype),"render",this).call(this,e)}}]),n}($);X.kind="return";var W=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return j(n,[{key:"render",value:function(e){var t="try"+h(S(n.prototype),"render",this).call(this,e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}},{key:"optimizeNodes",value:function(){var e,t;return h(S(n.prototype),"optimizeNodes",this).call(this),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}},{key:"optimizeNames",value:function(e,t){var r,o;return h(S(n.prototype),"optimizeNames",this).call(this,e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(o=this.finally)||void 0===o||o.optimizeNames(e,t),this}},{key:"names",get:function(){var e=h(S(n.prototype),"names",this);return this.catch&&Z(e,this.catch.names),this.finally&&Z(e,this.finally.names),e}}]),n}(V),Y=function(e){_(n,e);var t=w(n);function n(e){var r;return O(this,n),(r=t.call(this)).error=e,r}return j(n,[{key:"render",value:function(e){return"catch(".concat(this.error,")")+h(S(n.prototype),"render",this).call(this,e)}}]),n}(V);Y.kind="catch";var J=function(e){_(n,e);var t=w(n);function n(){return O(this,n),t.apply(this,arguments)}return j(n,[{key:"render",value:function(e){return"finally"+h(S(n.prototype),"render",this).call(this,e)}}]),n}(V);J.kind="finally";var Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};O(this,e),this._values={},this._blockStarts=[],this._constants={},this.opts=v(v({},n),{},{_n:n.lines?"\n":""}),this._extScope=t,this._scope=new E.Scope({parent:t}),this._nodes=[new z]}return j(e,[{key:"toString",value:function(){return this._root.render(this.opts)}},{key:"name",value:function(e){return this._scope.name(e)}},{key:"scopeName",value:function(e){return this._extScope.name(e)}},{key:"scopeValue",value:function(e,t){var n=this._extScope.value(e,t);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}},{key:"getScopeValue",value:function(e,t){return this._extScope.getValue(e,t)}},{key:"scopeRefs",value:function(e){return this._extScope.scopeRefs(e,this._values)}},{key:"scopeCode",value:function(){return this._extScope.scopeCode(this._values)}},{key:"_def",value:function(e,t,n,r){var o=this._scope.toName(t);return void 0!==n&&r&&(this._constants[o.str]=n),this._leafNode(new A(e,o,n)),o}},{key:"const",value:function(e,t,n){return this._def(E.varKinds.const,e,t,n)}},{key:"let",value:function(e,t,n){return this._def(E.varKinds.let,e,t,n)}},{key:"var",value:function(e,t,n){return this._def(E.varKinds.var,e,t,n)}},{key:"assign",value:function(e,t,n){return this._leafNode(new D(e,t,n))}},{key:"code",value:function(e){return"function"==typeof e?e():e!==x.nil&&this._leafNode(new L(e)),this}},{key:"object",value:function(){for(var e=["{"],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=f(i[o],2),u=a[0],s=a[1];e.length>1&&e.push(","),e.push(u),(u!==s||this.opts.es5)&&(e.push(":"),x.addCodeArg(e,s))}return e.push("}"),new x._Code(e)}},{key:"if",value:function(e,t,n){if(this._blockNode(new U(e)),t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}},{key:"elseIf",value:function(e){return this._elseNode(new U(e))}},{key:"else",value:function(){return this._elseNode(new B)}},{key:"endIf",value:function(){return this._endBlockNode(U,B)}},{key:"_for",value:function(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}},{key:"for",value:function(e,t){return this._for(new q(e),t)}},{key:"forRange",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.es5?E.varKinds.var:E.varKinds.let,i=this._scope.toName(e);return this._for(new H(o,i,t,n),(function(){return r(i)}))}},{key:"forOf",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:E.varKinds.const,i=this._scope.toName(e);if(this.opts.es5){var a=t instanceof x.Name?t:this.var("_arr",t);return this.forRange("_i",0,x._(c(),a),(function(e){r.var(i,x._(s(),a,e)),n(i)}))}return this._for(new G("of",o,i,t),(function(){return n(i)}))}},{key:"forIn",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.es5?E.varKinds.var:E.varKinds.const;if(this.opts.ownProperties)return this.forOf(e,x._(u(),t),n);var o=this._scope.toName(e);return this._for(new G("in",r,o,t),(function(){return n(o)}))}},{key:"endFor",value:function(){return this._endBlockNode(F)}},{key:"label",value:function(e){return this._leafNode(new M(e))}},{key:"break",value:function(e){return this._leafNode(new N(e))}},{key:"return",value:function(e){var t=new X;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(X)}},{key:"try",value:function(e,t,n){if(!t&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');var r=new W;if(this._blockNode(r),this.code(e),t){var o=this.name("e");this._currNode=r.catch=new Y(o),t(o)}return n&&(this._currNode=r.finally=new J,this.code(n)),this._endBlockNode(Y,J)}},{key:"throw",value:function(e){return this._leafNode(new I(e))}},{key:"block",value:function(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}},{key:"endBlock",value:function(e){var t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");var n=this._nodes.length-t;if(n<0||void 0!==e&&n!==e)throw new Error("CodeGen: wrong number of nodes: ".concat(n," vs ").concat(e," expected"));return this._nodes.length=t,this}},{key:"func",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.nil,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return this._blockNode(new K(e,t,n)),r&&this.code(r).endFunc(),this}},{key:"endFunc",value:function(){return this._endBlockNode(K)}},{key:"optimize",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}},{key:"_leafNode",value:function(e){return this._currNode.nodes.push(e),this}},{key:"_blockNode",value:function(e){this._currNode.nodes.push(e),this._nodes.push(e)}},{key:"_endBlockNode",value:function(e,t){var n=this._currNode;if(n instanceof e||t&&n instanceof t)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(t?"".concat(e.kind,"/").concat(t.kind):e.kind,'"'))}},{key:"_elseNode",value:function(e){var t=this._currNode;if(!(t instanceof U))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}},{key:"_root",get:function(){return this._nodes[0]}},{key:"_currNode",get:function(){var e=this._nodes;return e[e.length-1]},set:function(e){var t=this._nodes;t[t.length-1]=e}}]),e}();function Z(e,t){for(var n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function ee(e,t){return t instanceof x._CodeOrName?Z(e,t.names):e}function te(e,t,n){return e instanceof x.Name?o(e):(r=e)instanceof x._Code&&r._items.some((function(e){return e instanceof x.Name&&1===t[e.str]&&void 0!==n[e.str]}))?new x._Code(e._items.reduce((function(e,t){return t instanceof x.Name&&(t=o(t)),t instanceof x._Code?e.push.apply(e,p(t._items)):e.push(t),e}),[])):e;var r;function o(e){var r=n[e.str];return void 0===r||1!==t[e.str]?e:(delete t[e.str],r)}}function ne(e,t){for(var n in t)e[n]=(e[n]||0)-(t[n]||0)}function re(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:x._(a(),ue(e))}t.CodeGen=Q,t.not=re;var oe=ae(t.operators.AND);t.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(oe)};var ie=ae(t.operators.OR);function ae(e){return function(t,n){return t===x.nil?n:n===x.nil?t:x._(i(),ue(t),e,ue(n))}}function ue(e){return e instanceof x.Name?e:x._(o(),e)}t.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(ie)}},function(e,t,n){var r,o;
/** @preserve SAT.js - Version 0.8.0 - Copyright 2012 - 2018 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
!function(i,a){"use strict";void 0===(o="function"==typeof(r=function(){var e={};function t(e,t){this.x=e||0,this.y=t||0}function n(e,n){this.pos=e||new t,this.r=n||0,this.offset=new t}function r(e,n){this.pos=e||new t,this.angle=0,this.offset=new t,this.setPoints(n||[])}function o(e,n,r){this.pos=e||new t,this.w=n||0,this.h=r||0}function i(){this.a=null,this.b=null,this.overlapN=new t,this.overlapV=new t,this.clear()}e.Vector=t,e.V=t,t.prototype.copy=t.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},t.prototype.clone=t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.perp=t.prototype.perp=function(){var e=this.x;return this.x=this.y,this.y=-e,this},t.prototype.rotate=t.prototype.rotate=function(e){var t=this.x,n=this.y;return this.x=t*Math.cos(e)-n*Math.sin(e),this.y=t*Math.sin(e)+n*Math.cos(e),this},t.prototype.reverse=t.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=t.prototype.normalize=function(){var e=this.len();return e>0&&(this.x=this.x/e,this.y=this.y/e),this},t.prototype.add=t.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},t.prototype.sub=t.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},t.prototype.scale=t.prototype.scale=function(e,t){return this.x*=e,this.y*=void 0!==t?t:e,this},t.prototype.project=t.prototype.project=function(e){var t=this.dot(e)/e.len2();return this.x=t*e.x,this.y=t*e.y,this},t.prototype.projectN=t.prototype.projectN=function(e){var t=this.dot(e);return this.x=t*e.x,this.y=t*e.y,this},t.prototype.reflect=t.prototype.reflect=function(e){var t=this.x,n=this.y;return this.project(e).scale(2),this.x-=t,this.y-=n,this},t.prototype.reflectN=t.prototype.reflectN=function(e){var t=this.x,n=this.y;return this.projectN(e).scale(2),this.x-=t,this.y-=n,this},t.prototype.dot=t.prototype.dot=function(e){return this.x*e.x+this.y*e.y},t.prototype.len2=t.prototype.len2=function(){return this.dot(this)},t.prototype.len=t.prototype.len=function(){return Math.sqrt(this.len2())},e.Circle=n,n.prototype.getAABB=n.prototype.getAABB=function(){var e=this.r;return new o(this.pos.clone().add(this.offset).sub(new t(e,e)),2*e,2*e).toPolygon()},n.prototype.setOffset=n.prototype.setOffset=function(e){return this.offset=e,this},e.Polygon=r,r.prototype.setPoints=r.prototype.setPoints=function(e){if(!this.points||this.points.length!==e.length){var n,r=this.calcPoints=[],o=this.edges=[],i=this.normals=[];for(n=0;n<e.length;n++){var a=e[n],u=n<e.length-1?e[n+1]:e[0];a===u||a.x!==u.x||a.y!==u.y?(r.push(new t),o.push(new t),i.push(new t)):(e.splice(n,1),n-=1)}}return this.points=e,this._recalc(),this},r.prototype.setAngle=r.prototype.setAngle=function(e){return this.angle=e,this._recalc(),this},r.prototype.setOffset=r.prototype.setOffset=function(e){return this.offset=e,this._recalc(),this},r.prototype.rotate=r.prototype.rotate=function(e){for(var t=this.points,n=t.length,r=0;r<n;r++)t[r].rotate(e);return this._recalc(),this},r.prototype.translate=r.prototype.translate=function(e,t){for(var n=this.points,r=n.length,o=0;o<r;o++)n[o].x+=e,n[o].y+=t;return this._recalc(),this},r.prototype._recalc=function(){var e,t=this.calcPoints,n=this.edges,r=this.normals,o=this.points,i=this.offset,a=this.angle,u=o.length;for(e=0;e<u;e++){var s=t[e].copy(o[e]);s.x+=i.x,s.y+=i.y,0!==a&&s.rotate(a)}for(e=0;e<u;e++){var c=t[e],l=e<u-1?t[e+1]:t[0],f=n[e].copy(l).sub(c);r[e].copy(f).perp().normalize()}return this},r.prototype.getAABB=r.prototype.getAABB=function(){for(var e=this.calcPoints,n=e.length,r=e[0].x,i=e[0].y,a=e[0].x,u=e[0].y,s=1;s<n;s++){var c=e[s];c.x<r?r=c.x:c.x>a&&(a=c.x),c.y<i?i=c.y:c.y>u&&(u=c.y)}return new o(this.pos.clone().add(new t(r,i)),a-r,u-i).toPolygon()},r.prototype.getCentroid=r.prototype.getCentroid=function(){for(var e=this.calcPoints,n=e.length,r=0,o=0,i=0,a=0;a<n;a++){var u=e[a],s=a===n-1?e[0]:e[a+1],c=u.x*s.y-s.x*u.y;r+=(u.x+s.x)*c,o+=(u.y+s.y)*c,i+=c}return new t(r/=i*=3,o/=i)},e.Box=o,o.prototype.toPolygon=o.prototype.toPolygon=function(){var e=this.pos,n=this.w,o=this.h;return new r(new t(e.x,e.y),[new t,new t(n,0),new t(n,o),new t(0,o)])},e.Response=i,i.prototype.clear=i.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var a=[],u=0;u<10;u++)a.push(new t);var s=[];for(u=0;u<5;u++)s.push([]);var c=new i,l=new o(new t,1e-6,1e-6).toPolygon();function f(e,t,n){for(var r=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=e.length,a=0;a<i;a++){var u=e[a].dot(t);u<r&&(r=u),u>o&&(o=u)}n[0]=r,n[1]=o}function h(e,t,n,r,o,i){var u=s.pop(),c=s.pop(),l=a.pop().copy(t).sub(e),h=l.dot(o);if(f(n,o,u),f(r,o,c),c[0]+=h,c[1]+=h,u[0]>c[1]||c[0]>u[1])return a.push(l),s.push(u),s.push(c),!0;if(i){var p,d,y=0;if(u[0]<c[0])if(i.aInB=!1,u[1]<c[1])y=u[1]-c[0],i.bInA=!1;else y=(p=u[1]-c[0])<(d=c[1]-u[0])?p:-d;else if(i.bInA=!1,u[1]>c[1])y=u[0]-c[1],i.aInB=!1;else y=(p=u[1]-c[0])<(d=c[1]-u[0])?p:-d;var m=Math.abs(y);m<i.overlap&&(i.overlap=m,i.overlapN.copy(o),y<0&&i.overlapN.reverse())}return a.push(l),s.push(u),s.push(c),!1}function p(e,t){var n=e.len2(),r=t.dot(e);return r<0?d:r>n?m:y}e.isSeparatingAxis=h;var d=-1,y=0,m=1;function v(e,t,n){for(var r=a.pop().copy(t.pos).add(t.offset).sub(e.pos),o=t.r,i=o*o,u=e.calcPoints,s=u.length,c=a.pop(),l=a.pop(),f=0;f<s;f++){var h=f===s-1?0:f+1,y=0===f?s-1:f-1,v=0,b=null;c.copy(e.edges[f]),l.copy(r).sub(u[f]),n&&l.len2()>i&&(n.aInB=!1);var _=p(c,l);if(_===d){c.copy(e.edges[y]);var g=a.pop().copy(r).sub(u[y]);if((_=p(c,g))===m){if((k=l.len())>o)return a.push(r),a.push(c),a.push(l),a.push(g),!1;n&&(n.bInA=!1,b=l.normalize(),v=o-k)}a.push(g)}else if(_===m){if(c.copy(e.edges[h]),l.copy(r).sub(u[h]),(_=p(c,l))===d){if((k=l.len())>o)return a.push(r),a.push(c),a.push(l),!1;n&&(n.bInA=!1,b=l.normalize(),v=o-k)}}else{var w=c.perp().normalize(),k=l.dot(w),S=Math.abs(k);if(k>0&&S>o)return a.push(r),a.push(w),a.push(l),!1;n&&(b=w,v=o-k,(k>=0||v<2*o)&&(n.bInA=!1))}b&&n&&Math.abs(v)<Math.abs(n.overlap)&&(n.overlap=v,n.overlapN.copy(b))}return n&&(n.a=e,n.b=t,n.overlapV.copy(n.overlapN).scale(n.overlap)),a.push(r),a.push(c),a.push(l),!0}function b(e,t,n){for(var r=e.calcPoints,o=r.length,i=t.calcPoints,a=i.length,u=0;u<o;u++)if(h(e.pos,t.pos,r,i,e.normals[u],n))return!1;for(u=0;u<a;u++)if(h(e.pos,t.pos,r,i,t.normals[u],n))return!1;return n&&(n.a=e,n.b=t,n.overlapV.copy(n.overlapN).scale(n.overlap)),!0}return e.pointInCircle=function(e,t){var n=a.pop().copy(e).sub(t.pos).sub(t.offset),r=t.r*t.r,o=n.len2();return a.push(n),o<=r},e.pointInPolygon=function(e,t){l.pos.copy(e),c.clear();var n=b(l,t,c);n&&(n=c.aInB);return n},e.testCircleCircle=function(e,t,n){var r=a.pop().copy(t.pos).add(t.offset).sub(e.pos).sub(e.offset),o=e.r+t.r,i=o*o,u=r.len2();if(u>i)return a.push(r),!1;if(n){var s=Math.sqrt(u);n.a=e,n.b=t,n.overlap=o-s,n.overlapN.copy(r.normalize()),n.overlapV.copy(r).scale(n.overlap),n.aInB=e.r<=t.r&&s<=t.r-e.r,n.bInA=t.r<=e.r&&s<=e.r-t.r}return a.push(r),!0},e.testPolygonCircle=v,e.testCirclePolygon=function(e,t,n){var r=v(t,e,n);if(r&&n){var o=n.a,i=n.aInB;n.overlapN.reverse(),n.overlapV.reverse(),n.a=n.b,n.b=o,n.aInB=n.bInA,n.bInA=i}return r},e.testPolygonPolygon=b,e})?r.call(t,n,t,e):r)||(e.exports=o)}()},function(e,t,n){"use strict";function r(){var e=_(["","",""]);return r=function(){return e},e}function o(){var e=_(["{}"]);return o=function(){return e},e}function i(){var e=_([""," > "," ? "," : ",""]);return i=function(){return e},e}function a(){var e=_([""," !== true"]);return a=function(){return e},e}function u(){var e=_([""," === true ? true : "," > "," ? "," : ",""]);return u=function(){return e},e}function s(){var e=_([""," !== true && "," !== undefined"]);return s=function(){return e},e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){var e=_([""," || {}"]);return h=function(){return e},e}function p(){var e=_([""," !== true"]);return p=function(){return e},e}function d(){var e=_(["Object.assign(",", ",")"]);return d=function(){return e},e}function y(){var e=_([""," === true"]);return y=function(){return e},e}function m(){var e=_([""," !== true && "," !== undefined"]);return m=function(){return e},e}function v(){var e=_(["","","",""]);return v=function(){return e},e}function b(){var e=_(["",""]);return b=function(){return e},e}function _(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;var k=n(1),S=n(5);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,n=e.opts,r=e.self;if(n.strict&&"boolean"!=typeof t){var o=r.RULES.keywords;for(var i in t)o[i]||S.checkStrictMode(e,'unknown keyword: "'.concat(i,'"'))}}function P(e,t){if("boolean"==typeof e)return!e;for(var n in e)if(t[n])return!0;return!1}function j(e){return"number"==typeof e?"".concat(e):e.replace(/~/g,"~0").replace(/\//g,"~1")}function x(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function E(e){var t=e.mergeNames,n=e.mergeToName,r=e.mergeValues,o=e.resultToName;return function(e,i,a,u){var s=void 0===a?i:a instanceof k.Name?(i instanceof k.Name?t(e,i,a):n(e,i,a),a):i instanceof k.Name?(n(e,a,i),i):r(i,a);return u!==k.Name||s instanceof k.Name?s:o(e,s)}}function C(e,t){if(!0===t)return e.var("props",!0);var n=e.var("props",k._(o()));return void 0!==t&&T(e,n,t),n}function T(e,t,n){Object.keys(n).forEach((function(n){return e.assign(k._(r(),t,k.getProperty(n)),!0)}))}t.toHash=function(e){var t,n={},r=g(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(e){r.e(e)}finally{r.f()}return n},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(O(e,t),!P(t,e.self.RULES.all))},t.checkUnknownRules=O,t.schemaHasRules=P,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(var n in e)if("$ref"!==n&&t.all[n])return!0;return!1},t.schemaRefOrVal=function(e,t,n,r){var o=e.topSchemaRef,i=e.schemaPath;if(!r){if("number"==typeof t||"boolean"==typeof t)return t;if("string"==typeof t)return k._(b(),t)}return k._(v(),o,i,k.getProperty(n))},t.unescapeFragment=function(e){return x(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(j(e))},t.escapeJsonPointer=j,t.unescapeJsonPointer=x,t.eachItem=function(e,t){if(Array.isArray(e)){var n,r=g(e);try{for(r.s();!(n=r.n()).done;){t(n.value)}}catch(e){r.e(e)}finally{r.f()}}else t(e)},t.mergeEvaluated={props:E({mergeNames:function(e,t,n){return e.if(k._(m(),n,t),(function(){e.if(k._(y(),t),(function(){return e.assign(n,!0)}),(function(){return e.code(k._(d(),n,t))}))}))},mergeToName:function(e,t,n){return e.if(k._(p(),n),(function(){!0===t?e.assign(n,!0):(e.assign(n,k._(h(),n)),T(e,n,t))}))},mergeValues:function(e,t){return!0===e||l(l({},e),t)},resultToName:C}),items:E({mergeNames:function(e,t,n){return e.if(k._(s(),n,t),(function(){return e.assign(n,k._(u(),t,n,t,n,t))}))},mergeToName:function(e,t,n){return e.if(k._(a(),n),(function(){return e.assign(n,!0===t||k._(i(),n,t,n,t))}))},mergeValues:function(e,t){return!0===e||Math.max(e,t)},resultToName:function(e,t){return e.var("items",t)}})},t.evaluatedPropsToName=C,t.setEvaluated=T},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";function r(){var e=I(["",".items"]);return r=function(){return e},e}function o(){var e=I(["",".props"]);return o=function(){return e},e}function i(){var e=I([""," === 0"]);return i=function(){return e},e}function a(){var e=I(["",".errors"]);return a=function(){return e},e}function u(){var e=I(["new ","(",")"]);return u=function(){return e},e}function s(){var e=I([""," === 0"]);return s=function(){return e},e}function c(){var e=I(["",".opts.$comment(",", ",", ",".schema)"]);return c=function(){return e},e}function l(){var e=I(["","/$comment"]);return l=function(){return e},e}function f(){var e=I(["",".logger.log(",")"]);return f=function(){return e},e}function h(){var e=I([""," === ",""]);return h=function(){return e},e}function p(){var e=I(["/*# sourceURL="," */"]);return p=function(){return e},e}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(){var e=I(["undefined"]);return y=function(){return e},e}function m(){var e=I(["",".items"]);return m=function(){return e},e}function v(){var e=I(["",".dynamicItems"]);return v=function(){return e},e}function b(){var e=I(["undefined"]);return b=function(){return e},e}function _(){var e=I(["",".props"]);return _=function(){return e},e}function g(){var e=I(["",".dynamicProps"]);return g=function(){return e},e}function w(){var e=I(["",".evaluated"]);return w=function(){return e},e}function k(){var e=I(["{}"]);return k=function(){return e},e}function S(){var e=I(["undefined"]);return S=function(){return e},e}function O(){var e=I(["undefined"]);return O=function(){return e},e}function P(){var e=I(['""']);return P=function(){return e},e}function j(){var e=I(["",".",""]);return j=function(){return e},e}function x(){var e=I(["",".",""]);return x=function(){return e},e}function E(){var e=I(["",".",""]);return E=function(){return e},e}function C(){var e=I(["",".",""]);return C=function(){return e},e}function T(){var e=I(["",".",""]);return T=function(){return e},e}function R(){var e=I([", ","={}"]);return R=function(){return e},e}function A(){var e=I(["{",'="", ',", ",", ","=","","}={}"]);return A=function(){return e},e}function D(){var e=I(["",", ",""]);return D=function(){return e},e}function M(){var e=I(['"use strict"; ',""]);return M=function(){return e},e}function N(){var e=I(["",", ",""]);return N=function(){return e},e}function I(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.schemaCxtHasRules=t.subschemaCode=t.validateFunctionCode=void 0;var L=n(37),$=n(11),V=n(38),z=n(1),B=n(6),U=n(15),F=n(3);function q(e,t){var n=e.gen,r=e.validateName,o=e.schema,i=e.schemaEnv,a=e.opts;a.code.es5?n.func(r,z._(N(),B.default.data,B.default.valCxt),i.$async,(function(){n.code(z._(M(),H(o,a))),function(e,t){e.if(B.default.valCxt,(function(){e.var(B.default.dataPath,z._(T(),B.default.valCxt,B.default.dataPath)),e.var(B.default.parentData,z._(C(),B.default.valCxt,B.default.parentData)),e.var(B.default.parentDataProperty,z._(E(),B.default.valCxt,B.default.parentDataProperty)),e.var(B.default.rootData,z._(x(),B.default.valCxt,B.default.rootData)),t.dynamicRef&&e.var(B.default.dynamicAnchors,z._(j(),B.default.valCxt,B.default.dynamicAnchors))}),(function(){e.var(B.default.dataPath,z._(P())),e.var(B.default.parentData,z._(O())),e.var(B.default.parentDataProperty,z._(S())),e.var(B.default.rootData,B.default.data),t.dynamicRef&&e.var(B.default.dynamicAnchors,z._(k()))}))}(n,a),n.code(t)})):n.func(r,z._(D(),B.default.data,function(e){return z._(A(),B.default.dataPath,B.default.parentData,B.default.parentDataProperty,B.default.rootData,B.default.data,e.dynamicRef?z._(R(),B.default.dynamicAnchors):z.nil)}(a)),i.$async,(function(){return n.code(H(o,a)).code(t)}))}function H(e,t){return"object"==d(e)&&e.$id&&(t.code.source||t.code.process)?z._(p(),e.$id):z.nil}function G(e){var t=e.schema,n=e.self;if("boolean"==typeof t)return!t;for(var r in t)if(n.RULES.all[r])return!0;return!1}function K(e){return"boolean"!=typeof e.schema}function X(e){F.checkUnknownRules(e),function(e){var t=e.schema,n=e.errSchemaPath,r=e.opts,o=e.self;t.$ref&&r.ignoreKeywordsWithRef&&F.schemaHasRulesButRef(t,o.RULES)&&o.logger.warn('$ref: keywords ignored in schema at path "'.concat(n,'"'))}(e)}function W(e,t){var n=$.getSchemaTypes(e.schema),r=$.coerceAndCheckDataType(e,n);V.schemaKeywords(e,n,!r,t)}function Y(e){var t=e.gen,n=e.schemaEnv,r=e.schema,o=e.errSchemaPath,i=e.opts,a=r.$comment;if(!0===i.$comment)t.code(z._(f(),B.default.self,a));else if("function"==typeof i.$comment){var u=z.str(l(),o),s=t.scopeValue("root",{ref:n.root});t.code(z._(c(),B.default.self,a,u,s))}}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.opts.strict;if(n){if(t="strict mode: ".concat(t),!0===n)throw new Error(t);e.self.logger.warn(t)}}t.validateFunctionCode=function(e){K(e)&&(X(e),G(e))?function(e){var t=e.schema,n=e.opts,c=e.gen;q(e,(function(){n.$comment&&t.$comment&&Y(e),function(e){var t=e.schema,n=e.opts;void 0!==t.default&&n.useDefaults&&n.strict&&J(e,"default is ignored in the schema root")}(e),c.let(B.default.vErrors,null),c.let(B.default.errors,0),n.unevaluated&&function(e){var t=e.gen,n=e.validateName;e.evaluated=t.const("evaluated",z._(w(),n)),t.if(z._(g(),e.evaluated),(function(){return t.assign(z._(_(),e.evaluated),z._(b()))})),t.if(z._(v(),e.evaluated),(function(){return t.assign(z._(m(),e.evaluated),z._(y()))}))}(e),W(e),function(e){var t=e.gen,n=e.schemaEnv,c=e.validateName,l=e.ValidationError,f=e.opts;n.$async?t.if(z._(s(),B.default.errors),(function(){return t.return(B.default.data)}),(function(){return t.throw(z._(u(),l,B.default.vErrors))})):(t.assign(z._(a(),c),B.default.vErrors),f.unevaluated&&function(e){var t=e.gen,n=e.evaluated,i=e.props,a=e.items;i instanceof z.Name&&t.assign(z._(o(),n),i);a instanceof z.Name&&t.assign(z._(r(),n),a)}(e),t.return(z._(i(),B.default.errors)))}(e)}))}(e):q(e,(function(){return L.topBoolOrEmptySchema(e)}))},t.subschemaCode=function(e,t){K(e)&&(X(e),G(e))?function(e,t){var n=e.schema,r=e.gen;e.opts.$comment&&n.$comment&&Y(e);(function(e){e.schema.$id&&(e.baseId=U.resolveUrl(e.baseId,e.schema.$id))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);var o=r.const("_errs",B.default.errors);W(e,o),r.var(t,z._(h(),o,B.default.errors))}(e,t):L.boolOrEmptySchema(e,t)},t.schemaCxtHasRules=G,t.checkStrictMode=J},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o={data:new r.Name("data"),valCxt:new r.Name("valCxt"),dataPath:new r.Name("dataPath"),parentData:new r.Name("parentData"),parentDataProperty:new r.Name("parentDataProperty"),rootData:new r.Name("rootData"),dynamicAnchors:new r.Name("dynamicAnchors"),vErrors:new r.Name("vErrors"),errors:new r.Name("errors"),this:new r.Name("this"),self:new r.Name("self"),scope:new r.Name("scope")};t.default=o},function(e,t,n){"use strict";function r(){var e=v(["new RegExp(",', "u")']);return r=function(){return e},e}function o(){var e=v(["","(",")"]);return o=function(){return e},e}function i(){var e=v(["",".call(",", ",")"]);return i=function(){return e},e}function a(){var e=v(["",", ",""]);return a=function(){return e},e}function u(){var e=v(["",", ",", ","",""]);return u=function(){return e},e}function s(){var e=v([""," || !",""]);return s=function(){return e},e}function c(){var e=v(["",""," === undefined"]);return c=function(){return e},e}function l(){var e=v([""," && ",""]);return l=function(){return e},e}function f(){var e=v(["",""," !== undefined"]);return f=function(){return e},e}function h(){var e=v(["Object.prototype.hasOwnProperty.call(",", ",")"]);return h=function(){return e},e}function p(){var e=v([""," && ("," = ",")"]);return p=function(){return e},e}function d(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(){var e=v(["",""]);return m=function(){return e},e}function v(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;var b=n(1),_=n(3),g=n(6);function w(e,t){return b._(h(),e,t)}function k(e,t,n){var r=b._(c(),e,b.getProperty(t));return n?b._(s(),r,w(e,t)):r}function S(e){return e?Object.keys(e).filter((function(e){return"__proto__"!==e})):[]}t.checkReportMissingProp=function(e,t){var n=e.gen,r=e.data,o=e.it;n.if(k(r,t,o.opts.ownProperties),(function(){e.setParams({missingProperty:b._(m(),t)},!0),e.error()}))},t.checkMissingProp=function(e,t,n){var r=e.data,o=e.it.opts;return b.or.apply(b,d(t.map((function(e){return b._(p(),k(r,e,o.ownProperties),n,e)}))))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.propertyInData=function(e,t,n){var r=b._(f(),e,b.getProperty(t));return n?b._(l(),r,w(e,t)):r},t.noPropertyInData=k,t.allSchemaProperties=S,t.schemaProperties=function(e,t){return S(t).filter((function(n){return!_.alwaysValidSchema(e,t[n])}))},t.callValidateCode=function(e,t,n,r){var s=e.schemaCode,c=e.data,l=e.it,f=l.gen,h=l.topSchemaRef,p=l.schemaPath,d=l.errorPath,y=e.it,m=r?b._(u(),s,c,h,p):c,v=[[g.default.dataPath,b.strConcat(g.default.dataPath,d)],[g.default.parentData,y.parentData],[g.default.parentDataProperty,y.parentDataProperty],[g.default.rootData,g.default.rootData]];y.opts.dynamicRef&&v.push([g.default.dynamicAnchors,g.default.dynamicAnchors]);var _=b._(a(),m,f.object.apply(f,v));return n!==b.nil?b._(i(),t,n,_):b._(o(),t,_)},t.usePattern=function(e,t){return e.scopeValue("pattern",{key:t,ref:new RegExp(t,"u"),code:b._(r(),t)})}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(28),o=n(29),i=n(30),a=n(31),u=n(32),s=n(33),c=n(34);c.alea=r,c.xor128=o,c.xorwow=i,c.xorshift7=a,c.xor4096=u,c.tychei=s,e.exports=c},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";function r(){var e=V(["{type: ","}"]);return r=function(){return e},e}function o(){var e=V(["{type: ","}"]);return o=function(){return e},e}function i(){var e=V(["should be ",""]);return i=function(){return e},e}function a(){var e=V(["!"," || ",""]);return a=function(){return e},e}function u(){var e=V(["typeof ",' != "object"']);return u=function(){return e},e}function s(){var e=V(["isFinite(",")"]);return s=function(){return e},e}function c(){var e=V(["typeof ",' == "number"']);return c=function(){return e},e}function l(){var e=V(["typeof "," "," ",""]);return l=function(){return e},e}function f(){var e=V(["!("," % 1) && !isNaN(",")"]);return f=function(){return e},e}function h(){var e=V([""," && typeof ",' == "object" && !Array.isArray(',")"]);return h=function(){return e},e}function p(){var e=V(["Array.isArray(",")"]);return p=function(){return e},e}function d(){var e=V([""," "," null"]);return d=function(){return e},e}function y(){var e=V(["","[","]"]);return y=function(){return e},e}function m(){var e=V([""," !== undefined"]);return m=function(){return e},e}function v(){var e=V(["[","]"]);return v=function(){return e},e}function b(){var e=V(["",' === "string" || ',' === "number"\n              || ',' === "boolean" || '," === null"]);return b=function(){return e},e}function _(){var e=V(["",' === "" || '," === 0 || "," === false"]);return _=function(){return e},e}function g(){var e=V(["",' === "true" || '," === 1"]);return g=function(){return e},e}function w(){var e=V(["",' === "false" || '," === 0 || "," === null"]);return w=function(){return e},e}function k(){var e=V(["+",""]);return k=function(){return e},e}function S(){var e=V(["",' === "boolean" || '," === null\n              || (",' === "string" && '," && "," == +"," && !("," % 1))"]);return S=function(){return e},e}function O(){var e=V(["+",""]);return O=function(){return e},e}function P(){var e=V(["",' == "boolean" || '," === null\n              || (",' == "string" && '," && "," == +",")"]);return P=function(){return e},e}function j(){var e=V(['""']);return j=function(){return e},e}function x(){var e=V([""," === null"]);return x=function(){return e},e}function E(){var e=V(['"" + ',""]);return E=function(){return e},e}function C(){var e=V(["",' == "number" || ',' == "boolean"']);return C=function(){return e},e}function T(){var e=V([""," !== undefined"]);return T=function(){return e},e}function R(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(){var e=V([""," !== undefined"]);return D=function(){return e},e}function M(){var e=V(["typeof ",""]);return M=function(){return e},e}function N(){var e=V(["","[0]"]);return N=function(){return e},e}function I(){var e=V([""," == 'object' && Array.isArray(",") && ",".length == 1"]);return I=function(){return e},e}function L(){var e=V(["undefined"]);return L=function(){return e},e}function $(){var e=V(["typeof ",""]);return $=function(){return e},e}function V(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;var z,B=n(19),U=n(20),F=n(14),q=n(1),H=n(3);function G(e){var t=Array.isArray(e)?e:e?[e]:[];if(t.every(B.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(z=t.DataType||(t.DataType={})),t.getSchemaTypes=function(e){var t=G(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=G,t.coerceAndCheckDataType=function(e,t){var n=e.gen,r=e.data,o=e.opts,i=function(e,t){return t?e.filter((function(e){return K.has(e)||"array"===t&&"array"===e})):[]}(t,o.coerceTypes),a=t.length>0&&!(0===i.length&&1===t.length&&U.schemaHasRulesForType(e,t[0]));if(a){var u=W(t,r,o.strict,z.Wrong);n.if(u,(function(){i.length?function(e,t,n){var r=e.gen,o=e.data,i=e.opts,a=r.let("dataType",q._($(),o)),u=r.let("coerced",q._(L()));"array"===i.coerceTypes&&r.if(q._(I(),a,o,o),(function(){return r.assign(o,q._(N(),o)).assign(a,q._(M(),o)).if(W(t,o,i.strict),(function(){return r.assign(u,o)}))}));r.if(q._(D(),u));var s,c=R(n);try{for(c.s();!(s=c.n()).done;){var l=s.value;(K.has(l)||"array"===l&&"array"===i.coerceTypes)&&f(l)}}catch(e){c.e(e)}finally{c.f()}function f(e){switch(e){case"string":return void r.elseIf(q._(C(),a,a)).assign(u,q._(E(),o)).elseIf(q._(x(),o)).assign(u,q._(j()));case"number":return void r.elseIf(q._(P(),a,o,a,o,o,o)).assign(u,q._(O(),o));case"integer":return void r.elseIf(q._(S(),a,o,a,o,o,o,o)).assign(u,q._(k(),o));case"boolean":return void r.elseIf(q._(w(),o,o,o)).assign(u,!1).elseIf(q._(g(),o,o)).assign(u,!0);case"null":return r.elseIf(q._(_(),o,o,o)),void r.assign(u,null);case"array":r.elseIf(q._(b(),a,a,a,o)).assign(u,q._(v(),o))}}r.else(),J(e),r.endIf(),r.if(q._(T(),u),(function(){r.assign(o,u),function(e,t){var n=e.gen,r=e.parentData,o=e.parentDataProperty;n.if(q._(m(),r),(function(){return n.assign(q._(y(),r,o),t)}))}(e,u)}))}(e,t,i):J(e)}))}return a};var K=new Set(["string","number","integer","boolean","null"]);function X(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:z.Correct,i=o===z.Correct?q.operators.EQ:q.operators.NEQ;switch(e){case"null":return q._(d(),t,i);case"array":r=q._(p(),t);break;case"object":r=q._(h(),t,t,t);break;case"integer":r=a(q._(f(),t,t));break;case"number":r=a();break;default:return q._(l(),t,i,e)}return o===z.Correct?r:q.not(r);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q.nil;return q.and(q._(c(),t),e,n?q._(s(),t):q.nil)}}function W(e,t,n,r){if(1===e.length)return X(e[0],t,n,r);var o,i=H.toHash(e);if(i.array&&i.object){var s=q._(u(),t);o=i.null?s:q._(a(),t,s),delete i.null,delete i.array,delete i.object}else o=q.nil;for(var c in i.number&&delete i.integer,i)o=q.and(o,X(c,t,n,r));return o}t.checkDataType=X,t.checkDataTypes=W;var Y={message:function(e){var t=e.schema;return q.str(i(),t)},params:function(e){var t=e.schema,n=e.schemaValue;return"string"==typeof t?q._(o(),t):q._(r(),n)}};function J(e){var t=function(e){var t=e.gen,n=e.data,r=e.schema,o=H.schemaRefOrVal(e,r,"type");return{gen:t,keyword:"type",data:n,schema:r.type,schemaCode:o,schemaValue:o,parentSchema:r,params:{},it:e}}(e);F.reportError(t,Y)}t.reportTypeError=J},function(e,t,n){"use strict";function r(){var e=d(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")']);return r=function(){return e},e}function o(){var e=d(['"/" + ',""]);return o=function(){return e},e}function i(){var e=d(['"[\'" + ',' + "\']"']);return i=function(){return e},e}function a(){var e=d(['"[" + ',' + "]"']);return a=function(){return e},e}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){var e=d(["",""]);return c=function(){return e},e}function l(){var e=d(["","",""]);return l=function(){return e},e}function f(){var e=d(["","",""]);return f=function(){return e},e}function h(){var e=d(["","","",""]);return h=function(){return e},e}function p(){var e=d(["","",""]);return p=function(){return e},e}function d(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.applySubschema=t.Type=void 0;var b,_=n(5),g=n(3),w=n(1);!function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(b=t.Type||(t.Type={})),t.applySubschema=function(e,t,n){var s=function(e,t){var n=t.keyword,r=t.schemaProp,o=t.schema,i=t.strictSchema,a=t.schemaPath,u=t.errSchemaPath,s=t.topSchemaRef;if(void 0!==n&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==n){var c=e.schema[n];return void 0===r?{schema:c,schemaPath:w._(p(),e.schemaPath,w.getProperty(n)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n)}:{schema:c[r],schemaPath:w._(h(),e.schemaPath,w.getProperty(n),w.getProperty(r)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n,"/").concat(g.escapeFragment(r))}}if(void 0!==o){if(void 0===a||void 0===u||void 0===s)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,strictSchema:i,schemaPath:a,topSchemaRef:s,errSchemaPath:u}}throw new Error('either "keyword" or "schema" must be passed')}(e,t);!function(e,t,n){var s=n.dataProp,h=n.dataPropType,p=n.data,d=n.dataTypes,y=n.propertyName;if(void 0!==p&&void 0!==s)throw new Error('both "data" and "dataProp" passed, only one allowed');var m=t.gen;if(void 0!==s){var v=t.errorPath,_=t.dataPathArr,k=t.opts;S(m.let("data",w._(f(),t.data,w.getProperty(s)),!0)),e.errorPath=w.str(l(),v,function(e,t,n){if(e instanceof w.Name){var u=t===b.Num;return n?u?w._(a(),e):w._(i(),e):u?w._(o(),e):w._(r(),e)}return n?w.getProperty(e).toString():"/"+g.escapeJsonPointer(e)}(s,h,k.jsPropertySyntax)),e.parentDataProperty=w._(c(),s),e.dataPathArr=[].concat(u(_),[e.parentDataProperty])}if(void 0!==p){S(p instanceof w.Name?p:m.let("data",p,!0)),void 0!==y&&(e.propertyName=y)}d&&(e.dataTypes=d);function S(n){e.data=n,e.dataLevel=t.dataLevel+1,e.dataTypes=[],e.parentData=t.data,e.dataNames=[].concat(u(t.dataNames),[n])}}(s,e,t),function(e,t){var n=t.compositeRule,r=t.createErrors,o=t.allErrors,i=t.strictSchema;void 0!==n&&(e.compositeRule=n);void 0!==r&&(e.createErrors=r);void 0!==o&&(e.allErrors=o);e.strictSchema=i}(s,t);var d=m(m(m({},e),s),{},{items:void 0,props:void 0});return _.subschemaCode(d,n),d}},function(e,t,n){"use strict";function r(){var e=h([""," && ",""]);return r=function(){return e},e}function o(){var e=h(["","",""]);return o=function(){return e},e}function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){var e=h(["!","(",")"]);return s=function(){return e},e}function c(){var e=h(["",""]);return c=function(){return e},e}function l(){var e=h([""," === undefined"]);return l=function(){return e},e}function f(){var e=h([""," !== undefined && (",")"]);return f=function(){return e},e}function h(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getData=void 0;var d=n(11),y=n(3),m=n(14),v=n(1),b=n(6),_=n(12),g=function(){function e(t,n,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,n){var r=e.schema,o=e.opts,i=e.self;if(Array.isArray(t.keyword)?!t.keyword.includes(n):t.keyword!==n)throw new Error("ajv implementation error");var a=t.dependencies;if(null==a?void 0:a.some((function(e){return!Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have dependencies of ".concat(n,": ").concat(a.join(",")));if(t.validateSchema){if(!t.validateSchema(r[n])){var u="keyword value is invalid: "+i.errorsText(t.validateSchema.errors);if("log"!==o.validateSchema)throw new Error(u);i.logger.error(u)}}}(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=y.schemaRefOrVal(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",S(this.$data,t));else if(this.schemaCode=this.schemaValue,!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!t.length||t.some((function(t){return"array"===t?Array.isArray(e):"object"===t?e&&"object"==u(e)&&!Array.isArray(e):u(e)==t||n&&void 0===e}))}(this.schema,n.schemaType,n.allowUndefined))throw new Error("".concat(r," value must be ").concat(JSON.stringify(n.schemaType)));("code"in n?n.trackErrors:!1!==n.errors)&&(this.errsCount=t.gen.const("_errs",b.default.errors))}var t,n,r;return t=e,(n=[{key:"result",value:function(e,t,n){this.gen.if(v.not(e)),n?n():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}},{key:"pass",value:function(e,t){this.result(e,void 0,t)}},{key:"fail",value:function(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}},{key:"fail$data",value:function(e){if(!this.$data)return this.fail(e);var t=this.schemaCode;this.fail(v._(f(),t,v.or(this.invalid$data(),e)))}},{key:"error",value:function(e){(e?m.reportExtraError:m.reportError)(this,this.def.error||m.keywordError)}},{key:"$dataError",value:function(){m.reportError(this,this.def.$dataError||m.keyword$DataError)}},{key:"reset",value:function(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');m.resetErrorsCount(this.gen,this.errsCount)}},{key:"ok",value:function(e){this.allErrors||this.gen.if(e)}},{key:"setParams",value:function(e,t){t?Object.assign(this.params,e):this.params=e}},{key:"block$data",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.nil;this.gen.block((function(){n.check$data(e,r),t()}))}},{key:"check$data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.nil,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.nil;if(this.$data){var n=this.gen,r=this.schemaCode,o=this.schemaType,i=this.def;n.if(v.or(v._(l(),r),t)),e!==v.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==v.nil&&n.assign(e,!1)),n.else()}}},{key:"invalid$data",value:function(){var e=this.gen,t=this.schemaCode,n=this.schemaType,r=this.def,o=this.it;return v.or(function(){if(n.length){if(!(t instanceof v.Name))throw new Error("ajv implementation error");var e=Array.isArray(n)?n:[n];return v._(c(),d.checkDataTypes(e,t,o.opts.strict,d.DataType.Wrong))}return v.nil}(),function(){if(r.validateSchema){var n=e.scopeValue("validate$data",{ref:r.validateSchema});return v._(s(),n,t)}return v.nil}())}},{key:"subschema",value:function(e,t){return _.applySubschema(this.it,e,t)}},{key:"mergeEvaluated",value:function(e,t){var n=this.it,r=this.gen;n.opts.unevaluated&&(!0!==n.props&&void 0!==e.props&&(n.props=y.mergeEvaluated.props(r,e.props,n.props,t)),!0!==n.items&&void 0!==e.items&&(n.items=y.mergeEvaluated.items(r,e.items,n.items,t)))}},{key:"mergeValidEvaluated",value:function(e,t){var n=this,r=this.it,o=this.gen;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return o.if(t,(function(){return n.mergeEvaluated(e,v.Name)})),!0}}])&&p(t.prototype,n),r&&p(t,r),e}();t.default=g;var w=/^\/(?:[^~]|~0|~1)*$/,k=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function S(e,t){var n,a,u=t.dataLevel,s=t.dataNames,c=t.dataPathArr;if(""===e)return b.default.rootData;if("/"===e[0]){if(!w.test(e))throw new Error("Invalid JSON-pointer: ".concat(e));n=e,a=b.default.rootData}else{var l=k.exec(e);if(!l)throw new Error("Invalid JSON-pointer: ".concat(e));var f=+l[1];if("#"===(n=l[2])){if(f>=u)throw new Error(_("property/index",f));return c[u-f]}if(f>u)throw new Error(_("data",f));if(a=s[u-f],!n)return a}var h,p=a,d=i(n.split("/"));try{for(d.s();!(h=d.n()).done;){var m=h.value;m&&(a=v._(o(),a,v.getProperty(y.unescapeJsonPointer(m))),p=v._(r(),p,a))}}catch(e){d.e(e)}finally{d.f()}return p;function _(e,t){return"Cannot access ".concat(e," ").concat(t," levels up, current level is ").concat(u)}}t.getData=S},function(e,t,n){"use strict";function r(){var e=j(["","",""]);return r=function(){return e},e}function o(){var e=j(["{}"]);return o=function(){return e},e}function i(){var e=j(["","/",""]);return i=function(){return e},e}function a(){var e=j(["{}"]);return a=function(){return e},e}function u(){var e=j(["",".errors"]);return u=function(){return e},e}function s(){var e=j(["new ","(",")"]);return s=function(){return e},e}function c(){var e=j(["","++"]);return c=function(){return e},e}function l(){var e=j(["",".push(",")"]);return l=function(){return e},e}function f(){var e=j(["[","]"]);return f=function(){return e},e}function h(){var e=j([""," === null"]);return h=function(){return e},e}function p(){var e=j(["",".data"]);return p=function(){return e},e}function d(){var e=j(["",".schema"]);return d=function(){return e},e}function y(){var e=j(["","/",""]);return y=function(){return e},e}function m(){var e=j(["",".schemaPath"]);return m=function(){return e},e}function v(){var e=j(["",".dataPath"]);return v=function(){return e},e}function b(){var e=j(["",".dataPath === undefined"]);return b=function(){return e},e}function _(){var e=j(["","[","]"]);return _=function(){return e},e}function g(){var e=j(["",".length"]);return g=function(){return e},e}function w(){var e=j([""," !== null"]);return w=function(){return e},e}function k(){var e=j(["[","]"]);return k=function(){return e},e}function S(){var e=j(['"','" keyword is invalid ($data)']);return S=function(){return e},e}function O(){var e=j(['"','" keyword must be '," ($data)"]);return O=function(){return e},e}function P(){var e=j(['should pass "','" keyword validation']);return P=function(){return e},e}function j(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;var x=n(1),E=n(6);function C(e,t){var n=e.const("err",t);e.if(x._(h(),E.default.vErrors),(function(){return e.assign(E.default.vErrors,x._(f(),n))}),x._(l(),E.default.vErrors,n)),e.code(x._(c(),E.default.errors))}function T(e,t){var n=e.gen,r=e.validateName;e.schemaEnv.$async?n.throw(x._(s(),e.ValidationError,t)):(n.assign(x._(u(),r),t),n.return(!1))}t.keywordError={message:function(e){var t=e.keyword;return x.str(P(),t)}},t.keyword$DataError={message:function(e){var t=e.keyword,n=e.schemaType;return n?x.str(O(),t,n):x.str(S(),t)}},t.reportError=function(e,t,n){var r=e.it,o=r.gen,i=r.compositeRule,a=r.allErrors,u=A(e,t);(null!=n?n:i||a)?C(o,u):T(r,x._(k(),u))},t.reportExtraError=function(e,t){var n=e.it,r=n.gen,o=n.compositeRule,i=n.allErrors;C(r,A(e,t)),o||i||T(n,E.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(E.default.errors,t),e.if(x._(w(),E.default.vErrors),(function(){return e.if(t,(function(){return e.assign(x._(g(),E.default.vErrors),t)}),(function(){return e.assign(E.default.vErrors,null)}))}))},t.extendErrors=function(e){var t=e.gen,n=e.keyword,r=e.schemaValue,o=e.data,i=e.errsCount,a=e.it;if(void 0===i)throw new Error("ajv implementation error");var u=t.name("err");t.forRange("i",i,E.default.errors,(function(e){t.const(u,x._(_(),E.default.vErrors,e)),t.if(x._(b(),u),(function(){return t.assign(x._(v(),u),x.strConcat(E.default.dataPath,a.errorPath))})),t.assign(x._(m(),u),x.str(y(),a.errSchemaPath,n)),a.opts.verbose&&(t.assign(x._(d(),u),r),t.assign(x._(p(),u),o))}))};var R={keyword:new x.Name("keyword"),schemaPath:new x.Name("schemaPath"),params:new x.Name("params"),propertyName:new x.Name("propertyName"),message:new x.Name("message"),schema:new x.Name("schema"),parentSchema:new x.Name("parentSchema")};function A(e,t){var n=e.keyword,u=e.data,s=e.schemaValue,c=e.it,l=c.gen,f=c.createErrors,h=c.topSchemaRef,p=c.schemaPath,d=c.errorPath,y=c.errSchemaPath,m=c.propertyName,v=c.opts;if(!1===f)return x._(a());var b=t.params,_=t.message,g=[[R.keyword,n],[E.default.dataPath,x.strConcat(E.default.dataPath,d)],[R.schemaPath,x.str(i(),y,n)],[R.params,"function"==typeof b?b(e):b||x._(o())]];if(m&&g.push([R.propertyName,m]),!1!==v.messages){var w="function"==typeof _?_(e):_;g.push([R.message,w])}return v.verbose&&g.push([R.schema,s],[R.parentSchema,x._(r(),h,p)],[E.default.data,u]),l.object.apply(l,g)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;var o=n(3),i=n(16),a=n(41),u=n(22),s=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"boolean"==typeof e||(!0===t?!l(e):!!t&&f(e)<=t)};var c=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(e){for(var t in e){if(c.has(t))return!0;var n=e[t];if(Array.isArray(n)&&n.some(l))return!0;if("object"==r(n)&&l(n))return!0}return!1}function f(e){var t=0;for(var n in e){if("$ref"===n)return 1/0;if(t++,!s.has(n)&&("object"==r(e[n])&&o.eachItem(e[n],(function(e){return t+=f(e)})),t===1/0))return 1/0}return t}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;!1!==t&&(e=y(e));var n=u.parse(e);return p(n)}function p(e){return u.serialize(e).split("#")[0]+"#"}t.getFullPath=h,t._getFullPath=p;var d=/#\/?$/;function y(e){return e?e.replace(d,""):""}t.normalizeId=y,t.resolveUrl=function(e,t){return t=y(t),u.resolve(e,t)};var m=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e){var t=this;if("boolean"==typeof e)return{};var n=y(e.$id),o={"":n},s=h(n,!1),c={},l=new Set;return a(e,{allKeys:!0},(function(e,n,i,a){if(void 0!==a){var h=s+n,d=o[a];"string"==typeof e.$id&&(d=v.call(t,e.$id)),b.call(t,e.$anchor),b.call(t,e.$dynamicAnchor),o[n]=d}function v(t){if(t=y(d?u.resolve(d,t):t),l.has(t))throw p(t);l.add(t);var n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==r(n)?f(e,n.schema,t):t!==y(h)&&("#"===t[0]?(f(e,c[t],t),c[t]=e):this.refs[t]=h),t}function b(e){if("string"==typeof e){if(!m.test(e))throw new Error('invalid anchor "'.concat(e,'"'));v.call(this,"#".concat(e))}}})),c;function f(e,t,n){if(void 0!==t&&!i(e,t))throw p(n)}function p(e){return new Error('reference "'.concat(e,'" resolves to more than one schema'))}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==r(t)&&"object"==r(n)){if(t.constructor!==n.constructor)return!1;var o,i,a;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(i=o;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=o;0!=i--;){var u=a[i];if(!e(t[u],n[u]))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e=a(["[","]"]);return o=function(){return e},e}function i(){var e=a(["","",""]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;var v=function e(){m(this,e)};t._CodeOrName=v,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var b=function(e){f(r,e);var n=p(r);function r(e){var o;if(m(this,r),o=n.call(this),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");return o.str=e,o}return l(r,[{key:"toString",value:function(){return this.str}},{key:"emptyStr",value:function(){return!1}},{key:"names",get:function(){return e={},t=this.str,n=1,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var e,t,n}}]),r}(v);t.Name=b;var _=function(e){f(n,e);var t=p(n);function n(e){var r;return m(this,n),(r=t.call(this))._items="string"==typeof e?[e]:e,r}return l(n,[{key:"toString",value:function(){return this.str}},{key:"emptyStr",value:function(){if(this._items.length>1)return!1;var e=this._items[0];return""===e||'""'===e}},{key:"str",get:function(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((function(e,t){return"".concat(e).concat(t)}),"")}},{key:"names",get:function(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((function(e,t){return t instanceof b&&(e[t.str]=(e[t.str]||0)+1),e}),{})}}]),n}(v);function g(e){for(var t=[e[0]],n=0,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];for(;n<o.length;)S(t,o[n]),t.push(e[++n]);return new _(t)}t._Code=_,t.nil=new _(""),t._=g;var w=new _("+");function k(e){for(var t=[j(e[0])],n=0,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];for(;n<o.length;)t.push(w),S(t,o[n]),t.push(w,j(e[++n]));return O(t),new _(t)}function S(e,t){var n;t instanceof _?e.push.apply(e,u(t._items)):t instanceof b?e.push(t):e.push("number"==typeof(n=t)||"boolean"==typeof n||null===n?n:j(Array.isArray(n)?n.join(","):n))}function O(e){for(var t=1;t<e.length-1;){if(e[t]===w){var n=P(e[t-1],e[t+1]);if(void 0!==n){e.splice(t-1,3,n);continue}e[t++]="+"}t++}}function P(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof b||'"'!==e[e.length-1])return;return"string"!=typeof t?"".concat(e.slice(0,-1)).concat(t,'"'):'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof b?void 0:'"'.concat(e).concat(t.slice(1))}function j(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=k,t.addCodeArg=S,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:k(i(),e,t)},t.stringify=function(e){return new _(j(e))},t.safeStringify=j,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new _(".".concat(e)):g(o(),e)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function a(e){var t=l();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,h(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function c(e,t,n){return(c=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&f(o,n.prototype),o}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=void 0;var p=n(15),d=function(e){i(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,"validation failed")).errors=e,r.ajv=r.validation=!0,r}return n}(s(Error));t.ValidationError=d;var y=function(e){i(n,e);var t=a(n);function n(e,r){var i;return o(this,n),(i=t.call(this,"can't resolve reference ".concat(r," from id ").concat(e))).missingRef=p.resolveUrl(e,r),i.missingSchema=p.normalizeId(p.getFullPath(i.missingRef)),i}return n}(s(Error));t.MissingRefError=y,e.exports={ValidationError:d,MissingRefError:y}},function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;var a=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&a.has(e)},t.getRules=function(){var e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:o(o({},e),{},{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{type:!0,$comment:!0},keywords:{type:!0,$comment:!0}}}},function(e,t,n){"use strict";function r(e,t){return t.rules.some((function(t){return o(e,t)}))}function o(e,t){var n;return void 0!==e[t.keyword]||(null===(n=t.definition.implements)||void 0===n?void 0:n.some((function(t){return void 0!==e[t]})))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function(e,t){var n=e.schema,o=e.self.RULES.types[t];return o&&!0!==o&&r(n,o)},t.shouldUseGroup=r,t.shouldUseRule=o},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e=h(["","","",""]);return o=function(){return e},e}function i(){var e=h(["",""," "," = ",";",""]);return i=function(){return e},e}function a(){var e=h(["","",""]);return a=function(){return e},e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){var e=h(["\n"],["\\n"]);return l=function(){return e},e}function f(){var e=h([".","[","]"]);return f=function(){return e},e}function h(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}function v(e){var t=w();return function(){var n,r=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){var t="function"==typeof Map?new Map:void 0;return(_=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return g(e,arguments,S(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),k(r,e)})(e)}function g(e,t,n){return(g=w()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&k(o,n.prototype),o}).apply(null,arguments)}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=void 0;var O=n(17),P=function(e){m(n,e);var t=v(n);function n(e){var r;return y(this,n),(r=t.call(this,'CodeGen: "code" for '.concat(e," not defined"))).value=e.value,r}return n}(_(Error));t.varKinds={const:new O.Name("const"),let:new O.Name("let"),var:new O.Name("var")};var j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.prefixes,r=t.parent;y(this,e),this._names={},this._prefixes=n,this._parent=r}return d(e,[{key:"toName",value:function(e){return e instanceof O.Name?e:this.name(e)}},{key:"name",value:function(e){return new O.Name(this._newName(e))}},{key:"_newName",value:function(e){var t=this._names[e]||this._nameGroup(e);return"".concat(e).concat(t.index++)}},{key:"_nameGroup",value:function(e){var t,n;if((null===(n=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===n?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error('CodeGen: prefix "'.concat(e,'" is not allowed in this scope'));return this._names[e]={prefix:e,index:0}}}]),e}();t.Scope=j;var x=function(e){m(n,e);var t=v(n);function n(e,r){var o;return y(this,n),(o=t.call(this,r)).prefix=e,o}return d(n,[{key:"setValue",value:function(e,t){var n=t.property,r=t.itemIndex;this.value=e,this.scopePath=O._(f(),new O.Name(n),r)}}]),n}(O.Name);t.ValueScopeName=x;var E=O._(l()),C=function(e){m(r,e);var n=v(r);function r(e){var t;return y(this,r),(t=n.call(this,e))._values={},t._scope=e.scope,t.opts=s(s({},e),{},{_n:e.lines?E:O.nil}),t}return d(r,[{key:"get",value:function(){return this._scope}},{key:"name",value:function(e){return new x(e,this._newName(e))}},{key:"value",value:function(e,t){var n;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");var r=this.toName(e),o=r.prefix,i=null!==(n=t.key)&&void 0!==n?n:t.ref,a=this._values[o];if(a){var u=a.get(i);if(u)return u}else a=this._values[o]=new Map;a.set(i,r);var s=this._scope[o]||(this._scope[o]=[]),c=s.length;return s[c]=t.ref,r.setValue(t,{property:o,itemIndex:c}),r}},{key:"getValue",value:function(e,t){var n=this._values[e];if(n)return n.get(t)}},{key:"scopeRefs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._values;return this._reduceValues(t,(function(t){if(void 0===t.scopePath)throw new Error('CodeGen: name "'.concat(t,'" has no value'));return O._(a(),e,t.scopePath)}))}},{key:"scopeCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._values,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this._reduceValues(e,(function(e){if(void 0===e.value)throw new Error('CodeGen: name "'.concat(e,'" has no value'));return e.value.code}),t,n)}},{key:"_reduceValues",value:function(e,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0,s=O.nil,c=function(c){var l=e[c];if(!l)return"continue";var f=a[c]=a[c]||new Set;l.forEach((function(e){if(!f.has(e)){f.add(e);var a=n(e);if(a){var c=r.opts.es5?t.varKinds.var:t.varKinds.const;s=O._(i(),s,c,e,a,r.opts._n)}else{if(!(a=null==u?void 0:u(e)))throw new P(e);s=O._(o(),s,a,r.opts._n)}}}))};for(var l in e)c(l);return s}}]),r}(j);t.ValueScope=C},function(e,t,n){var r,o,i,a;function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/** @license URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */a=function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,o=1;o<r;++o)t[o]=t[o].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function n(e){return"(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function o(e){return e.toUpperCase()}function i(e){var r=t("[0-9]","[A-Fa-f]"),o=n(n("%[EFef]"+r+"%"+r+r+"%"+r+r)+"|"+n("%[89A-Fa-f]"+r+"%"+r+r)+"|"+n("%"+r+r)),i="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",a=t("[\\:\\/\\?\\#\\[\\]\\@]",i),u=e?"[\\uE000-\\uF8FF]":"[]",s=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),c=n("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),l=n(n(o+"|"+t(s,i,"[\\:]"))+"*"),f=(n(n("25[0-5]")+"|"+n("2[0-4][0-9]")+"|"+n("1[0-9][0-9]")+"|"+n("[1-9][0-9]")+"|[0-9]"),n(n("25[0-5]")+"|"+n("2[0-4][0-9]")+"|"+n("1[0-9][0-9]")+"|"+n("0?[1-9][0-9]")+"|0?0?[0-9]")),h=n(f+"\\."+f+"\\."+f+"\\."+f),p=n(r+"{1,4}"),d=n(n(p+"\\:"+p)+"|"+h),y=n(n(p+"\\:")+"{6}"+d),m=n("\\:\\:"+n(p+"\\:")+"{5}"+d),v=n(n(p)+"?\\:\\:"+n(p+"\\:")+"{4}"+d),b=n(n(n(p+"\\:")+"{0,1}"+p)+"?\\:\\:"+n(p+"\\:")+"{3}"+d),_=n(n(n(p+"\\:")+"{0,2}"+p)+"?\\:\\:"+n(p+"\\:")+"{2}"+d),g=n(n(n(p+"\\:")+"{0,3}"+p)+"?\\:\\:"+p+"\\:"+d),w=n(n(n(p+"\\:")+"{0,4}"+p)+"?\\:\\:"+d),k=n(n(n(p+"\\:")+"{0,5}"+p)+"?\\:\\:"+p),S=n(n(n(p+"\\:")+"{0,6}"+p)+"?\\:\\:"),O=n([y,m,v,b,_,g,w,k,S].join("|")),P=n(n(s+"|"+o)+"+"),j=(n(O+"\\%25"+P),n(O+n("\\%25|\\%(?!"+r+"{2})")+P)),x=n("[vV]"+r+"+\\."+t(s,i,"[\\:]")+"+"),E=n("\\["+n(j+"|"+O+"|"+x)+"\\]"),C=n(n(o+"|"+t(s,i))+"*"),T=n(E+"|"+h+"(?!"+C+")|"+C),R=n("[0-9]*"),A=n(n(l+"@")+"?"+T+n("\\:"+R)+"?"),D=n(o+"|"+t(s,i,"[\\:\\@]")),M=n(D+"*"),N=n(D+"+"),I=n(n(o+"|"+t(s,i,"[\\@]"))+"+"),L=n(n("\\/"+M)+"*"),$=n("\\/"+n(N+L)+"?"),V=n(I+L),z=n(N+L),B="(?!"+D+")",U=(n(L+"|"+$+"|"+V+"|"+z+"|"+B),n(n(D+"|"+t("[\\/\\?]",u))+"*")),F=n(n(D+"|[\\/\\?]")+"*"),q=n(n("\\/\\/"+A+L)+"|"+$+"|"+z+"|"+B),H=n(c+"\\:"+q+n("\\?"+U)+"?"+n("\\#"+F)+"?"),G=n(n("\\/\\/"+A+L)+"|"+$+"|"+V+"|"+B),K=n(G+n("\\?"+U)+"?"+n("\\#"+F)+"?");return n(H+"|"+K),n(c+"\\:"+q+n("\\?"+U)+"?"),n(n("\\/\\/("+n("("+l+")@")+"?("+T+")"+n("\\:("+R+")")+"?)")+"?("+L+"|"+$+"|"+z+"|"+B+")"),n("\\?("+U+")"),n("\\#("+F+")"),n(n("\\/\\/("+n("("+l+")@")+"?("+T+")"+n("\\:("+R+")")+"?)")+"?("+L+"|"+$+"|"+V+"|"+B+")"),n("\\?("+U+")"),n("\\#("+F+")"),n(n("\\/\\/("+n("("+l+")@")+"?("+T+")"+n("\\:("+R+")")+"?)")+"?("+L+"|"+$+"|"+z+"|"+B+")"),n("\\?("+U+")"),n("\\#("+F+")"),n("("+l+")@"),n("\\:("+R+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",s,i),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",s,i),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",s,i),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",s,i),"g"),NOT_QUERY:new RegExp(t("[^\\%]",s,i,"[\\:\\@\\/\\?]",u),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",s,i,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",s,i),"g"),UNRESERVED:new RegExp(s,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",s,a),"g"),PCT_ENCODED:new RegExp(o,"g"),IPV4ADDRESS:new RegExp("^("+h+")$"),IPV6ADDRESS:new RegExp("^\\[?("+O+")"+n(n("\\%25|\\%(?!"+r+"{2})")+"("+P+")")+"?\\]?$")}}var a=i(!1),u=i(!0),s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,l=/^xn--/,f=/[^\0-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,y=String.fromCharCode;function m(e){throw new RangeError(p[e])}function v(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]);var o=function(e,t){for(var n=[],r=e.length;r--;)n[r]=t(e[r]);return n}((e=e.replace(h,".")).split("."),t).join(".");return r+o}function b(e){for(var t=[],n=0,r=e.length;n<r;){var o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),n--)}else t.push(o)}return t}var _=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},g=function(e,t,n){var r=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;r+=36)e=d(e/35);return d(r+36*e/(e+38))},w=function(e){var t,n=[],r=e.length,o=0,i=128,a=72,u=e.lastIndexOf("-");u<0&&(u=0);for(var s=0;s<u;++s)e.charCodeAt(s)>=128&&m("not-basic"),n.push(e.charCodeAt(s));for(var l=u>0?u+1:0;l<r;){for(var f=o,h=1,p=36;;p+=36){l>=r&&m("invalid-input");var y=(t=e.charCodeAt(l++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(y>=36||y>d((c-o)/h))&&m("overflow"),o+=y*h;var v=p<=a?1:p>=a+26?26:p-a;if(y<v)break;var b=36-v;h>d(c/b)&&m("overflow"),h*=b}var _=n.length+1;a=g(o-f,_,0==f),d(o/_)>c-i&&m("overflow"),i+=d(o/_),o%=_,n.splice(o++,0,i)}return String.fromCodePoint.apply(String,n)},k=function(e){var t=[],n=(e=b(e)).length,r=128,o=0,i=72,a=!0,u=!1,s=void 0;try{for(var l,f=e[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){var h=l.value;h<128&&t.push(y(h))}}catch(e){u=!0,s=e}finally{try{!a&&f.return&&f.return()}finally{if(u)throw s}}var p=t.length,v=p;for(p&&t.push("-");v<n;){var w=c,k=!0,S=!1,O=void 0;try{for(var P,j=e[Symbol.iterator]();!(k=(P=j.next()).done);k=!0){var x=P.value;x>=r&&x<w&&(w=x)}}catch(e){S=!0,O=e}finally{try{!k&&j.return&&j.return()}finally{if(S)throw O}}var E=v+1;w-r>d((c-o)/E)&&m("overflow"),o+=(w-r)*E,r=w;var C=!0,T=!1,R=void 0;try{for(var A,D=e[Symbol.iterator]();!(C=(A=D.next()).done);C=!0){var M=A.value;if(M<r&&++o>c&&m("overflow"),M==r){for(var N=o,I=36;;I+=36){var L=I<=i?1:I>=i+26?26:I-i;if(N<L)break;var $=N-L,V=36-L;t.push(y(_(L+$%V,0))),N=d($/V)}t.push(y(_(N,0))),i=g(o,E,v==p),o=0,++v}}}catch(e){T=!0,R=e}finally{try{!C&&D.return&&D.return()}finally{if(T)throw R}}++o,++r}return t.join("")},S=function(e){return v(e,(function(e){return f.test(e)?"xn--"+k(e):e}))},O=function(e){return v(e,(function(e){return l.test(e)?w(e.slice(4).toLowerCase()):e}))},P={};function j(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function x(e){for(var t="",n=0,r=e.length;n<r;){var o=parseInt(e.substr(n+1,2),16);if(o<128)t+=String.fromCharCode(o),n+=3;else if(o>=194&&o<224){if(r-n>=6){var i=parseInt(e.substr(n+4,2),16);t+=String.fromCharCode((31&o)<<6|63&i)}else t+=e.substr(n,6);n+=6}else if(o>=224){if(r-n>=9){var a=parseInt(e.substr(n+4,2),16),u=parseInt(e.substr(n+7,2),16);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&u)}else t+=e.substr(n,9);n+=9}else t+=e.substr(n,3),n+=3}return t}function E(e,t){function n(e){var n=x(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,j).replace(t.PCT_ENCODED,o)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,j).replace(t.PCT_ENCODED,o)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,j).replace(t.PCT_ENCODED,o)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,j).replace(t.PCT_ENCODED,o)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,j).replace(t.PCT_ENCODED,o)),e}function C(e){return e.replace(/^0*(.*)/,"$1")||"0"}function T(e,t){var n=e.match(t.IPV4ADDRESS)||[],r=s(n,2)[1];return r?r.split(".").map(C).join("."):e}function R(e,t){var n=e.match(t.IPV6ADDRESS)||[],r=s(n,3),o=r[1],i=r[2];if(o){for(var a=o.toLowerCase().split("::").reverse(),u=s(a,2),c=u[0],l=u[1],f=l?l.split(":").map(C):[],h=c.split(":").map(C),p=t.IPV4ADDRESS.test(h[h.length-1]),d=p?7:8,y=h.length-d,m=Array(d),v=0;v<d;++v)m[v]=f[v]||h[y+v]||"";p&&(m[d-1]=T(m[d-1],t));var b=m.reduce((function(e,t,n){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===n?r.length++:e.push({index:n,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],_=void 0;if(b&&b.length>1){var g=m.slice(0,b.index),w=m.slice(b.index+b.length);_=g.join(":")+"::"+w.join(":")}else _=m.join(":");return i&&(_+="%"+i),_}return e}var A=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=!1!==t.iri?u:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var o=e.match(A);if(o){D?(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5])):(n.scheme=o[1]||void 0,n.userinfo=-1!==e.indexOf("@")?o[3]:void 0,n.host=-1!==e.indexOf("//")?o[4]:void 0,n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=-1!==e.indexOf("?")?o[7]:void 0,n.fragment=-1!==e.indexOf("#")?o[8]:void 0,isNaN(n.port)&&(n.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?o[4]:void 0)),n.host&&(n.host=R(T(n.host,r),r)),void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||n.path||void 0!==n.query?void 0===n.scheme?n.reference="relative":void 0===n.fragment?n.reference="absolute":n.reference="uri":n.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==n.reference&&(n.error=n.error||"URI is not a "+t.reference+" reference.");var i=P[(t.scheme||n.scheme||"").toLowerCase()];if(t.unicodeSupport||i&&i.unicodeSupport)E(n,r);else{if(n.host&&(t.domainHost||i&&i.domainHost))try{n.host=S(n.host.replace(r.PCT_ENCODED,x).toLowerCase())}catch(e){n.error=n.error||"Host's domain name can not be converted to ASCII via punycode: "+e}E(n,a)}i&&i.parse&&i.parse(n,t)}else n.error=n.error||"URI can not be parsed.";return n}function N(e,t){var n=!1!==t.iri?u:a,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(R(T(String(e.host),n),n).replace(n.IPV6ADDRESS,(function(e,t,n){return"["+t+(n?"%25"+n:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(r.push(":"),r.push(String(e.port))),r.length?r.join(""):void 0}var I=/^\.\.?\//,L=/^\/\.(\/|$)/,$=/^\/\.\.(\/|$)/,V=/^\/?(?:.|\n)*?(?=\/|$)/;function z(e){for(var t=[];e.length;)if(e.match(I))e=e.replace(I,"");else if(e.match(L))e=e.replace(L,"/");else if(e.match($))e=e.replace($,"/"),t.pop();else if("."===e||".."===e)e="";else{var n=e.match(V);if(!n)throw new Error("Unexpected dot segment condition");var r=n[0];e=e.slice(r.length),t.push(r)}return t.join("")}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iri?u:a,r=[],o=P[(t.scheme||e.scheme||"").toLowerCase()];if(o&&o.serialize&&o.serialize(e,t),e.host)if(n.IPV6ADDRESS.test(e.host));else if(t.domainHost||o&&o.domainHost)try{e.host=t.iri?O(e.host):S(e.host.replace(n.PCT_ENCODED,x).toLowerCase())}catch(n){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+n}E(e,n),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var i=N(e,t);if(void 0!==i&&("suffix"!==t.reference&&r.push("//"),r.push(i),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var s=e.path;t.absolutePath||o&&o.absolutePath||(s=z(s)),void 0===i&&(s=s.replace(/^\/\//,"/%2F")),r.push(s)}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],o={};return r||(e=M(B(e,n),n),t=M(B(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(o.scheme=t.scheme,o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=z(t.path||""),o.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=z(t.path||""),o.query=t.query):(t.path?("/"===t.path.charAt(0)?o.path=z(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?o.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:o.path=t.path:o.path="/"+t.path,o.path=z(o.path)),o.query=t.query):(o.path=e.path,void 0!==t.query?o.query=t.query:o.query=e.query),o.userinfo=e.userinfo,o.host=e.host,o.port=e.port),o.scheme=e.scheme),o.fragment=t.fragment,o}function F(e,t){return e&&e.toString().replace(t&&t.iri?u.PCT_ENCODED:a.PCT_ENCODED,x)}var q={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var n="https"===String(e.scheme).toLowerCase();return e.port!==(n?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},H={scheme:"https",domainHost:q.domainHost,parse:q.parse,serialize:q.serialize};function G(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var K={scheme:"ws",domainHost:!0,parse:function(e,t){var n=e;return n.secure=G(n),n.resourceName=(n.path||"/")+(n.query?"?"+n.query:""),n.path=void 0,n.query=void 0,n},serialize:function(e,t){if(e.port!==(G(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var n=e.resourceName.split("?"),r=s(n,2),o=r[0],i=r[1];e.path=o&&"/"!==o?o:void 0,e.query=i,e.resourceName=void 0}return e.fragment=void 0,e}},X={scheme:"wss",domainHost:K.domainHost,parse:K.parse,serialize:K.serialize},W={},Y="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",J="[0-9A-Fa-f]",Q=n(n("%[EFef]"+J+"%"+J+J+"%"+J+J)+"|"+n("%[89A-Fa-f]"+J+"%"+J+J)+"|"+n("%"+J+J)),Z=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),ee=new RegExp(Y,"g"),te=new RegExp(Q,"g"),ne=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Z),"g"),re=new RegExp(t("[^]",Y,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),oe=re;function ie(e){var t=x(e);return t.match(ee)?t:e}var ae={scheme:"mailto",parse:function(e,t){var n=e,r=n.to=n.path?n.path.split(","):[];if(n.path=void 0,n.query){for(var o=!1,i={},a=n.query.split("&"),u=0,s=a.length;u<s;++u){var c=a[u].split("=");switch(c[0]){case"to":for(var l=c[1].split(","),f=0,h=l.length;f<h;++f)r.push(l[f]);break;case"subject":n.subject=F(c[1],t);break;case"body":n.body=F(c[1],t);break;default:o=!0,i[F(c[0],t)]=F(c[1],t)}}o&&(n.headers=i)}n.query=void 0;for(var p=0,d=r.length;p<d;++p){var y=r[p].split("@");if(y[0]=F(y[0]),t.unicodeSupport)y[1]=F(y[1],t).toLowerCase();else try{y[1]=S(F(y[1],t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}r[p]=y.join("@")}return n},serialize:function(e,t){var n,r=e,i=null!=(n=e.to)?n instanceof Array?n:"number"!=typeof n.length||n.split||n.setInterval||n.call?[n]:Array.prototype.slice.call(n):[];if(i){for(var a=0,u=i.length;a<u;++a){var s=String(i[a]),c=s.lastIndexOf("@"),l=s.slice(0,c).replace(te,ie).replace(te,o).replace(ne,j),f=s.slice(c+1);try{f=t.iri?O(f):S(F(f,t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}i[a]=l+"@"+f}r.path=i.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var p=[];for(var d in h)h[d]!==W[d]&&p.push(d.replace(te,ie).replace(te,o).replace(re,j)+"="+h[d].replace(te,ie).replace(te,o).replace(oe,j));return p.length&&(r.query=p.join("&")),r}},ue=/^([^\:]+)\:(.*)/,se={scheme:"urn",parse:function(e,t){var n=e.path&&e.path.match(ue),r=e;if(n){var o=t.scheme||r.scheme||"urn",i=n[1].toLowerCase(),a=n[2],u=o+":"+(t.nid||i),s=P[u];r.nid=i,r.nss=a,r.path=void 0,s&&(r=s.parse(r,t))}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var n=t.scheme||e.scheme||"urn",r=e.nid,o=n+":"+(t.nid||r),i=P[o];i&&(e=i.serialize(e,t));var a=e,u=e.nss;return a.path=(r||t.nid)+":"+u,a}},ce=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,le={scheme:"urn:uuid",parse:function(e,t){var n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&n.uuid.match(ce)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e,t){var n=e;return n.nss=(e.uuid||"").toLowerCase(),n}};P[q.scheme]=q,P[H.scheme]=H,P[K.scheme]=K,P[X.scheme]=X,P[ae.scheme]=ae,P[se.scheme]=se,P[le.scheme]=le,e.SCHEMES=P,e.pctEncChar=j,e.pctDecChars=x,e.parse=M,e.removeDotSegments=z,e.serialize=B,e.resolveComponents=U,e.resolve=function(e,t,n){var r=function(e,t){var n=e;if(t)for(var r in t)n[r]=t[r];return n}({scheme:"null"},n);return B(U(M(e,r),M(t,r),r,!0),r)},e.normalize=function(e,t){return"string"==typeof e?e=B(M(e,t),t):"object"===r(e)&&(e=M(B(e,t),t)),e},e.equal=function(e,t,n){return"string"==typeof e?e=B(M(e,n),n):"object"===r(e)&&(e=B(e,n)),"string"==typeof t?t=B(M(t,n),n):"object"===r(t)&&(t=B(t,n)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?u.ESCAPE:a.ESCAPE,j)},e.unescapeComponent=F,Object.defineProperty(e,"__esModule",{value:!0})},"object"===u(t)&&void 0!==e?a(t):(o=[t],void 0===(i="function"==typeof(r=a)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e=u(['""']);return i=function(){return e},e}function a(){var e=u(['require("ajv/dist/compile/error_classes").ValidationError']);return a=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;var c=n(1),l=n(18),f=n(6),h=n(15),p=n(3),d=n(5),y=n(22),m=function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.refs={},this.dynamicAnchors={},"object"==s(t.schema)&&(r=t.schema),this.schema=t.schema,this.root=t.root||this,this.baseId=null!==(n=t.baseId)&&void 0!==n?n:h.normalizeId(null==r?void 0:r.$id),this.localRefs=t.localRefs,this.meta=t.meta,this.$async=null==r?void 0:r.$async,this.refs={}};function v(e){var t=_.call(this,e);if(t)return t;var n,r=h.getFullPath(e.root.baseId),o=this.opts.code,u=o.es5,s=o.lines,p=this.opts.ownProperties,y=new c.CodeGen(this.scope,{es5:u,lines:s,ownProperties:p});e.$async&&(n=y.scopeValue("Error",{ref:l.ValidationError,code:c._(a())}));var m=y.scopeName("validate");e.validateName=m;var v,b={gen:y,allErrors:this.opts.allErrors,data:f.default.data,parentData:f.default.parentData,parentDataProperty:f.default.parentDataProperty,dataNames:[f.default.data],dataPathArr:[c.nil],dataLevel:0,dataTypes:[],topSchemaRef:y.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:c.stringify(e.schema)}:{ref:e.schema}),validateName:m,ValidationError:n,schema:e.schema,schemaEnv:e,strictSchema:!0,rootId:r,baseId:e.baseId||r,schemaPath:c.nil,errSchemaPath:"#",errorPath:c._(i()),opts:this.opts,self:this};try{this._compilations.add(e),d.validateFunctionCode(b),y.optimize(this.opts.code.optimize);var g=y.toString();v="".concat(y.scopeRefs(f.default.scope),"return ").concat(g),this.opts.code.process&&(v=this.opts.code.process(v,e));var w=new Function("".concat(f.default.self),"".concat(f.default.scope),v)(this,this.scope.get());if(this.scope.value(m,{ref:w}),w.errors=null,w.schema=e.schema,w.schemaEnv=e,e.$async&&(w.$async=!0),!0===this.opts.code.source&&(w.source={validateName:m,validateCode:g,scopeValues:y._values}),this.opts.unevaluated){var k=b.props,S=b.items;w.evaluated={props:k instanceof c.Name?void 0:k,items:S instanceof c.Name?void 0:S,dynamicProps:k instanceof c.Name,dynamicItems:S instanceof c.Name},w.source&&(w.source.evaluated=c.stringify(w.evaluated))}return e.validate=w,e}catch(t){throw delete e.validate,delete e.validateName,v&&this.logger.error("Error compiling schema, function code:",v),t}finally{this._compilations.delete(e)}}function b(e){return h.inlineRef(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:v.call(this,e)}function _(e){var t,n,o,i=r(this._compilations);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(o=e,(n=a).schema===o.schema&&n.root===o.root&&n.baseId===o.baseId)return a}}catch(e){i.e(e)}finally{i.f()}}function g(e,t){for(var n;"string"==typeof(n=this.refs[t]);)t=n;return n||this.schemas[t]||w.call(this,e,t)}function w(e,t){var n=y.parse(t),r=h._getFullPath(n),o=h.getFullPath(e.baseId);if(Object.keys(e.schema).length>0&&r===o)return S.call(this,n,e);var i=h.normalizeId(r),a=this.refs[i]||this.schemas[i];if("string"==typeof a){var u=w.call(this,e,a);if("object"!==s(null==u?void 0:u.schema))return;return S.call(this,n,u)}return"object"===s(null==a?void 0:a.schema)?(a.validate||v.call(this,a),i===h.normalizeId(t)?new m({schema:a.schema,root:e,baseId:o}):S.call(this,n,a)):void 0}t.SchemaEnv=m,t.compileSchema=v,t.resolveRef=function(e,t,n){var r;n=h.resolveUrl(t,n);var o=e.refs[n];if(o)return o;var i=g.call(this,e,n);if(void 0===i){var a=null===(r=e.localRefs)||void 0===r?void 0:r[n];a&&(i=new m({schema:a,root:e,baseId:t}))}return void 0!==i?e.refs[n]=b.call(this,i):void 0},t.resolveSchema=w;var k=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function S(e,t){var n,o=t.baseId,i=t.schema,a=t.root;if("/"===(null===(n=e.fragment)||void 0===n?void 0:n[0])){var u,c,l=r(e.fragment.slice(1).split("/"));try{for(l.s();!(u=l.n()).done;){var f=u.value;if("boolean"==typeof i)return;if(void 0===(i=i[p.unescapeFragment(f)]))return;!k.has(f)&&"object"==s(i)&&i.$id&&(o=h.resolveUrl(o,i.$id))}}catch(e){l.e(e)}finally{l.f()}if("boolean"!=typeof i&&i.$ref&&!p.schemaHasRulesButRef(i,this.RULES)){var d=h.resolveUrl(o,i.$ref);c=w.call(this,a,d)}return(c=c||new m({schema:i,root:a,baseId:o})).schema!==c.root.schema?c:void 0}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e=p(["delete ","[","]"]);return o=function(){return e},e}function i(){var e=p(["!(",")"]);return i=function(){return e},e}function a(){var e=p(["",".test(",")"]);return a=function(){return e},e}function u(){var e=p([""," === ",""]);return u=function(){return e},e}function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){var e=p(["",".hasOwnProperty(",")"]);return l=function(){return e},e}function f(){var e=p([""," === ",""]);return f=function(){return e},e}function h(){var e=p(["{additionalProperty: ","}"]);return h=function(){return e},e}function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var d=n(7),y=n(1),m=n(6),v=n(12),b=n(3),_={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"should NOT have additional properties",params:function(e){var t=e.params;return y._(h(),t.additionalProperty)}},code:function(e){var t=e.gen,n=e.schema,c=e.parentSchema,h=e.data,p=e.errsCount,_=e.it;if(!p)throw new Error("ajv implementation error");var g=_.allErrors,w=_.opts;if(_.props=!0,"all"===w.removeAdditional||!b.alwaysValidSchema(_,n)){var k=d.allSchemaProperties(c.properties),S=d.allSchemaProperties(c.patternProperties);t.forIn("key",h,(function(e){k.length||S.length?t.if(function(e){var n;if(k.length>8){var r=b.schemaRefOrVal(_,c.properties,"properties");n=y._(l(),r,e)}else n=k.length?y.or.apply(y,s(k.map((function(t){return y._(u(),e,t)})))):y.nil;return S.length&&(n=y.or.apply(y,[n].concat(s(S.map((function(n){return y._(a(),d.usePattern(t,n),e)})))))),y._(i(),n)}(e),(function(){return P(e)})):P(e)})),e.ok(y._(f(),p,m.default.errors))}function O(e){t.code(y._(o(),h,e))}function P(o){if("all"===w.removeAdditional||w.removeAdditional&&!1===n)O(o);else{if(!1===n)return e.setParams({additionalProperty:o}),e.error(),void(g||t.break());if("object"==r(n)&&!b.alwaysValidSchema(_,n)){var i=t.name("valid");"failing"===w.removeAdditional?(j(o,i,!1),t.if(y.not(i),(function(){e.reset(),O(o)}))):(j(o,i),g||t.if(y.not(i),(function(){return t.break()})))}}}function j(t,n,r){var o={keyword:"additionalProperties",dataProp:t,dataPropType:v.Type.Str,strictSchema:_.strictSchema};!1===r&&Object.assign(o,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(o,n)}}};t.default=_},function(module,__webpack_exports__,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var extendedMath=__webpack_require__(36),TankController=function(){function e(){_classCallCheck(this,e),this._initCallback=function(){},this._loopCallback=function(){}}return _createClass(e,[{key:"loop",value:function(e){this._loopCallback=e}},{key:"init",value:function(e){this._initCallback=e}}]),e}(),EvalWorker=function(){function EvalWorker(){_classCallCheck(this,EvalWorker),this.onmessage=function(e){},this._callStackLimit=100,this._callStackCount=0,this._tankController=new TankController}return _createClass(EvalWorker,[{key:"postMessage",value:function postMessage(inputData){var _this=this,response=null;if("init"==inputData.command){if(!inputData.code)throw"The code is required!";var settings=inputData.settings,info=inputData.info,Math=extendedMath(),tank=this._tankController;eval(inputData.code),tank._initCallback(settings,info),response={data:{type:"init",settings:settings}}}else if("update"==inputData.command){var state=inputData.state,control=inputData.control;this._tankController._loopCallback?(this._tankController._loopCallback(state,control),response={data:control}):response={data:control}}this._callStackCount<this._callStackLimit?(this._callStackCount++,this.onmessage(response)):(this._callStackCount=0,setTimeout((function(){_this.onmessage(response)}),1))}},{key:"terminate",value:function(){}}]),EvalWorker}();__webpack_exports__.a=EvalWorker},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var f=n(13);t.KeywordCxt=f.default;var h=n(1);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return h._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return h.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return h.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return h.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return h.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return h.CodeGen}});var p=n(42),d=n(44),y=n(77),m=["/properties"],v="http://json-schema.org/draft-07/schema",b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(f,e);var t,n,r,c=s(f);function f(){return o(this,f),c.apply(this,arguments)}return t=f,(n=[{key:"_addVocabularies",value:function(){var e=this;a(l(f.prototype),"_addVocabularies",this).call(this),d.default.forEach((function(t){return e.addVocabulary(t)}))}},{key:"_addDefaultMetaSchema",value:function(){a(l(f.prototype),"_addDefaultMetaSchema",this).call(this);var e=this.opts,t=e.$data;if(e.meta){var n=t?this.$dataMetaSchema(y,m):y;this.addMetaSchema(n,v,!1),this.refs["http://json-schema.org/schema"]=v}}},{key:"defaultMeta",value:function(){return this.opts.defaultMeta=a(l(f.prototype),"defaultMeta",this).call(this)||(this.getSchema(v)?v:void 0)}}])&&i(t.prototype,n),r&&i(t,r),f}(p.default);t.default=b},function(e){e.exports=JSON.parse('{"definitions":{},"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://jsbattle.jmrlab.com/schema/ubd-schema-v4.json","type":"object","title":"The Ultimate Battle Descriptor Schema","required":["version","rngSeed","timeLimit","teamMode","aiList"],"properties":{"version":{"$id":"#/properties/version","enum":[4],"title":"Version of the schema"},"rngSeed":{"$id":"#/properties/rngSeed","type":"number","title":"Battle RNG seed","default":0,"examples":[0.850067584253805]},"timeLimit":{"$id":"#/properties/timeLimit","type":"number","title":"Duration of the battle in ms (or zero if no limit defined","default":0,"examples":[0,20000]},"teamMode":{"$id":"#/properties/teamMode","type":"boolean","title":"Team death match","default":false,"examples":[false]},"aiList":{"$id":"#/properties/aiList","type":"array","minItems":2,"maxItems":40,"title":"List of AIs that joins the battle","items":{"$id":"#/properties/aiList/items","type":"object","title":"Tank AI","required":["name","team","code","initData","useSandbox","executionLimit"],"properties":{"name":{"$id":"#/properties/aiList/items/properties/name","type":"string","title":"Name of tank","default":"","examples":["User Created Tank"],"pattern":"^(.*)$"},"team":{"$id":"#/properties/aiList/items/properties/team","type":"string","title":"Team of the tank","default":"","examples":["10i42s2ca"],"pattern":"^(.*)$"},"code":{"$id":"#/properties/aiList/items/properties/code","anyOf":[{"type":"string"},{"type":"null"}],"title":"Code of the AI","default":"","examples":["var a = 1;"]},"initData":{"$id":"#/properties/aiList/items/properties/initData","default":null,"title":"Initial data of AI","anyOf":[{"type":"object"},{"type":"null"}],"examples":[null]},"useSandbox":{"$id":"#/properties/aiList/items/properties/useSandbox","type":"boolean","title":"Use sandbox for AI execution","default":true,"examples":[true]},"executionLimit":{"$id":"#/properties/aiList/items/properties/executionLimit","type":"integer","title":"AI code execution time limit in ms","default":100,"examples":[100]},"count":{"$id":"#/properties/aiList/items/properties/count","type":"integer","title":"count of AIs to added","default":1,"examples":[3]}}}}}}')},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,i,a){function u(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function c(e,t){var n=new u(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==o(r)&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(4)&&n(10)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.alea=c}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,i,a){function u(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function c(e,t){var n=new u(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==o(r)&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(4)&&n(10)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xor128=c}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,i,a){function u(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function c(e,t){var n=new u(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==o(r)&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(4)&&n(10)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xorwow=c}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,o,i){function a(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function u(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=s:n(4)&&n(10)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorshift7=s}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,o,i){function a(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,u=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),o=0,i=-32;i<s;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=u[127&i]^=r+a)?o+1:0);for(o>=128&&(u[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=u[o+34&127],n=u[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[o]=r^n;e.w=a,e.X=u,e.i=o}(t,e)}function u(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=s:n(4)&&n(10)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor4096=s}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,i,a){function u(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function c(e,t){var n=new u(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==o(r)&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n(4)&&n(10)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.tychei=c}(0,"object"==o(e)&&e,n(4))}).call(this,n(8)(e))},function(e,t,n){(function(e){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(i,a,u){var s,c=u.pow(256,6),l=u.pow(2,52),f=2*l;function h(e,t,n){var r=[],h=y(function e(t,n){var r,i=[],a=o(t);if(n&&"object"==a)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"string"==a?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,m(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(256):(e=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,m(a)]}}():e,3),r),v=new p(r),b=function(){for(var e=v.g(6),t=c,n=0;e<l;)e=256*(e+n),t*=256,n=v.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|v.g(4)},b.quick=function(){return v.g(4)/4294967296},b.double=b,y(m(v.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&d(r,v),e.state=function(){return d(v,{})}),n?(u.random=e,t):e})(b,h,"global"in t?t.global:this==u,t.state)}function p(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);o<256;)a[o]=o++;for(o=0;o<256;o++)a[o]=a[i=255&i+e[o%n]+(t=a[o])],a[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,a=r.S;e--;)t=a[o=255&o+1],n=256*n+a[255&(a[o]=a[i=255&i+t])+(a[i]=t)];return r.i=o,r.j=i,n})(256)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){for(var n,r=e+"",o=0;o<r.length;)t[255&o]=255&(n^=19*t[255&o])+r.charCodeAt(o++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(y(u.random(),a),"object"==o(e)&&e.exports){e.exports=h;try{s=n(35)}catch(e){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)}).call(this,n(8)(e))},function(e,t){},function(e,t){e.exports=function(){var e={},t=["LN10","PI","E","LOG10E","SQRT2","LOG2E","SQRT1_2","LN2","cos","pow","log","tan","sqrt","ceil","asin","abs","max","exp","atan2","random","round","floor","acos","atan","min","sin"];for(var n in t)e[t[n]]=Math[t[n]];return e.deg={},e.rad={},e.deg.normalize=function(e){for(e=Number(e);e>180;)e-=360;for(;e<=-180;)e+=360;return e},e.rad.normalize=function(t){for(t=Number(t);t>e.PI;)t-=2*e.PI;for(;t<=-e.PI;)t+=2*e.PI;return t},e.deg2rad=function(t){return e.rad.normalize(t*(e.PI/180))},e.rad2deg=function(t){return e.deg.normalize(t*(180/e.PI))},e.rad.atan2=e.atan2,e.deg.atan2=function(t,n){return e.rad2deg(e.rad.atan2(t,n))},e.distance=function(t,n,r,o){var i=r-t,a=o-n;return e.sqrt(i*i+a*a)},e.randomRange=function(t,n){if(t>n)throw"The range is incorrect. First number must be lower than second";return t+e.random()*(n-t)},e}},function(e,t,n){"use strict";function r(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["",".errors"]);return r=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;var i=n(14),a=n(1),u=n(6),s={message:"boolean schema is false"};function c(e,t){var n={gen:e.gen,keyword:"false schema",data:e.data,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};i.reportError(n,s,t)}t.topBoolOrEmptySchema=function(e){var t=e.gen,n=e.schema,i=e.validateName;!1===n?c(e,!1):"object"==o(n)&&!0===n.$async?t.return(u.default.data):(t.assign(a._(r(),i),null),t.return(!0))},t.boolOrEmptySchema=function(e,t){var n=e.gen;!1===e.schema?(n.var(t,!1),c(e)):n.var(t,!0)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([""," === ",""]);return o=function(){return e},e}function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.schemaKeywords=void 0;var u=n(20),s=n(11),c=n(39),l=n(11),f=n(40),h=n(3),p=n(5),d=n(1),y=n(6);function m(e,t){var n=e.gen,r=e.schema;e.opts.useDefaults&&c.assignDefaults(e,t.type),n.block((function(){var n,o=i(t.rules);try{for(o.s();!(n=o.n()).done;){var a=n.value;u.shouldUseRule(r,a)&&f.keywordCode(e,a.keyword,a.definition,t.type)}}catch(e){o.e(e)}finally{o.f()}}))}function v(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function b(e,t){var n=e.schemaEnv.baseId+e.errSchemaPath;t+=' at "'.concat(n,'" (strictTypes)'),p.checkStrictMode(e,t,e.opts.strictTypes)}t.schemaKeywords=function(e,t,n,a){var c=e.gen,p=e.schema,_=e.data,g=e.allErrors,w=e.opts,k=e.self.RULES;function S(r){u.shouldUseGroup(p,r)&&(r.type?(c.if(s.checkDataType(r.type,_,w.strict)),m(e,r),1===t.length&&t[0]===r.type&&n&&(c.else(),l.reportTypeError(e)),c.endIf()):m(e,r),g||c.if(d._(o(),y.default.errors,a||0)))}!p.$ref||!w.ignoreKeywordsWithRef&&h.schemaHasRulesButRef(p,k)?(!function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach((function(t){v(e.dataTypes,t)||b(e,'type "'.concat(t,'" not allowed by context "').concat(e.dataTypes.join(","),'"'))})),e.dataTypes=e.dataTypes.filter((function(e){return v(t,e)}))})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&b(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){var n=e.self.RULES.all;for(var o in n){var i=n[o];if("object"==r(i)&&u.shouldUseRule(e.schema,i)){var a=i.definition.type;a.length&&!a.some((function(e){return r=e,(n=t).includes(r)||"number"===r&&n.includes("integer");var n,r}))&&b(e,'missing type "'.concat(a.join(","),'" for keyword "').concat(o,'"'))}}}(e,e.dataTypes)}(e,t),c.block((function(){var e,t=i(k.rules);try{for(t.s();!(e=t.n()).done;){S(e.value)}}catch(e){t.e(e)}finally{t.f()}S(k.post)}))):c.block((function(){return f.keywordCode(e,"$ref",k.all.$ref.definition)}))}},function(e,t,n){"use strict";function r(){var e=u([""," = ",""]);return r=function(){return e},e}function o(){var e=u([""," || "," === null || ",' === ""']);return o=function(){return e},e}function i(){var e=u([""," === undefined"]);return i=function(){return e},e}function a(){var e=u(["","",""]);return a=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;var s=n(1),c=n(5);function l(e,t,n){var u=e.gen,l=e.compositeRule,f=e.data,h=e.opts;if(void 0!==n){var p=s._(a(),f,s.getProperty(t));if(l)c.checkStrictMode(e,"default is ignored for: ".concat(p));else{var d=s._(i(),p);"empty"===h.useDefaults&&(d=s._(o(),d,p,p)),u.if(d,s._(r(),p,s.stringify(n)))}}}t.assignDefaults=function(e,t){var n=e.schema,r=n.properties,o=n.items;if("object"===t&&r)for(var i in r)l(e,i,r[i].default);else"array"===t&&Array.isArray(o)&&o.forEach((function(t,n){return l(e,n,t.default)}))}},function(e,t,n){"use strict";function r(){var e=p(["",".length"]);return r=function(){return e},e}function o(){var e=p([""," === null ? "," : ",".concat(",")"]);return o=function(){return e},e}function i(){var e=p(["Array.isArray(",")"]);return i=function(){return e},e}function a(){var e=p(["","[","]"]);return a=function(){return e},e}function u(){var e=p(["","",""]);return u=function(){return e},e}function s(){var e=p(["await "]);return s=function(){return e},e}function c(){var e=p(["",".errors"]);return c=function(){return e},e}function l(){var e=p(["",".errors"]);return l=function(){return e},e}function f(){var e=p([""," instanceof ",""]);return f=function(){return e},e}function h(){var e=p(["await "]);return h=function(){return e},e}function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.keywordCode=void 0;var d=n(13),y=n(14),m=n(7),v=n(1),b=n(6);function _(e,t){var n,a=e.gen,p=e.keyword,d=e.schema,_=e.parentSchema,k=e.$data,S=e.it;!function(e,t){var n=e.schemaEnv;if(t.async&&!n.$async)throw new Error("async keyword in sync schema")}(S,t);var O=!k&&t.compile?t.compile.call(S.self,d,_,S):t.validate,P=w(a,p,O),j=a.let("valid");function x(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.async?v._(s()):v.nil,r=S.opts.passContext?b.default.this:b.default.self,o=!("compile"in t&&!k||!1===t.schema);a.assign(j,v._(u(),n,m.callValidateCode(e,P,r,o)),t.modifying)}function E(e){var n;a.if(v.not(null!==(n=t.valid)&&void 0!==n?n:j),e)}e.block$data(j,(function(){if(!1===t.errors)x(),t.modifying&&g(e),E((function(){return e.error()}));else{var n=t.async?function(){var e=a.let("ruleErrs",null);return a.try((function(){return x(v._(h()))}),(function(t){return a.assign(j,!1).if(v._(f(),t,S.ValidationError),(function(){return a.assign(e,v._(l(),t))}),(function(){return a.throw(t)}))})),e}():(u=v._(c(),P),a.assign(u,null),x(v.nil),u);t.modifying&&g(e),E((function(){return function(e,t){var n=e.gen;n.if(v._(i(),t),(function(){n.assign(b.default.vErrors,v._(o(),b.default.vErrors,t,b.default.vErrors,t)).assign(b.default.errors,v._(r(),b.default.vErrors)),y.extendErrors(e)}),(function(){return e.error()}))}(e,n)}))}var u})),e.ok(null!==(n=t.valid)&&void 0!==n?n:j)}function g(e){var t=e.gen,n=e.data,r=e.it;t.if(r.parentData,(function(){return t.assign(n,v._(a(),r.parentData,r.parentDataProperty))}))}function w(e,t,n){if(void 0===n)throw new Error('keyword "'.concat(t,'" failed to compile'));return e.scopeValue("keyword","function"==typeof n?{ref:n}:{ref:n,code:v.stringify(n)})}t.keywordCode=function(e,t,n,r){var o=new d.default(e,n,t);"code"in n?n.code(o,r):o.$data&&n.validate?_(o,n):"macro"in n?function(e,t){var n=e.gen,r=e.keyword,o=e.schema,i=e.parentSchema,a=e.it,u=t.macro.call(a.self,o,i,a),s=w(n,r,u);!1!==a.opts.validateSchema&&a.self.validateSchema(u,!0);var c=n.name("valid");e.subschema({schema:u,schemaPath:v.nil,errSchemaPath:"".concat(a.errSchemaPath,"/").concat(r),topSchemaRef:s,compositeRule:!0},c),e.pass(c,(function(){return e.error(!0)}))}(o,n):(n.compile||n.validate)&&_(o,n)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=e.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),function e(t,n,i,a,u,s,c,l,f,h){if(a&&"object"==r(a)&&!Array.isArray(a)){for(var p in n(a,u,s,c,l,f,h),a){var d=a[p];if(Array.isArray(d)){if(p in o.arrayKeywords)for(var y=0;y<d.length;y++)e(t,n,i,d[y],u+"/"+p+"/"+y,s,u,p,a,y)}else if(p in o.propsKeywords){if(d&&"object"==r(d))for(var m in d)e(t,n,i,d[m],u+"/"+p+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),s,u,p,a,m)}else(p in o.keywords||t.allKeys&&!(p in o.skipKeywords))&&e(t,n,i,d,u+"/"+p,s,u,p,a)}i(a,u,s,c,l,f,h)}}(t,"function"==typeof(n=t.cb||n)?n:n.pre||function(){},n.post||function(){},e,"",e)};o.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},o.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},o.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},o.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){i(a,r,o,u,s,"next",e)}function s(e){i(a,r,o,u,s,"throw",e)}u(void 0)}))}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var p=n(13);t.KeywordCxt=p.default;var d=n(1);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var y=n(18),m=n(19),v=n(23),b=n(1),_=n(15),g=n(11),w=n(3),k=n(43),S=["removeAdditional","useDefaults","coerceTypes"],O=new Set(["validate","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),P={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",schemaId:"JSON Schema draft-04 is not supported in Ajv v7.",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",strictNumbers:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key."},j={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function x(e){var t,n,r,o,i,a,u,s,c,l,h,p,d=null===(t=e.strict)||void 0===t||t,y=!!d&&"log",m=null===(n=e.code)||void 0===n?void 0:n.optimize,v=!0===m||void 0===m?1:m||0;return{strict:d,strictTypes:null!==(r=e.strictTypes)&&void 0!==r?r:y,strictTuples:null!==(o=e.strictTuples)&&void 0!==o?o:y,code:e.code?f(f({},e.code),{},{optimize:v}):{optimize:v},loopRequired:null!==(i=e.loopRequired)&&void 0!==i?i:1/0,loopEnum:null!==(a=e.loopEnum)&&void 0!==a?a:1/0,meta:null===(u=e.meta)||void 0===u||u,messages:null===(s=e.messages)||void 0===s||s,inlineRefs:null===(c=e.inlineRefs)||void 0===c||c,addUsedSchema:null===(l=e.addUsedSchema)||void 0===l||l,validateSchema:null===(h=e.validateSchema)||void 0===h||h,validateFormats:null===(p=e.validateFormats)||void 0===p||p}}var E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,t=this.opts=f(f({},t),x(t));var n=this.opts.code,r=n.es5,o=n.lines;this.scope=new b.ValueScope({scope:{},prefixes:O,es5:r,lines:o}),this.logger=I(t.logger);var i=t.validateFormats;t.validateFormats=!1,this.RULES=m.getRules(),C.call(this,P,t,"NOT SUPPORTED"),C.call(this,j,t,"DEPRECATED","warn"),this._metaOpts=M.call(this),t.formats&&A.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),t.keywords&&D.call(this,t.keywords),"object"==u(t.meta)&&this.addMetaSchema(t.meta),R.call(this),t.validateFormats=i}var t,n,o;return t=e,(n=[{key:"_addVocabularies",value:function(){this.addKeyword("$async")}},{key:"_addDefaultMetaSchema",value:function(){var e=this.opts,t=e.$data;e.meta&&t&&this.addMetaSchema(k,k.$id,!1)}},{key:"defaultMeta",value:function(){var e=this.opts.meta;return this.opts.defaultMeta="object"==u(e)?e.$id||e:void 0}},{key:"validate",value:function(e,t){var n;if("string"==typeof e){if(!(n=this.getSchema(e)))throw new Error('no schema with key or ref "'.concat(e,'"'))}else n=this.compile(e);var r=n(t);return"$async"in n||(this.errors=n.errors),r}},{key:"compile",value:function(e,t){var n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}},{key:"compileAsync",value:function(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");var n=this.opts.loadSchema;return r.call(this,e,t);function r(e,t){return o.apply(this,arguments)}function o(){return(o=a(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.call(this,t.$schema);case 2:return r=this._addSchema(t,n),e.abrupt("return",r.validate||s.call(this,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function i(e){return u.apply(this,arguments)}function u(){return(u=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||this.getSchema(t)){e.next=3;break}return e.next=3,r.call(this,{$ref:t},!0);case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function s(e){return c.apply(this,arguments)}function c(){return(c=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this._compileSchemaEnv(t));case 4:if(e.prev=4,e.t0=e.catch(0),e.t0 instanceof y.MissingRefError){e.next=8;break}throw e.t0;case 8:return l.call(this,e.t0),e.next=11,f.call(this,e.t0.missingSchema);case 11:return e.abrupt("return",s.call(this,t));case 12:case"end":return e.stop()}}),e,this,[[0,4]])})))).apply(this,arguments)}function l(e){var t=e.missingSchema,n=e.missingRef;if(this.refs[t])throw new Error("AnySchema ".concat(t," is loaded but ").concat(n," cannot be resolved"))}function f(e){return h.apply(this,arguments)}function h(){return(h=a(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.call(this,n);case 2:if(r=e.sent,this.refs[n]){e.next=6;break}return e.next=6,i.call(this,r.$schema);case 6:this.refs[n]||this.addSchema(r,n,t);case 7:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function p(e){return d.apply(this,arguments)}function d(){return(d=a(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._loading[t])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,this._loading[t]=n(t);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,delete this._loading[t],e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[3,,7,10]])})))).apply(this,arguments)}}},{key:"addSchema",value:function(e,t,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema;if(Array.isArray(e)){var a,s=r(e);try{for(s.s();!(a=s.n()).done;){var c=a.value;this.addSchema(c,void 0,n,i)}}catch(e){s.e(e)}finally{s.f()}return this}if("object"===u(e)&&void 0!==(o=e.$id)&&"string"!=typeof o)throw new Error("schema id must be string");return t=_.normalizeId(t||o),this._checkUnique(t),this.schemas[t]=this._addSchema(e,n,i,!0),this}},{key:"addMetaSchema",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.validateSchema;return this.addSchema(e,t,!0,n),this}},{key:"validateSchema",value:function(e,t){if("boolean"==typeof e)return!0;var n;if(void 0!==(n=e.$schema)&&"string"!=typeof n)throw new Error("$schema must be a string");if(!(n=n||this.opts.defaultMeta||this.defaultMeta()))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this.validate(n,e);if(!r&&t){var o="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(o);this.logger.error(o)}return r}},{key:"getSchema",value:function(e){for(var t;"string"==typeof(t=T.call(this,e));)e=t;if(void 0===t){var n=new v.SchemaEnv({schema:{}});if(!(t=v.resolveSchema.call(this,n,e)))return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}},{key:"removeSchema",value:function(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(u(e)){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":var t=T.call(this,e);return"object"==u(t)&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this;case"object":var n=e;this._cache.delete(n);var r=e.$id;return r&&(r=_.normalizeId(r),delete this.schemas[r],delete this.refs[r]),this;default:throw new Error("ajv.removeSchema: invalid parameter")}}},{key:"addVocabulary",value:function(e){var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;this.addKeyword(o)}}catch(e){n.e(e)}finally{n.f()}return this}},{key:"addKeyword",value:function(e,t){var n,r=this;if("string"==typeof e)n=e,"object"==u(t)&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=n);else{if("object"!=u(e)||void 0!==t)throw new Error("invalid addKeywords parameters");if(n=(t=e).keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if($.call(this,n,t),!t)return w.eachItem(n,(function(e){return V.call(r,e)})),this;B.call(this,t);var o=f(f({},t),{},{type:g.getJSONTypes(t.type),schemaType:g.getJSONTypes(t.schemaType)});return w.eachItem(n,0===o.type.length?function(e){return V.call(r,e,o)}:function(e){return o.type.forEach((function(t){return V.call(r,e,o,t)}))}),this}},{key:"getKeyword",value:function(e){var t=this.RULES.all[e];return"object"==u(t)?t.definition:!!t}},{key:"removeKeyword",value:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e];var n,o=r(t.rules);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=i.rules.findIndex((function(t){return t.keyword===e}));a>=0&&i.rules.splice(a,1)}}catch(e){o.e(e)}finally{o.f()}return this}},{key:"addFormat",value:function(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}},{key:"errorsText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.errors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.separator,r=void 0===n?", ":n,o=t.dataVar,i=void 0===o?"data":o;return e&&0!==e.length?e.map((function(e){return"".concat(i).concat(e.dataPath," ").concat(e.message)})).reduce((function(e,t){return e+r+t})):"No errors"}},{key:"$dataMetaSchema",value:function(e,t){var n=this.RULES.all;e=JSON.parse(JSON.stringify(e));var o,i=r(t);try{for(i.s();!(o=i.n()).done;){var a,s=o.value.split("/").slice(1),c=e,l=r(s);try{for(l.s();!(a=l.n()).done;)c=c[a.value]}catch(e){l.e(e)}finally{l.f()}for(var f in n){var h=n[f];if("object"==u(h)){var p=h.definition.$data,d=c[f];p&&d&&(c[f]=F(d))}}}}catch(e){i.e(e)}finally{i.f()}return e}},{key:"_removeAllSchemas",value:function(e,t){for(var n in e){var r=e[n];t&&!t.test(n)||("string"==typeof r?delete e[n]:r&&!r.meta&&(this._cache.delete(r.schema),delete e[n]))}}},{key:"_addSchema",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.validateSchema,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.addUsedSchema;if("object"!=u(e)&&"boolean"!=typeof e)throw new Error("schema must be object or boolean");var o=this._cache.get(e);if(void 0!==o)return o;var i=_.getSchemaRefs.call(this,e);o=new v.SchemaEnv({schema:e,meta:t,localRefs:i}),this._cache.set(o.schema,o);var a=o.baseId;return r&&!a.startsWith("#")&&(a&&this._checkUnique(a),this.refs[a]=o),n&&this.validateSchema(e,!0),o}},{key:"_checkUnique",value:function(e){if(this.schemas[e]||this.refs[e])throw new Error('schema with key or id "'.concat(e,'" already exists'))}},{key:"_compileSchemaEnv",value:function(e){if(e.meta?this._compileMetaSchema(e):v.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}},{key:"_compileMetaSchema",value:function(e){var t=this.opts;this.opts=this._metaOpts;try{v.compileSchema.call(this,e)}finally{this.opts=t}}}])&&c(t.prototype,n),o&&c(t,o),e}();function C(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"error";for(var o in e){var i=o;i in t&&this.logger[r]("".concat(n,": option ").concat(o,". ").concat(e[i]))}}function T(e){return e=_.normalizeId(e),this.schemas[e]||this.refs[e]}function R(){var e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(var t in e)this.addSchema(e[t],t)}function A(){for(var e in this.opts.formats){var t=this.opts.formats[e];t&&this.addFormat(e,t)}}function D(e){if(Array.isArray(e))this.addVocabulary(e);else for(var t in this.logger.warn("keywords option as map is deprecated, pass array"),e){var n=e[t];n.keyword||(n.keyword=t),this.addKeyword(n)}}function M(){var e,t=f({},this.opts),n=r(S);try{for(n.s();!(e=n.n()).done;){delete t[e.value]}}catch(e){n.e(e)}finally{n.f()}return t}t.default=E,E.ValidationError=y.ValidationError,E.MissingRefError=y.MissingRefError;var N={log:function(){},warn:function(){},error:function(){}};function I(e){if(!1===e)return N;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}var L=/^[a-z_$][a-z0-9_$-]*$/i;function $(e,t){var n=this.RULES;if(w.eachItem(e,(function(e){if(n.keywords[e])throw new Error("Keyword ".concat(e," is already defined"));if(!L.test(e))throw new Error("Keyword ".concat(e," has invalid name"))})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function V(e,t,n){var r,o=this,i=null==t?void 0:t.post;if(n&&i)throw new Error('keyword with "post" flag cannot have "type"');var a=this.RULES,u=i?a.post:a.rules.find((function(e){return e.type===n}));if(u||(u={type:n,rules:[]},a.rules.push(u)),a.keywords[e]=!0,t){var s={keyword:e,definition:f(f({},t),{},{type:g.getJSONTypes(t.type),schemaType:g.getJSONTypes(t.schemaType)})};t.before?z.call(this,u,s,t.before):u.rules.push(s),a.all[e]=s,null===(r=t.implements)||void 0===r||r.forEach((function(e){return o.addKeyword(e)}))}}function z(e,t,n){var r=e.rules.findIndex((function(e){return e.keyword===n}));r>=0?e.rules.splice(r,0,t):(e.rules.push(t),this.logger.warn("rule ".concat(n," is not defined")))}function B(e){var t=e.metaSchema;void 0!==t&&(e.$data&&this.opts.$data&&(t=F(t)),e.validateSchema=this.compile(t,!0))}var U={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function F(e){return{anyOf:[e,U]}}},function(e){e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=n(48),i=n(60),a=n(74),u=n(76),s=[r.default,o.default,i.default,a.default,u.metadataVocabulary,u.contentVocabulary];t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=n(47),i=["$schema","$id","$defs","$vocabulary","definitions",r.default,o.default];t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={keyword:"id",code:function(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=r},function(e,t,n){"use strict";function r(){var e=h(["",".evaluated.items"]);return r=function(){return e},e}function o(){var e=h(["",".evaluated.props"]);return o=function(){return e},e}function i(){var e=h(["",".length"]);return i=function(){return e},e}function a(){var e=h([""," === null ? "," : ",".concat(",")"]);return a=function(){return e},e}function u(){var e=h(["",".errors"]);return u=function(){return e},e}function s(){var e=h(["!("," instanceof ",")"]);return s=function(){return e},e}function c(){var e=h(["await ",""]);return c=function(){return e},e}function l(){var e=h(["",".validate"]);return l=function(){return e},e}function f(){var e=h(["",".validate"]);return f=function(){return e},e}function h(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;var p=n(18),d=n(7),y=n(1),m=n(6),v=n(23),b=n(3),_={keyword:"$ref",schemaType:"string",code:function(e){var t=e.gen,n=e.schema,r=e.it,o=r.baseId,i=r.schemaEnv,a=r.validateName,u=r.opts,s=r.self;if("#"===n||"#/"===n)return function(){if(i===i.root)return w(e,a,i,i.$async);var n=t.scopeValue("root",{ref:i.root});return w(e,y._(f(),n),i.root,i.root.$async)}();var c,l,h=v.resolveRef.call(s,i.root,o,n);if(void 0===h)throw new p.MissingRefError(o,n);return h instanceof v.SchemaEnv?(l=g(e,c=h),void w(e,l,c,c.$async)):function(r){var o=t.scopeValue("schema",!0===u.code.source?{ref:r,code:y.stringify(r)}:{ref:r}),i=t.name("valid"),a=e.subschema({schema:r,strictSchema:!0,dataTypes:[],schemaPath:y.nil,topSchemaRef:o,errSchemaPath:n},i);e.mergeEvaluated(a),e.ok(i)}(h)}};function g(e,t){var n=e.gen;return t.validate?n.scopeValue("validate",{ref:t.validate}):y._(l(),n.scopeValue("wrapper",{ref:t}))}function w(e,t,n,l){var f=e.gen,h=e.it,p=h.allErrors,v=h.schemaEnv,_=h.opts.passContext?m.default.this:y.nil;function g(e){var t=y._(u(),e);f.assign(m.default.vErrors,y._(a(),m.default.vErrors,t,m.default.vErrors,t)),f.assign(m.default.errors,y._(i(),m.default.vErrors))}function w(e){var t;if(h.opts.unevaluated){var i=null===(t=null==n?void 0:n.validate)||void 0===t?void 0:t.evaluated;if(!0!==h.props)if(i&&!i.dynamicProps)void 0!==i.props&&(h.props=b.mergeEvaluated.props(f,i.props,h.props));else{var a=f.var("props",y._(o(),e));h.props=b.mergeEvaluated.props(f,a,h.props,y.Name)}if(!0!==h.items)if(i&&!i.dynamicItems)void 0!==i.items&&(h.items=b.mergeEvaluated.items(f,i.items,h.items));else{var u=f.var("items",y._(r(),e));h.items=b.mergeEvaluated.items(f,u,h.items,y.Name)}}}l?function(){if(!v.$async)throw new Error("async schema referenced by sync schema");var n=f.let("valid");f.try((function(){f.code(y._(c(),d.callValidateCode(e,t,_))),w(t),p||f.assign(n,!0)}),(function(e){f.if(y._(s(),e,h.ValidationError),(function(){return f.throw(e)})),g(e),p||f.assign(n,!1)})),e.ok(n)}():e.result(d.callValidateCode(e,t,_),(function(){return w(t)}),(function(){return g(t)}))}t.getValidate=g,t.callRef=w,t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(50),i=n(51),a=n(53),u=n(54),s=n(55),c=n(56),l=n(57),f=n(58),h=n(59),p=[r.default,o.default,i.default,a.default,u.default,s.default,c.default,l.default,{keyword:"nullable",schemaType:"boolean"},f.default,h.default];t.default=p},function(e,t,n){"use strict";function r(){var e=a([""," "," "," || isNaN(",")"]);return r=function(){return e},e}function o(){var e=a(["{comparison: ",", limit: ","}"]);return o=function(){return e},e}function i(){var e=a(["should be "," ",""]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s=u.operators,c={maximum:{okStr:"<=",ok:s.LTE,fail:s.GT},minimum:{okStr:">=",ok:s.GTE,fail:s.LT},exclusiveMaximum:{okStr:"<",ok:s.LT,fail:s.GTE},exclusiveMinimum:{okStr:">",ok:s.GT,fail:s.LTE}},l={message:function(e){var t=e.keyword,n=e.schemaCode;return u.str(i(),c[t].okStr,n)},params:function(e){var t=e.keyword,n=e.schemaCode;return u._(o(),c[t].okStr,n)}},f={keyword:Object.keys(c),type:"number",schemaType:"number",$data:!0,error:l,code:function(e){var t=e.keyword,n=e.data,o=e.schemaCode;e.fail$data(u._(r(),n,c[t].fail,o,n))}};t.default=f},function(e,t,n){"use strict";function r(){var e=s(["("," === 0 || ("," = ","/",", ","))"]);return r=function(){return e},e}function o(){var e=s([""," !== parseInt(",")"]);return o=function(){return e},e}function i(){var e=s(["Math.abs(Math.round(",") - ",") > 1e-",""]);return i=function(){return e},e}function a(){var e=s(["{multipleOf: ","}"]);return a=function(){return e},e}function u(){var e=s(["should be multiple of ",""]);return u=function(){return e},e}function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),l={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:function(e){var t=e.schemaCode;return c.str(u(),t)},params:function(e){var t=e.schemaCode;return c._(a(),t)}},code:function(e){var t=e.gen,n=e.data,a=e.schemaCode,u=e.it.opts.multipleOfPrecision,s=t.let("res"),l=u?c._(i(),s,s,u):c._(o(),s,s);e.fail$data(c._(r(),a,s,n,a,l))}};t.default=l},function(e,t,n){"use strict";function r(){var e=c([""," "," ",""]);return r=function(){return e},e}function o(){var e=c(["","(",")"]);return o=function(){return e},e}function i(){var e=c(['require("ajv/dist/compile/ucs2length").default']);return i=function(){return e},e}function a(){var e=c(["",".length"]);return a=function(){return e},e}function u(){var e=c(["{limit: ","}"]);return u=function(){return e},e}function s(){var e=c(["should NOT have "," than "," characters"]);return s=function(){return e},e}function c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),f=n(52),h={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:function(e){var t=e.keyword,n=e.schemaCode,r="maxLength"===t?"more":"fewer";return l.str(s(),r,n)},params:function(e){var t=e.schemaCode;return l._(u(),t)}},code:function(e){var t,n=e.keyword,u=e.data,s=e.schemaCode,c=e.it,h="maxLength"===n?l.operators.GT:l.operators.LT;if(!1===c.opts.unicode)t=l._(a(),u);else{var p=e.gen.scopeValue("func",{ref:f.default,code:l._(i())});t=l._(o(),p,u)}e.fail$data(l._(r(),t,h,s))}};t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=e.length,r=0,o=0;o<n;)r++,(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<n&&56320==(64512&(t=e.charCodeAt(o)))&&o++;return r}},function(e,t,n){"use strict";function r(){var e=u(["!",".test(",")"]);return r=function(){return e},e}function o(){var e=u(["(new RegExp(",', "u"))']);return o=function(){return e},e}function i(){var e=u(["{pattern: ","}"]);return i=function(){return e},e}function a(){var e=u(['should match pattern "','"']);return a=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),c=n(1),l={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:function(e){var t=e.schemaCode;return c.str(a(),t)},params:function(e){var t=e.schemaCode;return c._(i(),t)}},code:function(e){var t=e.gen,n=e.data,i=e.$data,a=e.schema,u=e.schemaCode,l=i?c._(o(),u):s.usePattern(t,a);e.fail$data(c._(r(),l,n))}};t.default=l},function(e,t,n){"use strict";function r(){var e=a(["Object.keys(",").length "," ",""]);return r=function(){return e},e}function o(){var e=a(["{limit: ","}"]);return o=function(){return e},e}function i(){var e=a(["should NOT have "," than "," items"]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:function(e){var t=e.keyword,n=e.schemaCode,r="maxProperties"===t?"more":"fewer";return u.str(i(),r,n)},params:function(e){var t=e.schemaCode;return u._(o(),t)}},code:function(e){var t=e.keyword,n=e.data,o=e.schemaCode,i="maxProperties"===t?u.operators.GT:u.operators.LT;e.fail$data(u._(r(),n,i,o))}};t.default=s},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e=u(["{missingProperty: ","}"]);return i=function(){return e},e}function a(){var e=u(["should have required property '","'"]);return a=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),c=n(1),l={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:function(e){var t=e.params.missingProperty;return c.str(a(),t)},params:function(e){var t=e.params.missingProperty;return c._(i(),t)}},code:function(e){var t=e.gen,n=e.schema,o=e.schemaCode,i=e.data,a=e.$data,u=e.it,l=u.opts;if(a||0!==n.length){var f=n.length>=l.loopRequired;u.allErrors?function(){if(f||a)e.block$data(c.nil,h);else{var t,o=r(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;s.checkReportMissingProp(e,i)}}catch(e){o.e(e)}finally{o.f()}}}():function(){var r=t.let("missing");if(f||a){var u=t.let("valid",!0);e.block$data(u,(function(){return function(n,r){e.setParams({missingProperty:n}),t.forOf(n,o,(function(){t.assign(r,s.propertyInData(i,n,l.ownProperties)),t.if(c.not(r),(function(){e.error(),t.break()}))}),c.nil)}(r,u)})),e.ok(u)}else t.if(s.checkMissingProp(e,n,r)),s.reportMissingProp(e,r),t.else()}()}function h(){t.forOf("prop",o,(function(n){e.setParams({missingProperty:n}),t.if(s.noPropertyInData(i,n,l.ownProperties),(function(){return e.error()}))}))}}};t.default=l},function(e,t,n){"use strict";function r(){var e=a(["",".length "," ",""]);return r=function(){return e},e}function o(){var e=a(["{limit: ","}"]);return o=function(){return e},e}function i(){var e=a(["should NOT have "," than "," items"]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:function(e){var t=e.keyword,n=e.schemaCode,r="maxItems"===t?"more":"fewer";return u.str(i(),r,n)},params:function(e){var t=e.schemaCode;return u._(o(),t)}},code:function(e){var t=e.keyword,n=e.data,o=e.schemaCode,i="maxItems"===t?u.operators.GT:u.operators.LT;e.fail$data(u._(r(),n,i,o))}};t.default=s},function(e,t,n){"use strict";function r(){var e=w(["","(","[","], ","[","])"]);return r=function(){return e},e}function o(){var e=w([""," = ","; ","--;"]);return o=function(){return e},e}function i(){var e=w([";","--;"]);return i=function(){return e},e}function a(){var e=w(['require("ajv/dist/compile/equal")']);return a=function(){return e},e}function u(){var e=w(["","[","] = ",""]);return u=function(){return e},e}function s(){var e=w(["","[","]"]);return s=function(){return e},e}function c(){var e=w(["typeof ","[",'] == "number"']);return c=function(){return e},e}function l(){var e=w(["",' += "_"']);return l=function(){return e},e}function f(){var e=w(["typeof ",' == "string"']);return f=function(){return e},e}function h(){var e=w(["continue"]);return h=function(){return e},e}function p(){var e=w(["","[","]"]);return p=function(){return e},e}function d(){var e=w([";","--;"]);return d=function(){return e},e}function y(){var e=w(["{}"]);return y=function(){return e},e}function m(){var e=w([""," > 1"]);return m=function(){return e},e}function v(){var e=w(["",".length"]);return v=function(){return e},e}function b(){var e=w([""," === false"]);return b=function(){return e},e}function _(){var e=w(["{i: ",", j: ","}"]);return _=function(){return e},e}function g(){var e=w(["should NOT have duplicate items (items ## "," and "," are identical)"]);return g=function(){return e},e}function w(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var k=n(11),S=n(1),O=n(16),P={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:function(e){var t=e.params,n=t.i,r=t.j;return S.str(g(),r,n)},params:function(e){var t=e.params,n=t.i,r=t.j;return S._(_(),n,r)}},code:function(e){var t=e.gen,n=e.data,_=e.$data,g=e.schema,w=e.parentSchema,P=e.schemaCode,j=e.it;if(_||g){var x=t.let("valid"),E=w.items?k.getSchemaTypes(w.items):[];e.block$data(x,(function(){var r=t.let("i",S._(v(),n)),o=t.let("j");e.setParams({i:r,j:o}),t.assign(x,!0),t.if(S._(m(),r),(function(){return(E.length>0&&!E.some((function(e){return"object"===e||"array"===e}))?C:T)(r,o)}))}),S._(b(),P)),e.ok(x)}function C(r,o){var i=t.name("item"),a=k.checkDataTypes(E,i,j.opts.strict,k.DataType.Wrong),m=t.const("indices",S._(y()));t.for(S._(d(),r),(function(){t.let(i,S._(p(),n,r)),t.if(a,S._(h())),E.length>1&&t.if(S._(f(),i),S._(l(),i)),t.if(S._(c(),m,i),(function(){t.assign(o,S._(s(),m,i)),e.error(),t.assign(x,!1).break()})).code(S._(u(),m,i,r))}))}function T(u,s){var c=e.gen.scopeValue("func",{ref:O,code:S._(a())}),l=t.name("outer");t.label(l).for(S._(i(),u),(function(){return t.for(S._(o(),s,u,s),(function(){return t.if(S._(r(),c,n,u,n,s),(function(){e.error(),t.assign(x,!1).break(l)}))}))}))}}};t.default=P},function(e,t,n){"use strict";function r(){var e=a(["!","(",", ",")"]);return r=function(){return e},e}function o(){var e=a(['require("ajv/dist/compile/equal")']);return o=function(){return e},e}function i(){var e=a(["{allowedValue: ","}"]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s=n(16),c={keyword:"const",$data:!0,error:{message:"should be equal to constant",params:function(e){var t=e.schemaCode;return u._(i(),t)}},code:function(e){var t=e.gen.scopeValue("func",{ref:s,code:u._(o())});e.fail$data(u._(r(),t,e.data,e.schemaCode))}};t.default=c},function(e,t,n){"use strict";function r(){var e=f([""," === ",""]);return r=function(){return e},e}function o(){var e=f(["","(",", ","[","])"]);return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(){var e=f(["","(",", ",")"]);return a=function(){return e},e}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){var e=f(['require("ajv/dist/compile/equal")']);return c=function(){return e},e}function l(){var e=f(["{allowedValues: ","}"]);return l=function(){return e},e}function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var h=n(1),p=n(16),d={keyword:"enum",schemaType:"array",$data:!0,error:{message:"should be equal to one of the allowed values",params:function(e){var t=e.schemaCode;return h._(l(),t)}},code:function(e){var t=e.gen,n=e.data,s=e.$data,l=e.schema,f=e.schemaCode,d=e.it;if(!s&&0===l.length)throw new Error("enum must have non-empty array");var y,m=l.length>=d.opts.loopEnum,v=e.gen.scopeValue("func",{ref:p,code:h._(c())});if(m||s)y=t.let("valid"),e.block$data(y,(function(){t.assign(y,!1),t.forOf("v",f,(function(e){return t.if(h._(a(),v,n,e),(function(){return t.assign(y,!0).break()}))}))}));else{if(!Array.isArray(l))throw new Error("ajv implementation error");var b=t.const("vSchema",f);y=h.or.apply(h,u(l.map((function(e,t){return function(e,t){var a=l[t];return a&&"object"===i(a)?h._(o(),v,n,e,t):h._(r(),n,a)}(b,t)}))))}e.pass(y)}};t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(61),o=n(62),i=n(63),a=n(64),u=n(65),s=n(24),c=n(66),l=n(67),f=n(68),h=n(69),p=n(70),d=n(71),y=n(72),m=n(73),v=[f.default,h.default,p.default,d.default,y.default,m.default,r.default,o.default,i.default,u.default,s.default,a.default,c.default,l.default];t.default=v},function(e,t,n){"use strict";function r(){var e=c([""," <= ",""]);return r=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){var e=c([""," <= ",""]);return i=function(){return e},e}function a(){var e=c(["",".length"]);return a=function(){return e},e}function u(){var e=c(["{limit: ","}"]);return u=function(){return e},e}function s(){var e=c(["should NOT have more than "," items"]);return s=function(){return e},e}function c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),f=n(12),h=n(3),p=n(5),d={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:function(e){var t=e.params.len;return l.str(s(),t)},params:function(e){var t=e.params.len;return l._(u(),t)}},code:function(e){var t=e.gen,n=e.schema,u=e.parentSchema,s=e.data,c=e.it,d=u.items;if(Array.isArray(d)){c.items=!0;var y=t.const("len",l._(a(),s));if(!1===n)e.setParams({len:d.length}),e.pass(l._(i(),y,d.length));else if("object"==o(n)&&!h.alwaysValidSchema(c,n)){var m=t.var("valid",l._(r(),y,d.length));t.if(l.not(m),(function(){return function(n){t.forRange("i",d.length,y,(function(r){e.subschema({keyword:"additionalItems",dataProp:r,dataPropType:f.Type.Num},n),c.allErrors||t.if(l.not(n),(function(){return t.break()}))}))}(m)})),e.ok(m)}}else p.checkStrictMode(c,'"additionalItems" is ignored when "items" is not an array of schemas')}};t.default=d},function(e,t,n){"use strict";function r(){var e=i([""," > ",""]);return r=function(){return e},e}function o(){var e=i(["",".length"]);return o=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),u=n(12),s=n(3),c=n(5),l={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code:function(e){var t,n=e.gen,i=e.schema,l=e.parentSchema,f=e.data,h=e.it,p=n.const("len",a._(o(),f));Array.isArray(i)?(h.opts.unevaluated&&i.length&&!0!==h.items&&(h.items=s.mergeEvaluated.items(n,i.length,h.items)),function(t){if(h.opts.strictTuples&&!function(e,t){return e===t.minItems&&(e===t.maxItems||!1===t.additionalItems)}(i.length,l)){var o='"items" is '.concat(t.length,"-tuple, but minItems or maxItems/additionalItems are not specified or different");c.checkStrictMode(h,o,h.opts.strictTuples)}var u=n.name("valid");t.forEach((function(t,o){s.alwaysValidSchema(h,t)||(n.if(a._(r(),p,o),(function(){return e.subschema({keyword:"items",schemaProp:o,dataProp:o,strictSchema:h.strictSchema},u)})),e.ok(u))}))}(i)):(h.items=!0,s.alwaysValidSchema(h,i)||(t=n.name("valid"),n.forRange("i",0,p,(function(r){e.subschema({keyword:"items",dataProp:r,dataPropType:u.Type.Num,strictSchema:h.strictSchema},t),h.allErrors||n.if(a.not(t),(function(){return n.break()}))})),e.ok(t)))}};t.default=l},function(e,t,n){"use strict";function r(){var e=d([""," >= ",""]);return r=function(){return e},e}function o(){var e=d([""," > ",""]);return o=function(){return e},e}function i(){var e=d([""," >= ",""]);return i=function(){return e},e}function a(){var e=d(["","++"]);return a=function(){return e},e}function u(){var e=d([""," && "," <= ",""]);return u=function(){return e},e}function s(){var e=d([""," >= ",""]);return s=function(){return e},e}function c(){var e=d(["",".length"]);return c=function(){return e},e}function l(){var e=d(["{minContains: ",", maxContains: ","}"]);return l=function(){return e},e}function f(){var e=d(["{minContains: ","}"]);return f=function(){return e},e}function h(){var e=d(["should contain at least "," and no more than "," valid item(s)"]);return h=function(){return e},e}function p(){var e=d(["should contain at least "," valid item(s)"]);return p=function(){return e},e}function d(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var y=n(1),m=n(12),v=n(3),b=n(5),_={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:function(e){var t=e.params,n=t.min,r=t.max;return void 0===r?y.str(p(),n):y.str(h(),n,r)},params:function(e){var t=e.params,n=t.min,r=t.max;return void 0===r?y._(f(),n):y._(l(),n,r)}},code:function(e){var t,n,l=e.gen,f=e.schema,h=e.parentSchema,p=e.data,d=e.it,_=h.minContains,g=h.maxContains;d.opts.next?(t=void 0===_?1:_,n=g):t=1;var w=l.const("len",y._(c(),p));if(e.setParams({min:t,max:n}),void 0!==n||0!==t){if(void 0!==n&&t>n)return b.checkStrictMode(d,'"minContains" > "maxContains" is always invalid'),void e.fail();if(v.alwaysValidSchema(d,f)){var k=y._(s(),w,t);return void 0!==n&&(k=y._(u(),k,w,n)),void e.pass(k)}d.items=!0;var S=l.name("valid");if(void 0===n&&1===t)j(S,(function(){return l.if(S,(function(){return l.break()}))}));else{l.let(S,!1);var O=l.name("_valid"),P=l.let("count",0);j(O,(function(){return l.if(O,(function(){return function(e){l.code(y._(a(),e)),void 0===n?l.if(y._(i(),e,t),(function(){return l.assign(S,!0).break()})):(l.if(y._(o(),e,n),(function(){return l.assign(S,!1).break()})),1===t?l.assign(S,!0):l.if(y._(r(),e,t),(function(){return l.assign(S,!0)})))}(P)}))}))}e.result(S,(function(){return e.reset()}))}else b.checkStrictMode(d,'"minContains" == 0 without "maxContains": "contains" keyword ignored');function j(t,n){l.forRange("i",0,w,(function(r){e.subschema({keyword:"contains",dataProp:r,dataPropType:m.Type.Num,compositeRule:!0},t),n()}))}}};t.default=_},function(e,t,n){"use strict";function r(){var e=l([""," && (",")"]);return r=function(){return e},e}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw i}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(){var e=l(["{property: ",",\n    missingProperty: ",",\n    depsCount: ",",\n    deps: ","}"]);return s=function(){return e},e}function c(){var e=l(["should have "," "," when property "," is present"]);return c=function(){return e},e}function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;var f=n(1),h=n(3),p=n(7);t.error={message:function(e){var t=e.params,n=t.property,r=t.depsCount,o=t.deps,i=1===r?"property":"properties";return f.str(c(),i,o,n)},params:function(e){var t=e.params,n=t.property,r=t.depsCount,o=t.deps,i=t.missingProperty;return f._(s(),n,i,r,o)}};var d={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code:function(e){var t=i(function(e){var t=e.schema,n={},r={};for(var o in t){if("__proto__"!==o)(Array.isArray(t[o])?n:r)[o]=t[o]}return[n,r]}(e),2),n=t[0],r=t[1];y(e,n),m(e,r)}};function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,n=e.gen,i=e.data,a=e.it;if(0!==Object.keys(t).length){var u=n.let("missing"),s=function(s){var c=t[s];if(0===c.length)return"continue";var l=p.propertyInData(i,s,a.opts.ownProperties);e.setParams({property:s,depsCount:c.length,deps:c.join(", ")}),a.allErrors?n.if(l,(function(){var t,n=o(c);try{for(n.s();!(t=n.n()).done;){var r=t.value;p.checkReportMissingProp(e,r)}}catch(e){n.e(e)}finally{n.f()}})):(n.if(f._(r(),l,p.checkMissingProp(e,c,u))),p.reportMissingProp(e,u),n.else())};for(var c in t)s(c)}}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,n=e.gen,r=e.data,o=e.keyword,i=e.it,a=n.name("valid"),u=function(u){if(h.alwaysValidSchema(i,t[u]))return"continue";n.if(p.propertyInData(r,u,i.opts.ownProperties),(function(){var t=e.subschema({keyword:o,schemaProp:u},a);e.mergeValidEvaluated(t,a)}),(function(){return n.var(a,!0)})),e.ok(a)};for(var s in t)u(s)}t.validatePropertyDeps=y,t.validateSchemaDeps=m,t.default=d},function(e,t,n){"use strict";function r(){var e=i(["{propertyName: ","}"]);return r=function(){return e},e}function o(){var e=i(["property name '","' is invalid"]);return o=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),u=n(3),s={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:function(e){var t=e.params;return a.str(o(),t.propertyName)},params:function(e){var t=e.params;return a._(r(),t.propertyName)}},code:function(e){var t=e.gen,n=e.schema,r=e.data,o=e.it;if(!u.alwaysValidSchema(o,n)){var i=t.name("valid");t.forIn("key",r,(function(n){e.setParams({propertyName:n}),e.subschema({keyword:"propertyNames",data:n,dataTypes:["string"],propertyName:n,compositeRule:!0,strictSchema:o.strictSchema},i),t.if(a.not(i),(function(){e.error(!0),o.allErrors||t.break()}))})),e.ok(i)}}};t.default=s},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),a=n(7),u=n(3),s=n(24),c={keyword:"properties",type:"object",schemaType:"object",code:function(e){var t=e.gen,n=e.schema,o=e.parentSchema,c=e.data,l=e.it;"all"===l.opts.removeAdditional&&void 0===o.additionalProperties&&s.default.code(new i.default(l,s.default,"additionalProperties"));var f=a.allSchemaProperties(n);l.opts.unevaluated&&f.length&&!0!==l.props&&(l.props=u.mergeEvaluated.props(t,u.toHash(f),l.props));var h=f.filter((function(e){return!u.alwaysValidSchema(l,n[e])}));if(0!==h.length){var p,d=t.name("valid"),y=r(h);try{for(y.s();!(p=y.n()).done;){var m=p.value;v(m)?b(m):(t.if(a.propertyInData(c,m,l.opts.ownProperties)),b(m),l.allErrors||t.else().var(d,!0),t.endIf()),e.ok(d)}}catch(e){y.e(e)}finally{y.f()}}function v(e){return l.opts.useDefaults&&!l.compositeRule&&void 0!==n[e].default}function b(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t,strictSchema:l.strictSchema},d)}}};t.default=c},function(e,t,n){"use strict";function r(){var e=i(["","[","]"]);return r=function(){return e},e}function o(){var e=i(["",".test(",")"]);return o=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),c=n(1),l=n(12),f=n(5),h=n(3),p={keyword:"patternProperties",type:"object",schemaType:"object",code:function(e){var t=e.gen,n=e.schema,i=e.data,u=e.parentSchema,p=e.it,d=p.opts,y=s.schemaProperties(p,n);if(0!==y.length){var m=d.strict&&!d.allowMatchingProperties&&u.properties,v=t.name("valid");!0===p.props||p.props instanceof c.Name||(p.props=h.evaluatedPropsToName(t,p.props));var b=p.props;!function(){var e,n=a(y);try{for(n.s();!(e=n.n()).done;){var r=e.value;m&&_(r),p.allErrors?g(r):(t.var(v,!0),g(r),t.if(v))}}catch(e){n.e(e)}finally{n.f()}}()}function _(e){for(var t in m)new RegExp(e).test(t)&&f.checkStrictMode(p,"property ".concat(t," matches pattern ").concat(e," (use allowMatchingProperties)"))}function g(n){t.forIn("key",i,(function(i){t.if(c._(o(),s.usePattern(t,n),i),(function(){e.subschema({keyword:"patternProperties",schemaProp:n,dataProp:i,dataPropType:l.Type.Str,strictSchema:p.strictSchema},v),p.opts.unevaluated&&!0!==b?t.assign(c._(r(),b,i),!0):p.allErrors||t.if(c.not(v),(function(){return t.break()}))}))}))}}};t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code:function(e){var t=e.gen,n=e.schema,o=e.it;if(r.alwaysValidSchema(o,n))e.fail();else{var i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.result(i,(function(){return e.error()}),(function(){return e.reset()}))}},error:{message:"should NOT be valid"}};t.default=o},function(e,t,n){"use strict";function r(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([""," || ",""]);return r=function(){return e},e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(3),a={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:function(e){var t=e.gen,n=e.schema,a=e.it;if(!Array.isArray(n))throw new Error("ajv implementation error");if(!n.some((function(e){return i.alwaysValidSchema(a,e)}))||a.opts.unevaluated){var u=t.let("valid",!1),s=t.name("_valid");t.block((function(){return n.forEach((function(n,i){var a=e.subschema({keyword:"anyOf",schemaProp:i,compositeRule:!0},s);t.assign(u,o._(r(),u,s)),e.mergeValidEvaluated(a,s)||t.if(o.not(u))}))})),e.result(u,(function(){return e.reset()}),(function(){return e.error(!0)}))}},error:{message:"should match some schema in anyOf"}};t.default=a},function(e,t,n){"use strict";function r(){var e=a(["[",", ","]"]);return r=function(){return e},e}function o(){var e=a([""," && ",""]);return o=function(){return e},e}function i(){var e=a(["{passingSchemas: ","}"]);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s=n(3),c={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"should match exactly one schema in oneOf",params:function(e){var t=e.params;return u._(i(),t.passing)}},code:function(e){var t=e.gen,n=e.schema,i=e.it;if(!Array.isArray(n))throw new Error("ajv implementation error");var a=n,c=t.let("valid",!1),l=t.let("passing",null),f=t.name("_valid");e.setParams({passing:l}),t.block((function(){a.forEach((function(n,a){var h;s.alwaysValidSchema(i,n)?t.var(f,!0):h=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},f),a>0&&t.if(u._(o(),f,c)).assign(c,!1).assign(l,u._(r(),l,a)).else(),t.if(f,(function(){t.assign(c,!0),t.assign(l,a),h&&e.mergeEvaluated(h,u.Name)}))}))})),e.result(c,(function(){return e.reset()}),(function(){return e.error(!0)}))}};t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o={keyword:"allOf",schemaType:"array",code:function(e){var t=e.gen,n=e.schema,o=e.it;if(!Array.isArray(n))throw new Error("ajv implementation error");var i=t.name("valid");n.forEach((function(t,n){if(!r.alwaysValidSchema(o,t)){var a=e.subschema({keyword:"allOf",schemaProp:n},i);e.ok(i),e.mergeEvaluated(a)}}))}};t.default=o},function(e,t,n){"use strict";function r(){var e=a(["",""]);return r=function(){return e},e}function o(){var e=a(["{failingKeyword: ","}"]);return o=function(){return e},e}function i(){var e=a(['should match "','" schema']);return i=function(){return e},e}function a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s=n(3),c=n(5),l={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:function(e){var t=e.params;return u.str(i(),t.ifClause)},params:function(e){var t=e.params;return u._(o(),t.ifClause)}},code:function(e){var t=e.gen,n=e.parentSchema,o=e.it;void 0===n.then&&void 0===n.else&&c.checkStrictMode(o,'"if" without "then" and "else" is ignored');var i=f(o,"then"),a=f(o,"else");if(i||a){var s,l=t.let("valid",!0),h=t.name("_valid");if(s=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},h),e.mergeEvaluated(s),e.reset(),i&&a){var p=t.let("ifClause");e.setParams({ifClause:p}),t.if(h,d("then",p),d("else",p))}else i?t.if(h,d("then")):t.if(u.not(h),d("else"));e.pass(l,(function(){return e.error(!0)}))}function d(n,o){return function(){var i=e.subschema({keyword:n},h);t.assign(l,h),e.mergeValidEvaluated(i,l),o?t.assign(o,u._(r(),n)):e.setParams({ifClause:n})}}}};function f(e,t){var n=e.schema[t];return void 0!==n&&!s.alwaysValidSchema(e,n)}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o={keyword:["then","else"],schemaType:["object","boolean"],code:function(e){var t=e.keyword,n=e.parentSchema,o=e.it;void 0===n.if&&r.checkStrictMode(o,'"'.concat(t,'" without "if" is ignored'))}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[n(75).default];t.default=r},function(e,t,n){"use strict";function r(){var e=S(["",".test(",")"]);return r=function(){return e},e}function o(){var e=S(["","(",")"]);return o=function(){return e},e}function i(){var e=S(["await ","(",")"]);return i=function(){return e},e}function a(){var e=S(["",".validate"]);return a=function(){return e},e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){var e=S(["","",""]);return s=function(){return e},e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(){var e=S([""," && "," !== true && "," === "," && !",""]);return f=function(){return e},e}function h(){var e=S(["(typeof ",' == "function" ? '," : ",".test(","))"]);return h=function(){return e},e}function p(){var e=S(["","(",")"]);return p=function(){return e},e}function d(){var e=S(["(",".async ? await ","(",") : ","(","))"]);return d=function(){return e},e}function y(){var e=S([""," && !",""]);return y=function(){return e},e}function m(){var e=S(['"string"']);return m=function(){return e},e}function v(){var e=S(["",".validate"]);return v=function(){return e},e}function b(){var e=S(["",'.type || "string"']);return b=function(){return e},e}function _(){var e=S(["typeof ",' == "object" && !('," instanceof RegExp)"]);return _=function(){return e},e}function g(){var e=S(["","[","]"]);return g=function(){return e},e}function w(){var e=S(["{format: ","}"]);return w=function(){return e},e}function k(){var e=S(['should match format "','"']);return k=function(){return e},e}function S(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var O=n(1),P={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:function(e){var t=e.schemaCode;return O.str(k(),t)},params:function(e){var t=e.schemaCode;return O._(w(),t)}},code:function(e,t){var n,l,w,k,S,P,j=e.gen,x=e.data,E=e.$data,C=e.schema,T=e.schemaCode,R=e.it,A=R.opts,D=R.errSchemaPath,M=R.schemaEnv,N=R.self;A.validateFormats&&(E?(n=j.scopeValue("formats",{ref:N.formats,code:A.code.formats}),l=j.const("fDef",O._(g(),n,T)),w=j.let("fType"),k=j.let("format"),j.if(O._(_(),l,l),(function(){return j.assign(w,O._(b(),l)).assign(k,O._(v(),l))}),(function(){return j.assign(w,O._(m())).assign(k,l)})),e.fail$data(O.or(!1===A.strict?O.nil:O._(y(),T,k),(S=M.$async?O._(d(),l,k,x,k,x):O._(p(),k,x),P=O._(h(),k,S,k,x),O._(f(),k,k,w,t,P))))):function(){var n=N.formats[C];if(!n)return void function(){if(!1===A.strict)return void N.logger.warn(e());throw new Error(e());function e(){return'unknown format "'.concat(C,'" ignored in schema at path "').concat(D,'"')}}();if(!0===n)return;var l=c(function(e){var t=j.scopeValue("formats",{key:C,ref:e,code:A.code.formats?O._(s(),A.code.formats,O.getProperty(C)):void 0});if("object"==u(e)&&!(e instanceof RegExp))return[e.type||"string",e.validate,O._(a(),t)];return["string",e,t]}(n),3),f=l[0],h=l[1],p=l[2];f===t&&e.pass(function(){if("object"==u(n)&&!(n instanceof RegExp)&&n.async){if(!M.$async)throw new Error("async format in sync schema");return O._(i(),p,x)}return"function"==typeof h?O._(o(),p,x):O._(r(),p,x)}())}())}};t.default=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},function(e,t,n){"use strict";n.r(t);var r=n(9),o=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){for(;e>180;)e-=360;for(;e<-180;)e+=360;return e}var s=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!=i(t))throw"AI definition must be an object";this._id=n,this._name=t.name,this._team=null,this._maxEnergy=100,this._energy=this._maxEnergy,this._x=0,this._y=0,this._lastX=0,this._lastY=0,this._angle=0,this._gunAngle=0,this._radarAngle=0,this._throttle=0,this._actualThrottle=0,this._speed=0,this._turn=0,this._gunTurn=0,this._radarTurn=0,this._wallHit=!1,this._enemyHit=!1,this._allyHit=!1,this._beingRammed=!1,this._radarRange=300,this._radarFocal=6,this._enemySpot=null,this._allySpot=null,this._bulletsSpot=[],this._gunReloadTime=70,this._gunTimer=0,this._shootingPower=0,this._targetingAlarmTimer=0,this._debugData={},this._score=0,this._state=null,this._hasBoost=!1,this._maxBoost=400,this._boost=this._maxBoost,this._wallDistance=null,this._skin="zebra"}var t,n,r;return t=e,(n=[{key:"onEnemyHitScore",value:function(e){this._score+=e}},{key:"onEnemyKillScore",value:function(){this._score+=20}},{key:"onSurviveScore",value:function(){this._score+=10}},{key:"setThrottle",value:function(e){this._throttle=Math.min(1,Math.max(-1,e))}},{key:"setTurn",value:function(e){this._turn=Math.min(1,Math.max(-1,e))}},{key:"setGunTurn",value:function(e){this._gunTurn=Math.min(1,Math.max(-1,e))}},{key:"setRadarTurn",value:function(e){this._radarTurn=Math.min(1,Math.max(-1,e))}},{key:"setBoost",value:function(e){this._hasBoost=!!e}},{key:"setDebugData",value:function(e){this._debugData=e}},{key:"onWallHit",value:function(){this._wallHit=!0,this.onDamage(.2)}},{key:"onEnemyHit",value:function(){this._enemyHit=!0,this.onDamage(.2)}},{key:"onAllyHit",value:function(){this._allyHit=!0,this.onDamage(.2)}},{key:"onBeingRam",value:function(e){this._beingRammed=!0,this.onDamage(.1+.1*Math.round(4*e))}},{key:"onEnemySpot",value:function(e){this._enemySpot=e}},{key:"onAllySpot",value:function(e){this._allySpot=e}},{key:"onBulletSpot",value:function(e){this._bulletsSpot.push(e)}},{key:"onWallSpot",value:function(e){this._wallDistance=e}},{key:"onTargetingAlarm",value:function(){this._targetingAlarmTimer=3}},{key:"isAlly",value:function(e){return!!this._team&&!!e.team&&this._team.name==e.team.name}},{key:"onDamage",value:function(e){this._energy=Math.max(0,this._energy-e)}},{key:"moveTo",value:function(e,t,n){this._x=e,this._y=t,this._lastX=e,this._lastY=t,void 0!==n&&(this._angle=n)}},{key:"handleShoot",value:function(){var e=this._shootingPower;return this._shootingPower=0,e}},{key:"shoot",value:function(e){e=Math.max(.1,Math.min(1,e)),this.isReloading||(this._gunTimer=Math.round(e*this._gunReloadTime),this._shootingPower=e)}},{key:"randomize",value:function(e){void 0===e&&(e=(new Date).getTime()+Math.round(1e6*Math.random()));var t=o()(e);this._angle=Math.round(360*t())-180}},{key:"init",value:function(e){e&&e.SKIN&&(this._skin=e.SKIN)}},{key:"simulationStep",value:function(e){if(0!=this._energy){this._hasBoost&&this._boost>0&&this._boost--;var t=this._x,n=this._y,r=this._throttle*(this.hasBoost?4:2),o=this.hasBoost?10:20;this._actualThrottle+=(r-this._actualThrottle)/o;var i=this._actualThrottle,a=this._angle*(Math.PI/180);this._x+=i*Math.cos(a),this._y+=i*Math.sin(a),this._wallHit=!1,this._enemyHit=!1,this._allyHit=!1,!e.checkTank(this)&&(this._x=t,this._y=n,this._actualThrottle=0),this._beingRammed&&(this._enemyHit=!0,this._beingRammed=!1),this._angle+=2*this._turn,this._radarAngle+=6*this._radarTurn,this._gunAngle+=3*this._gunTurn,this._angle=u(this._angle),this._radarAngle=u(this._radarAngle),this._gunAngle=u(this._gunAngle),e.updateTank(this),this._enemySpot=null,this._allySpot=null,this._wallDistance=null,this._targetingAlarmTimer=Math.max(0,this._targetingAlarmTimer-1),e.scanTanks(this),e.scanBullets(this),e.scanWalls(this),this._gunTimer>0&&this._gunTimer--;for(var s=null,c=null,l=[];this._bulletsSpot.length;){var f=this._bulletsSpot.shift();l.push({id:f.id,x:f.x,y:f.y,angle:f.angle,speed:f.speed,damage:f.damage})}this._enemySpot&&(s={id:this._enemySpot.id,x:this._enemySpot.x,y:this._enemySpot.y,angle:this._enemySpot.angle,speed:this._enemySpot.speed*(this._enemySpot.throttle<0?-1:1),energy:this._enemySpot.energy}),this._allySpot&&(c={id:this._allySpot.id,x:this._allySpot.x,y:this._allySpot.y,angle:this._allySpot.angle,speed:this._allySpot.speed,energy:this._allySpot.energy});var h=this._x-this._lastX,p=this._y-this._lastY;this._speed=Math.sqrt(h*h+p*p),this._lastX=this._x,this._lastY=this._y,this._state={x:this._x,y:this._y,angle:this._angle,energy:this._energy,boost:this._boost,collisions:{wall:this._wallHit,enemy:this._enemyHit,ally:this._allyHit},radar:{angle:this._radarAngle,targetingAlarm:this.targetingAlarm,wallDistance:this._wallDistance,enemy:s,ally:c,bullets:l},gun:{angle:this._gunAngle,reloading:this.isReloading},radio:{inbox:this.team?this.team.getMessages(this.id):[]}}}}},{key:"id",get:function(){return this._id}},{key:"skin",get:function(){return this._skin}},{key:"state",get:function(){return this._state}},{key:"energy",get:function(){return this._energy}},{key:"score",get:function(){return this._score}},{key:"maxEnergy",get:function(){return this._maxEnergy}},{key:"radarRange",get:function(){return this._radarRange}},{key:"radarFocal",get:function(){return this._radarFocal}},{key:"name",get:function(){return this._name}},{key:"fullName",get:function(){return this._name+" #"+this._id}},{key:"team",get:function(){return this._team}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"speed",get:function(){return this._speed}},{key:"gunLength",get:function(){return 25}},{key:"angle",get:function(){return this._angle}},{key:"throttle",get:function(){return this._throttle}},{key:"hasBoost",get:function(){return this._hasBoost&&this._boost>0}},{key:"boost",get:function(){return this._boost}},{key:"maxBoost",get:function(){return this._maxBoost}},{key:"gunAngle",get:function(){return this._gunAngle}},{key:"radarAngle",get:function(){return this._radarAngle}},{key:"enemySpot",get:function(){return this._enemySpot}},{key:"allySpot",get:function(){return this._allySpot}},{key:"targetingAlarm",get:function(){return this._targetingAlarmTimer>0}},{key:"debugData",get:function(){return this._debugData}},{key:"isShooting",get:function(){return this._shootingPower>0}},{key:"shootingPower",get:function(){return this._shootingPower}},{key:"isReloading",get:function(){return this._gunTimer>0}}])&&a(t.prototype,n),r&&a(t,r),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._members=[],this._inboxMap=[],this._outboxMap=[]}var t,n,r;return t=e,(n=[{key:"addTank",value:function(e){if(e.team)throw"Tank "+e.fullName+" is already assigned to team "+e.team.name;for(var t in this._members)if(this._members[t].id==e.id)return;this._members.push(e),e._team=this,this._inboxMap[e.id]=[],this._outboxMap[e.id]=[]}},{key:"getMessages",value:function(e){return this._outboxMap[e]}},{key:"sendMessages",value:function(e,t){for(var n in this._inboxMap)n!=e&&(this._inboxMap[n]=this._inboxMap[n].concat(t))}},{key:"processMessages",value:function(){var e;for(e in this._inboxMap)this._outboxMap[e]=this._inboxMap[e],this._inboxMap[e]=[]}},{key:"size",get:function(){return this._members.length}},{key:"name",get:function(){return this._name}},{key:"aliveCount",get:function(){for(var e=0,t=0;t<this._members.length;t++)this._members[t].energy>0&&e++;return e}},{key:"score",get:function(){for(var e=0,t=0;t<this._members.length;t++)e+=this._members[t].score;return e}},{key:"energy",get:function(){for(var e=0,t=0;t<this._members.length;t++)e+=this._members[t].energy;return e}},{key:"maxEnergy",get:function(){for(var e=0,t=0;t<this._members.length;t++)e+=this._members[t].maxEnergy;return e}},{key:"isAlive",get:function(){return this.aliveCount>0}},{key:"members",get:function(){return this._members}}])&&c(t.prototype,n),r&&c(t,r),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t,n,r){for(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=n,this._owner=t,this._angle=t.angle+t.gunAngle;this._angle>180;)this._angle-=360;for(;this._angle<-180;)this._angle+=360;this._x=t.x+t.gunLength*Math.cos(this._angle*(Math.PI/180)),this._y=t.y+t.gunLength*Math.sin(this._angle*(Math.PI/180)),this._speed=4,this._power=r,this._damage=.01*Math.round(1e3*r+300*r*r),this._exploded=!1}var t,n,r;return t=e,(n=[{key:"onWallHit",value:function(){this._exploded=!0}},{key:"onEnemyHit",value:function(e){this._exploded=!0,e.onDamage(this._damage)}},{key:"simulationStep",value:function(){this._x+=this._speed*Math.cos(this._angle*(Math.PI/180)),this._y+=this._speed*Math.sin(this._angle*(Math.PI/180))}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"angle",get:function(){return this._angle}},{key:"speed",get:function(){return this._speed}},{key:"damage",get:function(){return this._damage}},{key:"power",get:function(){return this._power}},{key:"owner",get:function(){return this._owner}},{key:"exploded",get:function(){return this._exploded}}])&&f(t.prototype,n),r&&f(t,r),e}();function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._width=null,this._height=null,this._startSlotList=[],this._offsetX=0,this._offsetY=0}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e,t){this._width=e-2*this.margin,this._height=t-2*this.margin}},{key:"randomize",value:function(e){void 0===e&&(e=(new Date).getTime()+Math.round(1e6*Math.random()));var t=o()(e);this._offsetX=Math.round(1e4*t()-5e3),this._offsetY=Math.round(1e4*t()-5e3),this._startSlotList=[];for(var n=this.minX+90;n<this.maxX-90;n+=90)for(var r=this.minY+90;r<this.maxY-90;r+=90)this._startSlotList.push({x:n,y:r});for(var i,a,u=this._startSlotList.length;0!==u;)a=Math.floor(t()*u),u-=1,i=this._startSlotList[u],this._startSlotList[u]=this._startSlotList[a],this._startSlotList[a]=i}},{key:"getStartSlot",value:function(){return this._startSlotList.length?this._startSlotList.pop():null}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"margin",get:function(){return 25}},{key:"minX",get:function(){return this._offsetX+this.margin}},{key:"minY",get:function(){return this._offsetY+this.margin}},{key:"maxX",get:function(){return this._offsetX+this._width+this.margin}},{key:"maxY",get:function(){return this._offsetY+this._height+this.margin}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}}])&&p(t.prototype,n),r&&p(t,r),e}();function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){this._data[e]||(this._data[e]=[]),this._data[e].push(t)}},{key:"get",value:function(e){return this._data[e]||(this._data[e]=[]),this._data[e]}},{key:"clear",value:function(e){this._data=[]}}])&&y(t.prototype,n),r&&y(t,r),e}(),v=n(2),b=n.n(v);function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._wallList=[],this._tankMap=[],this._bulletMap=[],this._radarBeamMap=[],this._battlefield=null}var t,n,r;return t=e,(n=[{key:"updateBattlefield",value:function(e){var t;this._battlefield={minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY},t=new b.a.Box(new b.a.Vector(e.minX-10,e.minY),10,e.height).toPolygon(),this._wallList.push(t),t=new b.a.Box(new b.a.Vector(e.minX,e.minY-10),e.width,10).toPolygon(),this._wallList.push(t),t=new b.a.Box(new b.a.Vector(e.maxX,e.minY),10,e.height).toPolygon(),this._wallList.push(t),t=new b.a.Box(new b.a.Vector(e.minX,e.maxY),e.width,10).toPolygon(),this._wallList.push(t)}},{key:"updateTank",value:function(e){var t=this._getTankShape(e);t.pos.x=e.x,t.pos.y=e.y}},{key:"removeBullet",value:function(e){this._bulletMap[e.id]=null}},{key:"removeTank",value:function(e){this._tankMap[e.id]=null,this._radarBeamMap[e.id]=null}},{key:"hitTestBullet",value:function(e){var t,n,r,o=this._getBulletShape(e),i=e.owner.energy?this._getTankShape(e.owner):null;for(t in o.pos.x=e.x,o.pos.y=e.y,this._wallList)if(n=this._wallList[t],b.a.testCirclePolygon(o,n))return e.onWallHit(),!0;for(t in this._tankMap)if((r=this._tankMap[t])&&r!=i&&b.a.testCircleCircle(o,r)){var a=r.tank.energy;return e.onEnemyHit(r.tank),e.owner.isAlly(r.tank)||e.owner.onEnemyHitScore(a-r.tank.energy),0==r.tank.energy&&e.owner.onEnemyKillScore(),!0}return!1}},{key:"checkTank",value:function(e){var t,n,r,o,i=this._getTankShape(e);for(t in i.pos.x=e.x,i.pos.y=e.y,this._wallList)if(r=this._wallList[t],n=b.a.testCirclePolygon(i,r))return e.onWallHit(),!1;for(t in this._tankMap)if((o=this._tankMap[t])&&o!=i){n=b.a.testCircleCircle(i,o);var a=e.isAlly(o.tank);if(n){if(a)return e.onAllyHit(),!1;var u=o.tank.energy;return e.onEnemyHit(),o.tank.onBeingRam(e.speed),e.onEnemyHitScore(u-o.tank.energy),!1}}return!0}},{key:"scanTanks",value:function(e){var t,n,r=this._getRadarBeamShape(e),o=this._getTankShape(e);r.setAngle((e.angle+e.radarAngle)*Math.PI/180),r.pos.x=e.x,r.pos.y=e.y;var i=[];for(t in this._tankMap)(n=this._tankMap[t])&&n!=o&&b.a.testPolygonCircle(r,n)&&i.push(n.tank);if(0==i.length)return!1;var a,u,s,c,l=null,f=e.radarRange,h=null,p=e.radarRange;for(t in i)u=i[t].x-e.x,s=i[t].y-e.y,a=Math.sqrt(u*u+s*s),(c=i[t].isAlly(e))||l&&!(a<f)?c&&(!h||a<p)&&(h=i[t],p=a):(l=i[t],f=a);return h&&e.onAllySpot(h),l&&(e.onEnemySpot(l),l.onTargetingAlarm()),!0}},{key:"scanBullets",value:function(e){var t,n,r=this._getRadarBeamShape(e);r.setAngle((e.angle+e.radarAngle)*Math.PI/180),r.pos.x=e.x,r.pos.y=e.y;var o=!1;for(t in this._bulletMap)(n=this._bulletMap[t])&&n.bullet.owner!=e&&b.a.testCirclePolygon(n,r)&&(e.onBulletSpot(n.bullet),o=!0);return o}},{key:"scanWalls",value:function(e){var t=this._getWallDistance(e);return t<e.radarRange&&(e.onWallSpot(t),!0)}},{key:"_getWallDistance",value:function(e){for(var t=e.angle+e.radarAngle;t>180;)t-=360;for(;t<-180;)t+=360;var n,r,o=e.y-this._battlefield.minY,i=this._battlefield.maxY-e.y,a=e.x-this._battlefield.minX,u=this._battlefield.maxX-e.x;return-180==t||180==t?a:0==t?u:-90==t?o:90==t?i:(t>-180&&t<-90?(n=a/Math.cos((t+180)*(Math.PI/180)),r=o/Math.sin((t+180)*(Math.PI/180))):t>-90&&t<0?(n=u/Math.cos(-t*(Math.PI/180)),r=o/Math.sin(-t*(Math.PI/180))):t>0&&t<90?(n=u/Math.cos(t*(Math.PI/180)),r=i/Math.sin(t*(Math.PI/180))):(n=a/Math.cos((180-t)*(Math.PI/180)),r=i/Math.sin((180-t)*(Math.PI/180))),Math.min(n,r))}},{key:"_getTankShape",value:function(e){if(!this._tankMap[e.id]){if(0==e.energy)throw"Cannot create shape for destroyed tank";var t=new b.a.Circle(new b.a.Vector(e.x,e.y),18);this._tankMap[e.id]=t,t.tank=e}return this._tankMap[e.id]}},{key:"_getBulletShape",value:function(e){if(!this._bulletMap[e.id]){if(e.exploded)throw"Cannot create shape for exploded bullet";var t=new b.a.Circle(new b.a.Vector(e.x,e.y),3);this._bulletMap[e.id]=t,t.bullet=e}return this._bulletMap[e.id]}},{key:"_getRadarBeamShape",value:function(e){if(!this._radarBeamMap[e.id]){if(0==e.energy)throw"Cannot create radar beam shape for destroyed tank";var t=e.radarRange*Math.tan(e.radarFocal*(Math.PI/180))/2,n=new b.a.Polygon(new b.a.Vector(e.x,e.y),[new b.a.Vector(0,3),new b.a.Vector(0,-3),new b.a.Vector(e.radarRange,-t),new b.a.Vector(e.radarRange,t)]);this._radarBeamMap[e.id]=n,n.tank=e}return this._radarBeamMap[e.id]}}])&&_(t.prototype,n),r&&_(t,r),e}(),w=n(25);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw"Tank is required";if(!n)throw"AiDefinition is required";this._tank=t,this._aiWorker=null,this._aiProcessingStart=0,this._aiProcessingCheckInterval=null,this._aiProcessingResolveCallback=null,this._aiProcessingRejectCallback=null,this._slowAiChances=10,this._onActivationCallback=[],this._onDectivationCallback=[],this._aiProcessingTimeLimit=3e3,this._aiDefinition=n,this._isReady=!1,this._controlData={THROTTLE:0,BOOST:0,TURN:0,RADAR_TURN:0,GUN_TURN:0,SHOOT:0,OUTBOX:[],DEBUG:{}}}var t,n,r;return t=e,(n=[{key:"setProcessingLimit",value:function(e){this._aiProcessingTimeLimit=e}},{key:"onActivation",value:function(e){this._onActivationCallback.push(e)}},{key:"onDectivation",value:function(e){this._onDeactivationCallback.push(e)}},{key:"_formatError",value:function(e){if(!e.message)return"unknown";var t=e.message;return e.lineno&&(t="Line #"+e.lineno+": "+t),t}},{key:"activate",value:function(e,t,n){if("number"!=typeof e)throw"seed must be a number, '"+k(e)+"' given";if("function"!=typeof t)throw"resolve callback must be a function, '"+k(t)+"' given";if("function"!=typeof n)throw"reject callback must be a function, '"+k(n)+"' given";var r=this;r._aiWorker=r._createWorker(this._aiDefinition),r._aiWorker.onerror=function(e){console.error(e),r._aiProcessingRejectCallback&&(r._aiProcessingRejectCallback({message:"Web Worker of '"+r._tank.fullName+"' returned an error: "+r._formatError(e),performanceIssues:!1,tankName:r._tank.name,tankId:r._tank.id}),r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null)},r._aiProcessingCheckInterval&&(clearInterval(r._aiProcessingCheckInterval),r._aiProcessingCheckInterval=null),r._aiProcessingCheckInterval=setInterval((function(){r._aiProcessingRejectCallback&&(new Date).getTime()-r._aiProcessingStart>r._aiProcessingTimeLimit&&(clearInterval(r._aiProcessingCheckInterval),r._aiProcessingCheckInterval=null,r._aiProcessingRejectCallback({message:"Simulation cannot be continued because "+r._tank.name+" #"+r._tank.id+" does not respond",performanceIssues:!0,tankName:r._tank.name,tankId:r._tank.id}))}),Math.max(r._aiDefinition.executionLimit,Math.round(r._aiProcessingTimeLimit/2))),r._aiWorker.onmessage=function(e){var t=e.data;if(r._aiProcessingResolveCallback){if("init"==t.type){r._configureTank(t.settings?t.settings:{}),r._isReady=!0;for(var n=0;n<r._onActivationCallback.length;n++)r._onActivationCallback[n].bind(r)()}else r._controlTank(t);var o,i=(new Date).getTime()-r._aiProcessingStart;if(i>r._aiDefinition.executionLimit&&"init"!=t.type&&(r._slowAiChances--,console.warn("Execution of AI for tank "+r._tank.name+" #"+r._tank.id+" takes too long ("+i+"ms). If problem repeats, AI will be terminated."),r._slowAiChances<=0))return o=r._aiProcessingRejectCallback,r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null,void o({message:"Simulation cannot be continued because "+r._tank.name+" #"+r._tank.id+" has performance issues",performanceIssues:!0,tankName:r._tank.name,tankId:r._tank.id});o=r._aiProcessingResolveCallback,r._aiProcessingResolveCallback=null,r._aiProcessingRejectCallback=null,o()}};var o=null;o=r._tank.team&&r._tank.team.size>1?{name:r._tank.team.name,mates:r._tank.team.members.map((function(e){return e.id}))}:{name:r._tank.fullName,mates:[r._tank.id]};var i={id:r._tank.id,team:o};r._aiDefinition.initData&&(i.initData=r._aiDefinition.initData),r._aiProcessingStart=(new Date).getTime(),r._aiProcessingResolveCallback=t,r._aiProcessingRejectCallback=n,r._aiWorker.postMessage({command:"init",seed:e+":"+r._tank.id,settings:{SKIN:"zebra"},info:i,code:r._aiDefinition.code})}},{key:"deactivate",value:function(){this._aiWorker&&(this._aiWorker.terminate(),this._aiWorker=null),this._aiProcessingCheckInterval&&(clearInterval(this._aiProcessingCheckInterval),this._aiProcessingCheckInterval=null);for(var e=0;e<this._onDectivationCallback.length;e++)this._onDectivationCallback[e].bind(this)()}},{key:"simulationStep",value:function(e,t){if("function"!=typeof e)throw"resolve callback must be a function, '"+k(e)+"' given";if("function"!=typeof t)throw"reject callback must be a function, '"+k(t)+"' given";if(!this._isReady)throw"AI of "+this._tank.fullName+" not initliazed";if(this._aiWorker&&0==this._tank.energy)return this._aiWorker.terminate(),this._aiWorker=null,void e();this._aiProcessingStart=(new Date).getTime(),this._aiProcessingResolveCallback=e,this._aiProcessingRejectCallback=t,this._aiWorker.postMessage({command:"update",state:this._tank.state,control:this._controlData})}},{key:"_configureTank",value:function(e){var t={};-1!=["zebra","forest","black","tiger","desert","lava","ocean"].indexOf(e.SKIN)&&(t.SKIN=e.SKIN),this._tank.init(t)}},{key:"_controlTank",value:function(e){this._controlData.THROTTLE=Number(e.THROTTLE),this._controlData.TURN=Number(e.TURN),this._controlData.GUN_TURN=Number(e.GUN_TURN),this._controlData.RADAR_TURN=Number(e.RADAR_TURN),this._controlData.SHOOT=Number(e.SHOOT),this._controlData.DEBUG=e.DEBUG,this._controlData.BOOST=e.BOOST?1:0,this._controlData.THROTTLE=isNaN(this._controlData.THROTTLE)?0:this._controlData.THROTTLE,this._controlData.TURN=isNaN(this._controlData.TURN)?0:this._controlData.TURN,this._controlData.GUN_TURN=isNaN(this._controlData.GUN_TURN)?0:this._controlData.GUN_TURN,this._controlData.RADAR_TURN=isNaN(this._controlData.RADAR_TURN)?0:this._controlData.RADAR_TURN,this._controlData.SHOOT=isNaN(this._controlData.SHOOT)?0:this._controlData.SHOOT,this._controlData.THROTTLE=Math.min(1,Math.max(-1,Number(this._controlData.THROTTLE))),this._controlData.TURN=Math.min(1,Math.max(-1,Number(this._controlData.TURN))),this._controlData.GUN_TURN=Math.min(1,Math.max(-1,Number(this._controlData.GUN_TURN))),this._controlData.RADAR_TURN=Math.min(1,Math.max(-1,Number(this._controlData.RADAR_TURN))),this._controlData.SHOOT=Math.min(1,Math.max(0,Number(this._controlData.SHOOT))),this._tank.setThrottle(this._controlData.THROTTLE),this._tank.setBoost(this._controlData.BOOST),this._tank.setTurn(this._controlData.TURN),this._tank.setRadarTurn(this._controlData.RADAR_TURN),this._tank.setGunTurn(this._controlData.GUN_TURN),this._tank.setDebugData(this._controlData.DEBUG),this._controlData.SHOOT&&this._tank.shoot(this._controlData.SHOOT),this._controlData.SHOOT=0;var t=[];for(var n in e.OUTBOX)t.push(JSON.parse(JSON.stringify(e.OUTBOX[n])));this._tank.team&&this._tank.team.sendMessages(this._tank.id,t),this._controlData.OUTBOX=[]}},{key:"_createWorker",value:function(e){return e.useSandbox?new Worker(e.filePath):new w.a}},{key:"tank",get:function(){return this._tank}},{key:"worker",get:function(){return this._aiWorker}}])&&S(t.prototype,n),r&&S(t,r),e}();function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._simulationStepDuration=30,this._stepCounter=0,this._checkLoop=0,this._started=!1,this._desiredPerfomance=Math.floor(1e3/this._simulationStepDuration),this._actualPerfomance=this._desiredPerfomance,this._perfomanceIndex=1,this._desiredQuality=1,this._quality=this._desiredQuality,this._checkInterval=500}var t,n,r;return t=e,(n=[{key:"start",value:function(){this._started=!0;var e=this;this._checkLoop=setInterval((function(){e._check()}),this._checkInterval)}},{key:"stop",value:function(){this._started=!1,this._checkLoop&&(clearInterval(this._checkLoop),this._checkLoop=null)}},{key:"setSimulationStepDuration",value:function(e){e!=this._simulationStepDuration&&(this._quality=this._desiredQuality),this._simulationStepDuration=e,this._desiredPerfomance=Math.floor(1e3/e)}},{key:"onSimulationStep",value:function(){this._started&&this._stepCounter++}},{key:"_check",value:function(){this._actualPerfomance=Math.ceil(this._stepCounter*(1e3/this._checkInterval)),this._stepCounter=0;var e=this._desiredPerfomance?this._actualPerfomance/this._desiredPerfomance:1;this._perfomanceIndex=(this._perfomanceIndex+e)/2,this._updateQuality()}},{key:"_updateQuality",value:function(){var e=2.5*this._perfomanceIndex-1.25;e=Math.max(0,Math.min(1,e));var t=-.5*this._perfomanceIndex+.45;this._perfomanceIndex>1?this._desiredQuality+=.1:this._desiredQuality-=t,this._desiredQuality=Math.max(0,Math.min(1,this._desiredQuality));var n=Math.max(e,this._desiredQuality);this._desiredQuality=(this._desiredQuality+n)/2,this._desiredQuality<this._quality?this._quality=this._desiredQuality:this._quality=(this._desiredQuality+9*this._quality)/10}},{key:"started",get:function(){return this._started}},{key:"desiredPerfomance",get:function(){return this._desiredPerfomance}},{key:"actualPerfomance",get:function(){return this._actualPerfomance}},{key:"qualityLevel",get:function(){return this._quality}}])&&P(t.prototype,n),r&&P(t,r),e}();function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var E=!1,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=(new Date).getTime().toString();t=t.substr(t.length-6,6)+""+Math.round(1e7*Math.random()),t=(t=Number(t)).toString(35),this._name="",this._team=t,this._code=null,this._initData=null,this._useSandbox=!0,this._executionLimit=100}var t,n,r;return t=e,(n=[{key:"toJSON",value:function(){return{name:this._name,team:this._team,code:this._code,initData:this._initData,useSandbox:this._useSandbox,executionLimit:this.executionLimit}}},{key:"fromJSON",value:function(e){this._name=e.name,this._team=e.team,this._code=e.code?e.code.replace(/importScripts\w*\([^\)]*\)/g,""):e.code,this._initData=e.initData,this._useSandbox=e.useSandbox,this._executionLimit=e.executionLimit}},{key:"clone",value:function(){var t=new e;return t.fromJSON(this.toJSON()),t}},{key:"fromFile",value:function(e,t){if(!e)throw new Error("tankName is required");this._name=e,this._code=null,this._initData=void 0!==t?t:null}},{key:"fromCode",value:function(e,t,n){if(!e)throw new Error("tankName is required");if(!t)throw new Error("Code is required");if("string"!=typeof e)throw new Error("tankName must be a string");if("string"!=typeof t)throw new Error("code must be a string");t=t.replace(/importScripts\w*\([^\)]*\)/g,""),this._name=e,this._code=t,this._initData=void 0!==n?n:null}},{key:"assignToTeam",value:function(e){this._team=e}},{key:"disableSandbox",value:function(){if(null===this._code)throw new Error("Sandbox can be disabled for AI created from code only (AI name: '"+this._name+"')");E||(console.warn("Disabling sandbox for AI! It could be dangerous."),E=!0),this._useSandbox=!1}},{key:"name",get:function(){return this._name}},{key:"teamName",get:function(){return this._team}},{key:"executionLimit",get:function(){return this._executionLimit},set:function(e){this._executionLimit=e}},{key:"filePath",get:function(){return this._useSandbox?null!==this._code?"tanks/lib/codeWorker.js":"tanks/".concat(this._name,".tank.js"):null}},{key:"code",get:function(){return this._code}},{key:"initData",get:function(){return this._initData}},{key:"useSandbox",get:function(){return this._useSandbox}}])&&x(t.prototype,n),r&&x(t,r),e}(),T=n(26),R=n.n(T),A=n(27);function D(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._version=4,this._aiList=[],this._rngSeed=(new Date).getTime(),this._teamMode=!1,this._timeLimit=0}var t,n,r;return t=e,(n=[{key:"addAiDefinition",value:function(e){this._aiList.push(e)}},{key:"setTeamMode",value:function(e){this._teamMode=e}},{key:"getTeamMode",value:function(){return this._teamMode}},{key:"setRngSeed",value:function(e){this._rngSeed=e}},{key:"getVersion",value:function(){return this._version}},{key:"getAiList",value:function(){return this._aiList}},{key:"setTimeLimit",value:function(e){this._timeLimit=e}},{key:"getTimeLimit",value:function(){return this._timeLimit}},{key:"getRngSeed",value:function(){return this._rngSeed}},{key:"encode",value:function(){var e,t,n={version:this._version,rngSeed:this._rngSeed,teamMode:this._teamMode,timeLimit:this._timeLimit,aiList:[]},r=D(this._aiList);try{for(r.s();!(t=r.n()).done;){var o=t.value;e=o.count||1;for(var i=0;i<e;i++)n.aiList.push(o.toJSON())}}catch(e){r.e(e)}finally{r.f()}return JSON.stringify(n)}},{key:"decode",value:function(e,t){var n,r;try{n=JSON.parse(e)}catch(e){throw new Error("Cannot parse UBD file! ".concat(e))}if(this._version!=n.version)throw new Error("Version of UBD does not match. Version ".concat(n.version," is not supported. Please convert to version ").concat(this._version));this.validateJsonData(n),this._rngSeed=n.rngSeed,this._teamMode=n.teamMode,this._timeLimit=n.timeLimit;var o,i=D(n.aiList);try{for(i.s();!(o=i.n()).done;){var a=o.value;r=new C,t||(a.useSandbox=!0,a.executionLimit=100,a.initData=null),r.fromJSON(a),this._aiList.push(r)}}catch(e){i.e(e)}finally{i.f()}}},{key:"validateJsonData",value:function(e){var t=(new R.a).compile(A);if(!t(e))throw new Error("UBD validation failed - "+t.errors[0].message)}},{key:"clone",value:function(){var t=new e;t.setRngSeed(this.getRngSeed()),t.setTeamMode(this.getTeamMode()),t.setTimeLimit(this.getTimeLimit());var n,r,o=D(this.getAiList());try{for(o.s();!(r=o.n()).done;)n=r.value.clone(),t.addAiDefinition(n)}catch(e){o.e(e)}finally{o.f()}return t}}])&&N(t.prototype,n),r&&N(t,r),e}();var L=function(e){var t=0;for(var n in e._teamMap)e._teamMap[n].isAlive&&t++;return t<=1};function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._debug=n,this._aiList=[],this._allTankList=[],this._tankList=[],this._bulletList=[],this._explodedTankList=[],this._explodedBulletList=[],this._battlefield=null,this._simulationTimeout=null,this._renderInterval=null,this._simulationStepDuration=17,this._renderStepDuration=30,this._renderer=t,this._isRunning=!1,this._collisionResolver=new g,this._rngSeed=(new Date).getTime()+Math.round(1e6*Math.random()),this._rng=o()(this._rngSeed),this._speedMultiplier=1,this._onSimulationStepCallback=[],this._onRenderStepCallback=[],this._onFinishCallback=[],this._onErrorCallback=[],this._onStartCallback=[],this._timeElapsed=0,this._timeLimit=3e4,this._finishCondition=L,this._customFinishCondition=!1,this._eventStore=new m,this._nextTankId=1,this._nextBulletId=1,this._rendererQuality="auto",this._perfMon=new j,this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._callStackLimit=Number.MAX_VALUE,this._callStackCount=0,this._teamMap=[],this._teamList=[],this._ultimateBattleDescriptor=new I,this.log("Contructing Simulation")}var t,n,r;return t=e,(n=[{key:"setRngSeed",value:function(e){this.log("Set renderer RNG Seed to '".concat(e,"'")),this._rngSeed=e,this._ultimateBattleDescriptor.setRngSeed(e),this._rng=o()(this._rngSeed)}},{key:"getRngSeed",value:function(){return this._rngSeed}},{key:"getRandom",value:function(){return this._rng()}},{key:"log",value:function(e){this._debug&&console.log("[SIM] "+e)}},{key:"setFinishCondition",value:function(e){this.log("Setting custom finish conditioins"),this._customFinishCondition=!0,this._finishCondition=e}},{key:"init",value:function(e,t){this.log("Initialize the battlefield (width=".concat(e,", height=").concat(t,")")),this._battlefield=new d,this._battlefield.setSize(e,t),this._battlefield.randomize(this._rng()),this._renderer.initBatlefield(this._battlefield),this._collisionResolver.updateBattlefield(this._battlefield),this.log("The battlefiield initialized. Done.")}},{key:"start",value:function(){if(this.log("Starting the simulation"),0==this._tankList.length)throw new Error("To start simulation, the tank list cannot be empty!");var e;this._isRunning=!0;var t=this;this._renderInterval&&(this.log("Clearing existing render interval"),clearInterval(this._renderInterval),this._renderInterval=null),this.log("Activating AIs..."),this._activateAi((function(){for(t._renderInterval=setInterval((function(){t._updateView()}),t._renderStepDuration),t._simulationTimeout&&clearTimeout(t._simulationTimeout),t._perfMon.start(),t.log("Notify onStartCallback"),e=0;e<t._onStartCallback.length;e++)t._onStartCallback[e]();t.log("Run first simulation step"),t._simulationStep()}),(function(n){for(console.error(n),e=0;e<t._onErrorCallback.length;e++)t._onErrorCallback[e](n.message?n.message:"Error during simulation")}))}},{key:"_simulationStep",value:function(){this._perfMon.onSimulationStep();var e,t=(new Date).getTime(),n=this;this._updateModel(),this._updateAi((function(){if(n._simulationTimeout&&(clearTimeout(n._simulationTimeout),n._simulationTimeout=null),n._timeLimit>0&&n._timeElapsed==n._timeLimit||n._finishCondition(n))for(n.stop(),n._updateModel(),n._updateView(),e=0;e<n._onFinishCallback.length;e++)n._onFinishCallback[e]();if(n._isRunning){var r=(new Date).getTime()-t,o=n._simulationStepDuration/n._speedMultiplier-r;for(o=Math.round(o),e=0;e<n._onSimulationStepCallback.length;e++)n._onSimulationStepCallback[e]();n._timeElapsed+=n._simulationStepDuration,n._timeLimit>0&&(n._timeElapsed=Math.min(n._timeElapsed,n._timeLimit)),o>0?(n._callStackCount=0,n._simulationTimeout=setTimeout(n._simulationStep.bind(n),o)):n._callStackCount>=n._callStackLimit?n._simulationTimeout=setTimeout(n._simulationStep.bind(n),1):(n._callStackCount++,n._simulationStep())}}),(function(t){for(console.error(t),e=0;e<n._onErrorCallback.length;e++)n._onErrorCallback[e](t.message?t.message:"Error during simulation")}))}},{key:"addTank",value:function(e){if(this.log("Adding tank..."),"object"!=$(e))throw"AI definition must be an object";if(!this._battlefield)throw"Simulation not initialized";if(!e.teamName)throw"Team name cannot be empty!";var t=this._battlefield.getStartSlot();if(!t)throw"No free space in the battlefield";this._ultimateBattleDescriptor.addAiDefinition(e),this._ultimateBattleDescriptor.setTeamMode(this.hasTeams());var n=this._createTank(e);n.randomize(this.getRandom()),n.moveTo(t.x,t.y),this._tankList.push(n),this._allTankList.push(n),this._timeLimit>0&&this._allTankList.length>2&&(this._timeLimit+=2e3),this._teamMap[e.teamName]||(this._teamMap[e.teamName]=new l(e.teamName),this._teamList.push(this._teamMap[e.teamName])),this._teamMap[e.teamName].addTank(n);var r=this._createAiWrapper(n,e);return this._aiList.push(r),r}},{key:"setSpeed",value:function(e){this.log("Set speed to '".concat(e,"'")),this._speedMultiplier=Math.max(.01,Number(e)),this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier),this._renderer.setSpeed(e)}},{key:"setRendererQuality",value:function(e){this.log("Set rederer quality to '".concat(e,"'")),isNaN(e)&&"auto"!=e||(isNaN(e)||(e=Math.min(1,Math.max(0,e))),this._rendererQuality=e)}},{key:"stop",value:function(){var e,t;for(this.log("stopping the simulation"),this._isRunning=!1,this._perfMon.stop(),this._renderer.stop(),this._simulationTimeout&&(clearTimeout(this._simulationTimeout),this._simulationTimeout=null),this._renderInterval&&(clearInterval(this._renderInterval),this._renderInterval=null),t=0;t<this._aiList.length;t++)(e=this._aiList[t])&&e.deactivate();this._aiList=[]}},{key:"onStep",value:function(e){this._onSimulationStepCallback.push(e)}},{key:"onRender",value:function(e){this._onRenderStepCallback.push(e)}},{key:"onStart",value:function(e){this._onStartCallback.push(e)}},{key:"onFinish",value:function(e){this._onFinishCallback.push(e)}},{key:"onError",value:function(e){this._onErrorCallback.push(e)}},{key:"createUltimateBattleDescriptor",value:function(){if(this._customFinishCondition)throw new Error("Cannot create UBD for battles with custom battle finish condition!");return this._ultimateBattleDescriptor.clone()}},{key:"hasTeams",value:function(){return this._teamList.length!=this._tankList.length}},{key:"_activateAi",value:function(e,t){this._runInSequence(this._aiList,"activate",this._rng(),e,t)}},{key:"_updateAi",value:function(e,t){this._runInSequence(this._aiList,"simulationStep",null,e,t)}},{key:"_runInSequence",value:function(e,t,n,r,o){if(0==e.length)return r();function i(){for(var e=[],t=arguments[1],n=arguments[0],r=2;r<arguments.length;r++)e.push(arguments[r]);return function(r){t.apply(n,e.concat(r))}}var a,u=i(null,r),s=i(null,o);a=n?i(e[e.length-1],e[e.length-1][t],n,u,s):i(e[e.length-1],e[e.length-1][t],u,s);for(var c=e.length-2;c>=0;c--)a=n?i(e[c],e[c][t],n,a,s):i(e[c],e[c][t],a,s);a()}},{key:"_updateModel",value:function(){var e,t,n,r;for(e=0;e<this._tankList.length;e++)(t=this._tankList[e])&&t.simulationStep(this._collisionResolver);var o=0;for(e=0;e<this._tankList.length;e++)(t=this._tankList[e])&&t.energy<=0&&(o++,this._tankList[e]=null,this._explodedTankList.push(t),this._collisionResolver.removeTank(t),this._eventStore.add("tank_"+t.id,{type:"destroy",tank:t}));var i=[];for(e=0;e<this._aiList.length;e++)(r=this._aiList[e])&&(r.tank.energy<=0?(this._aiList[e]=null,r.deactivate()):i.push(r));for(this._aiList=i,e=0;e<this._tankList.length;e++)if((t=this._tankList[e])&&t.isShooting){var a=t.handleShoot();n=this._createBullet(t,a),this._bulletList.push(n),this._eventStore.add("tank_"+t.id,{type:"shoot",tank:t,bullet:n})}for(e=0;e<this._tankList.length;e++)if(t=this._tankList[e])for(var u=0;u<o;u++)t.onSurviveScore();for(e=0;e<this._bulletList.length;e++)(n=this._bulletList[e])&&(n.simulationStep(),this._collisionResolver.hitTestBullet(n)&&(this._bulletList[e]=null,this._explodedBulletList.push(n),this._collisionResolver.removeBullet(n),this._eventStore.add("bullet_"+n.id,{type:"explode",bullet:n})));for(e in this._teamMap)this._teamMap[e].processMessages()}},{key:"_updateView",value:function(){var e,t,n;for("auto"==this._rendererQuality?this._renderer.quality=this._perfMon.qualityLevel:this._renderer.quality=this._rendererQuality,this._renderer.preRender(),this._renderer.renderClock(this._timeElapsed,this._timeLimit),e=0;e<this._tankList.length;e++)(t=this._tankList[e])&&this._renderer.renderTank(t,this._eventStore.get("tank_"+t.id));for(e=0;e<this._bulletList.length;e++)(n=this._bulletList[e])&&this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(;this._explodedTankList.length;)t=this._explodedTankList.pop(),this._renderer.renderTank(t,this._eventStore.get("tank_"+t.id));for(;this._explodedBulletList.length;)n=this._explodedBulletList.pop(),this._renderer.renderBullet(n,this._eventStore.get("bullet_"+n.id));for(this._renderer.renderTankStats(this._allTankList),this._renderer.postRender(),e=0;e<this._onRenderStepCallback.length;e++)this._onRenderStepCallback[e]();this._eventStore.clear()}},{key:"_createAiWrapper",value:function(e,t){return new O(e,t)}},{key:"_createTank",value:function(e){return new s(e,this._nextTankId++)}},{key:"_createBullet",value:function(e,t){return new h(e,this._nextBulletId++,t)}},{key:"tankList",get:function(){return this._allTankList}},{key:"teamList",get:function(){return this._teamList}},{key:"renderer",get:function(){return this._renderer}},{key:"battlefield",get:function(){return this._battlefield}},{key:"timeElapsed",get:function(){return this._timeElapsed}},{key:"timeLimit",get:function(){return this._timeLimit},set:function(e){this.log("Set time limit to '".concat(e,"'")),this._ultimateBattleDescriptor.setTimeLimit(e),this._timeLimit=e}}])&&V(t.prototype,n),r&&V(t,r),e}();function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"initBatlefield",value:function(e){}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"renderTank",value:function(e,t){}},{key:"renderClock",value:function(e,t){}},{key:"renderTankStats",value:function(e){}},{key:"renderBullet",value:function(e,t){}},{key:"setSpeed",value:function(e){}},{key:"stop",value:function(){}},{key:"dispose",value:function(){}},{key:"quality",get:function(){return 1},set:function(e){}}])&&B(t.prototype,n),r&&B(t,r),e}(),F=n(0);function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._model=t,this._view=null,this._isAlive=!0}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){this._isAlive=!1}},{key:"update",value:function(e){}},{key:"isAlive",get:function(){return this._isAlive}},{key:"model",get:function(){return this._model}},{key:"view",get:function(){return this._view}}])&&q(t.prototype,n),r&&q(t,r),e}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var o=J(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(i,e);var t,n,r,o=W(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._debug=e,t._tankMap=[],t._bulletMap=[],t._offsetX=0,t._offsetY=0,t._speedMultiplier=1,t}return t=i,(n=[{key:"log",value:function(e){this._debug&&console.log("[RENDERER] "+e)}},{key:"initBatlefield",value:function(e){this._offsetX=e.offsetX,this._offsetY=e.offsetY}},{key:"renderTank",value:function(e,t){this._renderModel(e,t,this._tankMap,this._createTankView)}},{key:"renderBullet",value:function(e,t){this._renderModel(e,t,this._bulletMap,this._createBulletView)}},{key:"getBulletView",value:function(e){return this._bulletMap[e]}},{key:"getTankView",value:function(e){return this._tankMap[e]}},{key:"setSpeed",value:function(e){this._speedMultiplier=e}},{key:"_renderModel",value:function(e,t,n,r){var o=null;return n[e.id]?o=n[e.id]:(o=r(e),n[e.id]=o),o.update(t),o}},{key:"_createTankView",value:function(e){return new H(e)}},{key:"_createBulletView",value:function(e){return new H(e)}},{key:"dispose",value:function(){}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"speedMultiplier",get:function(){return this._speedMultiplier}}])&&K(t.prototype,n),r&&K(t,r),i}(U);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t,n){return(te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie(e);if(t){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(i,e);var t,n,r,o=re(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._model=e,t._view=new F.Container,t._create(t._view),t}return t=i,(n=[{key:"update",value:function(e){te(ie(i.prototype),"update",this).call(this,e),void 0!==this._model.x&&(this._view.x=this._model.x),void 0!==this._model.y&&(this._view.y=this._model.y),void 0!==this._model.angle&&(this._view.rotation=this._model.angle*(Math.PI/180))}},{key:"destroy",value:function(){te(ie(i.prototype),"destroy",this).call(this),this.view.parent&&this.view.parent.removeChild(this.view)}},{key:"_create",value:function(e){}}])&&ee(t.prototype,n),r&&ee(t,r),i}(H);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t,n){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe(e);if(t){var o=pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return he(this,n)}}function he(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(i,e);var t,n,r,o=fe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._hudView=new F.Container,t._createHud(t._hudView),t}return t=i,(n=[{key:"update",value:function(e){ce(pe(i.prototype),"update",this).call(this,e),this.view.rotation=0,this.body.rotation=this.model.angle*(Math.PI/180),this.gun.rotation=(this.model.angle+this.model.gunAngle)*(Math.PI/180),this.radar.rotation=(this.model.angle+this.model.radarAngle)*(Math.PI/180),this.energyBar.scale.x=this.model.energy/this.model.maxEnergy,this.label.text=this.model.fullName,this.hudView.x=this.view.x,this.hudView.y=this.view.y;for(var t=0;t<e.length;t++)this._onEvent(e[t])}},{key:"_onEvent",value:function(e){switch(e.type){case"shoot":this._onShoot(e);break;case"destroy":this._onDestroy(e)}}},{key:"_onShoot",value:function(e){}},{key:"_onDestroy",value:function(e){this.destroy()}},{key:"_create",value:function(e){ce(pe(i.prototype),"_create",this).call(this,e),this._body=this._createBody(),this._gun=this._createGun(),this._radar=this._createRadar(),e.addChild(this._body),e.addChild(this._gun),e.addChild(this._radar)}},{key:"_createHud",value:function(e){this._label=this._createLabel(),this._energyBar=this._createEnergyBar(),e.addChild(this._createHudBackground()),e.addChild(this._energyBar),e.addChild(this._label)}},{key:"_createBody",value:function(){return new F.Sprite}},{key:"_createGun",value:function(){return new F.Sprite}},{key:"_createRadar",value:function(){return new F.Sprite}},{key:"_createHudBackground",value:function(){return new F.Sprite}},{key:"_createEnergyBar",value:function(){return new F.Sprite}},{key:"_createLabel",value:function(){return new F.Text}},{key:"destroy",value:function(){ce(pe(i.prototype),"destroy",this).call(this),this.hudView.parent&&this.hudView.parent.removeChild(this.hudView)}},{key:"body",get:function(){return this._body}},{key:"hudView",get:function(){return this._hudView}},{key:"gun",get:function(){return this._gun}},{key:"radar",get:function(){return this._radar}},{key:"label",get:function(){return this._label}},{key:"energyBar",get:function(){return this._energyBar}}])&&se(t.prototype,n),r&&se(t,r),i}(ae);function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"construct",value:function(){this._msElapsed=0,this._msLimit=0}},{key:"update",value:function(e,t){this._msElapsed=e,this._msLimit=t}},{key:"msElapsed",get:function(){return this._msElapsed}},{key:"msLimit",get:function(){return this._msLimit}},{key:"text",get:function(){var e=Math.max(0,this._msLimit-this._msElapsed),t=Math.floor(e/1e3),n=e%1e3;for(t=t.toString();t.length<2;)t="0"+t;for(n=n.toString();n.length<3;)n="0"+n;return"0:"+t+"."+n}}])&&ye(t.prototype,n),r&&ye(t,r),e}();function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t,n){return(_e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Se(e);if(t){var o=Se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ke(this,n)}}function ke(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(i,e);var t,n,r,o=we(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,t))._name=e,n._isDisposed=!1,F.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,n._masterContainer=new F.Container,n._tankContainer=new F.Container,n._bulletContainer=new F.Container,n._hudContainer=new F.Container,n._masterContainer.addChild(n._tankContainer),n._masterContainer.addChild(n._bulletContainer),n._masterContainer.addChild(n._hudContainer),n._renderer=null,n._stage=null,n._clockModel=new me,n._clockView=null,n._battlefieldView=null,window.devicePixelRatio>=2?n._rendererScale=2:n._rendererScale=1,n.log("Contructing Renderer"),n}return t=i,(n=[{key:"initBatlefield",value:function(e){this.log("initializing the battlefield"),_e(Se(i.prototype),"initBatlefield",this).call(this,e),this._masterContainer.x=-this.offsetX,this._masterContainer.y=-this.offsetY,this.log("battlefield offset: x=".concat(this._masterContainer.x,", y=").concat(this._masterContainer.y));var t={view:this._canvas,antialias:!1,backgroundColor:16777215,resolution:this._rendererScale,width:e.width+2*e.margin,height:e.height+2*e.margin};this.log("renderer settings: width=".concat(t.width,", height=").concat(t.width)),this._renderer=new F.autoDetectRenderer(t),this._stage=new F.Container,this._battlefieldView=this._createBattlefieldView(e),this._clockView=this._createClockView(this._clockModel),this._stage.addChild(this._battlefieldView.view),this._stage.addChild(this._masterContainer),this._stage.addChild(this._clockView.view),this._renderer.render(this._stage),this.log("battlefield initialized")}},{key:"init",value:function(e){this._canvas=e}},{key:"loadAssets",value:function(e,t){var n=this;if(this.log("loading assets, urlPrefix: '".concat(t,"'")),t=t||"",!this._name)return this.log("No assets to load for that renderer. Done."),void e();var r=new F.Loader,o=[];for(var i in r.resources)this.log("adding resource to load '".concat(i,"'")),o.push(i);this._getSpritesheetUrls(this._name,this._rendererScale).filter((function(e){return-1==o.indexOf(e)})).forEach((function(e){r.add(t+e)})),this.log("loading assets..."),r.load((function(t,r){if(n._isDisposed)return n.log("Renderer disposed: Clearing texture cache"),F.utils.clearTextureCache(),void n.log("Renderer disposed: Skipping onAssetsLoaded handler");n.log("onAssetsLoaded()"),n.onAssetsLoaded(),n.log("Assets loaded"),e()}))}},{key:"onAssetsLoaded",value:function(){}},{key:"preRender",value:function(){this._battlefieldView.update()}},{key:"renderTank",value:function(e,t){_e(Se(i.prototype),"renderTank",this).call(this,e,t);var n=this.getTankView(e.id);!n.parent&&n.isAlive&&(this._tankContainer.addChild(n.view),this._hudContainer.addChild(n.hudView))}},{key:"renderBullet",value:function(e,t){_e(Se(i.prototype),"renderBullet",this).call(this,e,t);var n=this.getBulletView(e.id);!n.parent&&n.isAlive&&this._bulletContainer.addChild(n.view)}},{key:"renderClock",value:function(e,t){this._clockModel.update(e,t),this._clockView.update()}},{key:"postRender",value:function(){_e(Se(i.prototype),"postRender",this).call(this),this._renderer.render(this._stage)}},{key:"_getSpritesheetUrls",value:function(e,t){var n=2==t?"retina@2x":"web";return["img/spritesheets/".concat(e,"/").concat(n,"/jsbattle.json")]}},{key:"_createTankView",value:function(e){return new de(e)}},{key:"_createBulletView",value:function(e){return new ae(e)}},{key:"_createBattlefieldView",value:function(e){return new ae(e)}},{key:"_createClockView",value:function(e){return new ae(e)}},{key:"dispose",value:function(){this.log("Disposing..."),this._isDisposed=!0,this._renderer?(this._renderer.context.gl.getExtension("WEBGL_lose_context").loseContext(),this._renderer.destroy(),this._renderer=null):this.log("Already disposed"),this._canvas=null,this._stage=null,this.log("Clearing texture cache"),F.utils.clearTextureCache()}},{key:"stage",get:function(){return this._stage}},{key:"battlefieldView",get:function(){return this._battlefieldView}},{key:"masterContainer",get:function(){return this._masterContainer}}])&&be(t.prototype,n),r&&be(t,r),i}(Q);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Re(e);if(t){var o=Re(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Te(this,n)}}function Te(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(i,e);var t,n,r,o=Ce(i);function i(){return je(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"_create",value:function(e){var t=new F.Graphics;t.beginFill(0),t.lineStyle(1,16776960,.8),t.drawRect(0,0,this.model.width+2*this.model.margin,this.model.height+2*this.model.margin),t.endFill(),e.addChild(t),(t=new F.Graphics).beginFill(0),t.lineStyle(1,16776960,.8),t.drawRect(this.model.margin,this.model.margin,this.model.width,this.model.height),t.endFill(),e.addChild(t)}},{key:"update",value:function(e){}}])&&xe(t.prototype,n),r&&xe(t,r),i}(ae);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$e(e);if(t){var o=$e(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Le(this,n)}}function Le(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(i,e);var t,n,r,o=Ie(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_create",value:function(e){var t=new F.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._label=new F.Text("clock",t),this._label.x=5,this._label.y=5,e.addChild(this._label)}},{key:"update",value:function(e){this._label.text=this.model.text}}])&&Me(t.prototype,n),r&&Me(t,r),i}(ae);function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e,t,n){return(Ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ge(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ge(e);if(t){var o=Ge(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return He(this,n)}}function He(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(i,e);var t,n,r,o=qe(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"update",value:function(e){Ue(Ge(i.prototype),"update",this).call(this,e),this.view.scale.x=this.view.scale.y=.7*this.model.power+.3,this.model.exploded&&this.destroy()}}])&&Be(t.prototype,n),r&&Be(t,r),i}(ae);function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze(e);if(t){var o=Ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qe(this,n)}}function Qe(e,t){return!t||"object"!==Xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(i,e);var t,n,r,o=Je(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_create",value:function(e){var t=new F.Graphics;t.beginFill(65280,.5),t.drawCircle(0,0,5),t.endFill(),e.addChild(t)}}])&&We(t.prototype,n),r&&We(t,r),i}(Ke);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=at(e);if(t){var o=at(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return it(this,n)}}function it(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(i,e);var t,n,r,o=ot(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_createBody",value:function(){var e=new F.Graphics;return e.lineStyle(1,16776960,.8),e.beginFill(65280,.5),e.drawRect(-15,-15,30,30),e.endFill(),e}},{key:"_createGun",value:function(){var e=new F.Graphics;return e.beginFill(65280,.5),e.lineStyle(1,16776960,.8),e.drawCircle(0,0,10),e.drawRect(0,-3,30,6),e.endFill(),e}},{key:"_createRadar",value:function(){var e=new F.Graphics;e.beginFill(65280,.5),e.lineStyle(1,16776960,.8),e.drawRect(-3,-10,6,20),e.endFill(),e.lineStyle(),e.beginFill(11206570,.1),e.moveTo(0,-3);var t=300*Math.tan(Math.PI/180*6)/2;return e.lineTo(300,-t),e.lineTo(300,t),e.lineTo(0,3),e}},{key:"_createLabel",value:function(){var e=new F.TextStyle({fontFamily:"Arial",fontSize:12,fill:65280}),t=new F.Text("",e);return t.anchor.set(.5,.5),t.x=0,t.y=-40,t}},{key:"_createHudBackground",value:function(){var e=new F.Graphics;return e.beginFill(0,1),e.lineStyle(1,16776960,.8),e.drawRect(-26,-3,52,6),e.y=-30,e}},{key:"_createEnergyBar",value:function(){var e=new F.Graphics;return e.beginFill(65280,1),e.drawRect(0,-2,50,4),e.x=-25,e.y=-30,e}}])&&nt(t.prototype,n),r&&nt(t,r),i}(de);function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t,n){return(lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dt(e);if(t){var o=dt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pt(this,n)}}function pt(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(i,e);var t,n,r,o=ht(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,void 0,e))._frameCounter=0,t._fpsLabel=null,t._scoreBoard=null,t}return t=i,(n=[{key:"initBatlefield",value:function(e){lt(dt(i.prototype),"initBatlefield",this).call(this,e);var t=new F.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"});this._fpsLabel=new F.Text("FPS",t),this._fpsLabel.x=100,this._fpsLabel.y=5,this.stage.addChild(this._fpsLabel);var n=this;setInterval((function(){n._fpsLabel.text="FPS: "+n._frameCounter,n._frameCounter=0}),1e3),t=new F.TextStyle({fontFamily:"Arial",fontSize:12,fill:"#00ff00"}),this._scoreBoard=new F.Text("scores",t),this._scoreBoard.x=e.margin+2,this._scoreBoard.y=e.margin+2,this._scoreBoard.alpha=.5,this.stage.addChild(this._scoreBoard)}},{key:"renderTankStats",value:function(e){lt(dt(i.prototype),"renderTankStats",this).call(this,e);var t,n=[];for(t=0;t<e.length;t++)n.push({name:e[t].fullName,energy:e[t].energy,value:e[t].score});n.sort((function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}));var r="";for(t=0;t<n.length;t++)r+=n[t].value.toFixed(3)+" - "+n[t].name+(0==n[t].energy?" [X]":"")+"\n";this._scoreBoard.text=r}},{key:"postRender",value:function(){lt(dt(i.prototype),"postRender",this).call(this),this._frameCounter++}},{key:"_createBattlefieldView",value:function(e){return new Ae(e)}},{key:"_createClockView",value:function(e){return new Ve(e)}},{key:"_createBulletView",value:function(e){return new et(e)}},{key:"_createTankView",value:function(e){return new ut(e)}}])&&ct(t.prototype,n),r&&ct(t,r),i}(Oe);function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kt(e);if(t){var o=kt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wt(this,n)}}function wt(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var St=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}(i,e);var t,n,r,o=gt(i);function i(){return vt(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"_create",value:function(e){var t=F.Sprite.from("battlefield");e.addChild(t)}},{key:"update",value:function(e){}}])&&bt(t.prototype,n),r&&bt(t,r),i}(ae);function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ct(e);if(t){var o=Ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Et(this,n)}}function Et(e,t){return!t||"object"!==Ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(i,e);var t,n,r,o=xt(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_create",value:function(e){var t=new F.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new F.Text("clock",t),this._label.x=10,this._label.y=580,e.addChild(this._label)}},{key:"update",value:function(e){this._label.text=this.model.text}}])&&Pt(t.prototype,n),r&&Pt(t,r),i}(ae);function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=It(e);if(t){var o=It(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nt(this,n)}}function Nt(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(i,e);var t,n,r,o=Mt(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_create",value:function(e){var t=F.Sprite.from("bullet");t.anchor.set(.5),e.addChild(t)}}])&&At(t.prototype,n),r&&At(t,r),i}(Ke);function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zt(e,t,n){return(zt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Bt(e,t){return(Bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qt(e);if(t){var o=qt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ft(this,n)}}function Ft(e,t){return!t||"object"!==$t(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bt(e,t)}(i,e);var t,n,r,o=Ut(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"update",value:function(e){zt(qt(i.prototype),"update",this).call(this,e),this._shoot.alpha=this.model.isShooting?1:.7*this._shoot.alpha}},{key:"_createBody",value:function(){var e=F.Sprite.from("tank_body");return e.anchor.set(.5),e}},{key:"_createGun",value:function(){var e=new F.Container,t=F.Sprite.from("tank_gun");return t.anchor.set(.3,.5),e.addChild(t),this._shoot=F.Sprite.from("tank_shoot"),this._shoot.anchor.set(-1.2,.5),this._shoot.alpha=0,e.addChild(this._shoot),e}},{key:"_createRadar",value:function(){var e=F.Sprite.from("tank_radar");return e.anchor.set(.5),e}},{key:"_createLabel",value:function(){var e=new F.TextStyle({fontFamily:"Arial",fontSize:12,fill:0}),t=new F.Text("",e);return t.anchor.set(.5,.5),t.x=0,t.y=-40,t}},{key:"_createHudBackground",value:function(){var e=new F.Graphics;return e.beginFill(0,1),e.drawRect(-26,-3,52,6),e.y=-30,e}},{key:"_createEnergyBar",value:function(){var e=new F.Graphics;return e.beginFill(16711680,1),e.drawRect(0,-2,50,4),e.x=-25,e.y=-30,e}}])&&Vt(t.prototype,n),r&&Vt(t,r),i}(de);function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e,t,n){return(Xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qt(e);if(t){var o=Qt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jt(this,n)}}function Jt(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qt(e){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(i,e);var t,n,r,o=Yt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"bw",e))._bigBoomAnim=[],t._smallBoomAnim=[],t._shakeTimer=0,t}return t=i,(n=[{key:"onAssetsLoaded",value:function(){for(var e=0;e<=9;e++)this._bigBoomAnim.push(F.Texture.from("big_boom_00"+e)),this._smallBoomAnim.push(F.Texture.from("small_boom_00"+e))}},{key:"initBatlefield",value:function(e){Xt(Qt(i.prototype),"initBatlefield",this).call(this,e)}},{key:"renderTank",value:function(e,t){Xt(Qt(i.prototype),"renderTank",this).call(this,e,t),0==e.energy&&(this._shakeTimer=10,this._addExplosion(e.x,e.y,this._bigBoomAnim))}},{key:"renderBullet",value:function(e,t){Xt(Qt(i.prototype),"renderBullet",this).call(this,e,t),e.exploded&&this._addExplosion(e.x,e.y,this._smallBoomAnim)}},{key:"postRender",value:function(){Xt(Qt(i.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY)}},{key:"_createBattlefieldView",value:function(e){return new St(e)}},{key:"_createClockView",value:function(e){return new Tt(e)}},{key:"_createBulletView",value:function(e){return new Lt(e)}},{key:"_createTankView",value:function(e){return new Ht(e)}},{key:"_addExplosion",value:function(e,t,n){var r=new F.AnimatedSprite(n);r.anchor.set(.5),this.masterContainer.addChild(r),r.x=e,r.y=t,r.loop=!1,r.onComplete=function(){this.stop(),this.parent.removeChild(this)},r.play()}}])&&Kt(t.prototype,n),r&&Kt(t,r),i}(Oe);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nn(e,t,n){return(nn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=un(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function on(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=un(e);if(t){var o=un(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return an(this,n)}}function an(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(i,e);var t,n,r,o=on(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._holeList=[],t._settings=null,t}return t=i,(n=[{key:"configure",value:function(e){this._settings=e}},{key:"_create",value:function(e){var t=F.Sprite.from("battlefield");e.addChild(t);var n=new F.Graphics;n.beginFill(255,1),n.moveTo(25,25),n.lineTo(875,25),n.lineTo(875,575),n.lineTo(90,575),n.lineTo(90,565),n.lineTo(25,565),n.lineTo(25,25),n.endFill(),this._craterContainer=new F.Container,this._craterContainer.mask=n,e.addChild(this._craterContainer),e.addChild(n);var r=new F.Graphics;r.beginFill(255,.4),r.moveTo(15,15),r.lineTo(885,15),r.lineTo(885,585),r.lineTo(80,585),r.lineTo(80,575),r.lineTo(15,575),r.lineTo(15,15),r.lineTo(25,25),r.lineTo(25,575),r.lineTo(80,575),r.lineTo(80,575),r.lineTo(875,575),r.lineTo(875,25),r.lineTo(25,25),r.endFill(),this._holesContainer=new F.Container,this._holesContainer.mask=r,e.addChild(this._holesContainer),e.addChild(r)}},{key:"addCrater",value:function(e,t){var n=F.Sprite.from("crater");n.anchor.set(.5),n.x=e-this.model.offsetX,n.y=t-this.model.offsetY,n.blendMode=F.BLEND_MODES.MULTIPLY,n.alpha=.8,this._craterContainer.addChild(n)}},{key:"update",value:function(){nn(un(i.prototype),"update",this).call(this),this._holesContainer.visible=this._settings.skratchLimit>0,this._craterContainer.visible=this._settings.showCraters}},{key:"addBulletHole",value:function(e,t,n){var r=0;if(Math.abs(t-this.model.maxY)<10)t=this.model.maxY+3+3*Math.random();else if(Math.abs(t-this.model.minY)<10)t=this.model.minY-3-3*Math.random();else if(Math.abs(e-this.model.maxX)<10)e=this.model.maxX+3+3*Math.random(),r=Math.PI/2;else{if(!(Math.abs(e-this.model.minX)<10))return;e=this.model.minX-3-3*Math.random(),r=Math.PI/2}var o=F.Sprite.from("hole");o.anchor.set(.5),o.x=e-this.model.offsetX,o.y=t-this.model.offsetY,o.rotation=r,o.scale.x=o.scale.y=.7+.5*n,this._holesContainer.addChild(o),this._holeList.push(o);for(var i=this._settings?this._settings.skratchLimit:20;this._holeList.length>i;)(o=this._holeList.shift()).parent.removeChild(o)}}])&&tn(t.prototype,n),r&&tn(t,r),i}(ae);function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dn(e);if(t){var o=dn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pn(this,n)}}function pn(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(i,e);var t,n,r,o=hn(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_create",value:function(e){var t=new F.TextStyle({fontFamily:"Arial",fontSize:15,fill:"#000000"});this._label=new F.Text("clock",t),this._label.x=10,this._label.y=580,e.addChild(this._label)}},{key:"update",value:function(e){this._label.text=this.model.text}}])&&ln(t.prototype,n),r&&ln(t,r),i}(ae);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e,t,n){return(bn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _n(e,t){return(_n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kn(e);if(t){var o=kn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wn(this,n)}}function wn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kn(e){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_n(e,t)}(i,e);var t,n,r,o=gn(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"configure",value:function(e){this._settings=e}},{key:"update",value:function(e){bn(kn(i.prototype),"update",this).call(this,e),this._glow.visible=this._settings&&this._settings.showGlow}},{key:"_create",value:function(e){var t=F.Sprite.from("bullet");t.anchor.set(.5);var n=F.Sprite.from("glow");n.anchor.set(.5),n.blendMode=F.BLEND_MODES.ADD,n.alpha=.1,this._glow=n,e.addChild(n),e.addChild(t)}}])&&vn(t.prototype,n),r&&vn(t,r),i}(Ke);function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jn(e,t,n){return(jn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function En(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tn(e);if(t){var o=Tn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cn(this,n)}}function Cn(e,t){return!t||"object"!==On(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(i,e);var t,n,r,o=En(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._lightTimer=0,t}return t=i,(n=[{key:"update",value:function(e){jn(Tn(i.prototype),"update",this).call(this,e),this._shoot.alpha=.8*this._shoot.alpha,this._tankGun.x=.8*this._tankGun.x,this.radar.rotation=(-this.model.gunAngle+this._model.radarAngle)*(Math.PI/180),this._lightTimer=this.model.enemySpot?this._lightTimer+1:0,this._light.alpha=.5*-Math.cos(.25*this._lightTimer)+.5}},{key:"_onShoot",value:function(e){jn(Tn(i.prototype),"_onShoot",this).call(this,e),this._tankGun.x=-1-3*e.bullet.power,this._shoot.alpha=1}},{key:"_create",value:function(e){jn(Tn(i.prototype),"_create",this).call(this,e),this._tankGun.addChild(this.radar)}},{key:"_createBody",value:function(){var e=F.Sprite.from("tank_body_"+this.model.skin);return e.anchor.set(.3,.5),e}},{key:"_createGun",value:function(){var e=new F.Container,t=F.Sprite.from("tank_gun_"+this.model.skin);return t.anchor.set(.3,.5),e.addChild(t),this._tankGun=t,this._shoot=F.Sprite.from("tank_shoot"),this._shoot.anchor.set(.3,.5),this._shoot.alpha=0,this._light=F.Sprite.from("tank_light"),this._light.anchor.set(.3,.5),this._light.alpha=0,e.addChild(this._shoot),e.addChild(this._light),e}},{key:"_createRadar",value:function(){var e=F.Sprite.from("tank_radar_"+this.model.skin);return e.anchor.set(.2,.5),e.x=-5,e}},{key:"_createLabel",value:function(){var e=new F.TextStyle({fontFamily:"Arial",fontSize:10,stroke:0,strokeThickness:2,fill:16777147}),t=new F.Text("",e);return t.anchor.set(.5,.5),t.x=0,t.y=-40,t}},{key:"_createHudBackground",value:function(){var e=new F.Graphics;return e.beginFill(0,1),e.drawRect(-26,-3,52,6),e.y=-30,e}},{key:"_createEnergyBar",value:function(){var e=new F.Graphics;return e.beginFill(16777113,1),e.drawRect(0,-2,50,4),e.x=-25,e.y=-30,e}}])&&Pn(t.prototype,n),r&&Pn(t,r),i}(de);function An(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._particleLimit=1e3,this._skratchLimit=100,this._showDirt=!0,this._showGlow=!0,this._showCraters=!0,this._dropFrames=1,this._quality=1,this.quality=this._quality}var t,n,r;return t=e,(n=[{key:"dropFrames",get:function(){return this._dropFrames}},{key:"particleLimit",get:function(){return this._particleLimit}},{key:"skratchLimit",get:function(){return this._skratchLimit}},{key:"showDirt",get:function(){return this._showDirt}},{key:"showGlow",get:function(){return this._showGlow}},{key:"showCraters",get:function(){return this._showCraters}},{key:"quality",get:function(){return this._quality},set:function(e){e=Math.min(1,Math.max(0,e)),this._quality=e,this._particleLimit=Math.round(1e3*e*e),this._skratchLimit=Math.round(100*e),this._showDirt=e>.2,this._showGlow=e>.5,this._showCraters=e>.1,this._dropFrames=e>.3?1:e>.2?2:e>.1?3:4,this._quality=e}}])&&An(t.prototype,n),r&&An(t,r),e}();function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function In(e,t,n){return(In="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zn(e);if(t){var o=zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vn(this,n)}}function Vn(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zn(e){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(i,e);var t,n,r,o=$n(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"brody",e))._bigBoomAnim=[],t._shakeTimer=0,t._particleContainer=null,t._particleList=[],t._explosionList=[],t._settings=new Dn,t._masterContainer.addChild(t._bulletContainer),t._frameTimer=0,t._frameCounter=0,t._fpsInterval=null,t._fps=30,t}return t=i,(n=[{key:"onAssetsLoaded",value:function(){var e;for(e=0;e<=22;e++)this._bigBoomAnim.push(F.Texture.from("big_boom_0"+(e<10?"0"+e:e)))}},{key:"initBatlefield",value:function(e){In(zn(i.prototype),"initBatlefield",this).call(this,e),this.battlefieldView.configure(this._settings),this._particleContainer=new F.ParticleContainer(1e3,{position:!0,rotation:!0,alpha:!0}),this._masterContainer.addChild(this._particleContainer),this._masterContainer.addChild(this._hudContainer);var t=this;this._fpsInterval=setInterval((function(){t._fps=t._frameCounter,t._frameCounter=0}),1e3)}},{key:"renderTank",value:function(e,t){var n;for(n in In(zn(i.prototype),"renderTank",this).call(this,e,t),t)if("destroy"==t[n].type){this._shakeTimer=10,this._addTankExplosion(e);break}var r=e.throttle>0?180:0,o=(e.angle+r)*(Math.PI/180);if(e.speed>1){var a=e.x+20*Math.cos(o-Math.PI/4)+7*Math.cos(o),u=e.y+20*Math.sin(o-Math.PI/4)+7*Math.sin(o),s=e.x+20*Math.cos(o+Math.PI/4)+7*Math.cos(o),c=e.y+20*Math.sin(o+Math.PI/4)+7*Math.sin(o);Math.random()<this.speedMultiplier&&(this._addDirt(a,u),this._addDirt(s,c))}}},{key:"renderBullet",value:function(e,t){In(zn(i.prototype),"renderBullet",this).call(this,e,t),this.getBulletView(e.id).configure(this._settings),e.exploded&&(this._addBulletExplosion(e),this.battlefieldView.addBulletHole(e.x,e.y,e.power))}},{key:"preRender",value:function(){var e;In(zn(i.prototype),"preRender",this).call(this);var t,n=0;for(t=this._particleList.length-1;t>=0;t--)(e=this._particleList[t])&&(e.x+=this.speedMultiplier*e.speed*e.rotation*Math.cos(e.rotation),e.y+=this.speedMultiplier*e.speed*e.rotation*Math.sin(e.rotation),e.alpha=Math.max(0,e.alpha-this.speedMultiplier*e.alphaSpeed),e.lifetime-=this.speedMultiplier,e.lifetime<=0||n>this._settings.particleLimit?(e.parent.removeChild(e),this._particleList[t]=null):n++);for(t=0;t<this._explosionList.length;t++)this._explosionList[t]&&(this._explosionList[t].alpha=this._explosionList[t].alpha-.12*this.speedMultiplier,this._explosionList[t].alpha<.01&&(this._explosionList[t].parent.removeChild(this._explosionList[t]),this._explosionList[t]=null))}},{key:"postRender",value:function(){this._frameTimer++,this._frameCounter++,this._frameTimer%this._settings.dropFrames==0&&In(zn(i.prototype),"postRender",this).call(this),this._shakeTimer>0?(this._shakeTimer--,this.masterContainer.x=10*Math.random()-5-this.offsetX,this.masterContainer.y=10*Math.random()-5-this.offsetY,this._battlefieldView.view.x=10*Math.random()-5,this._battlefieldView.view.y=10*Math.random()-5):(this.masterContainer.x=-this.offsetX,this.masterContainer.y=-this.offsetY,this._battlefieldView.view.x=0,this._battlefieldView.view.y=0)}},{key:"stop",value:function(){this._fpsInterval&&clearInterval(this._fpsInterval)}},{key:"_getSpritesheetUrls",value:function(e,t){return t>=2?["img/spritesheets/".concat(e,"/retina@2x/jsbattle_0.json"),"img/spritesheets/".concat(e,"/retina@2x/jsbattle_1.json")]:["img/spritesheets/".concat(e,"/web/jsbattle.json")]}},{key:"_addTankExplosion",value:function(e){this._addExplosion(e.x,e.y,this._bigBoomAnim),this.battlefieldView.addCrater(e.x,e.y),this._addSparks(e.x,e.y,300)}},{key:"_addBulletExplosion",value:function(e){this._addGlow(e.x,e.y,.3+.6*e.power);var t=5+40*e.power;this._addSparks(e.x,e.y,t)}},{key:"_createBattlefieldView",value:function(e){return new sn(e)}},{key:"_createClockView",value:function(e){return new yn(e)}},{key:"_createBulletView",value:function(e){return new Sn(e)}},{key:"_createTankView",value:function(e){return new Rn(e)}},{key:"_addExplosion",value:function(e,t,n){this._addGlow(e,t,5);var r=new F.AnimatedSprite(n);r.animationSpeed=this.speedMultiplier,r.anchor.set(.5),this.masterContainer.addChild(r),r.x=e,r.y=t,r.loop=!1,r.blendMode=F.BLEND_MODES.ADD,r.onComplete=function(){this.stop(),this.parent.removeChild(this)},r.play()}},{key:"_addGlow",value:function(e,t,n){if(this._settings.showGlow){var r=F.Sprite.from("glow");r.anchor.set(.5),r.scale.x=r.scale.y=n,r.alpha=.4,r.blendMode=F.BLEND_MODES.ADD,r.x=e,r.y=t,this.masterContainer.addChild(r),this._explosionList.push(r)}}},{key:"_addSparks",value:function(e,t,n){n=Math.ceil(n*this._settings.quality);for(var r=0;r<n;r++){var o=F.Sprite.from("spark");o.x=e,o.y=t,o.alphaSpeed=0,o.anchor.set(.5),o.speed=1+2*Math.random(),o.rotation=2*Math.random()*Math.PI,o.lifetime=5+5*Math.random(),this._particleContainer.addChild(o),this._particleList.push(o)}}},{key:"_addDirt",value:function(e,t){if(this._settings.showDirt)for(var n=0;n<5;n++){var r=Math.floor(3*Math.random()),o=F.Sprite.from("dirt_"+r);o.x=e+4*Math.random()-2,o.y=t+4*Math.random()-2,o.anchor.set(.5),o.speed=0,o.alphaSpeed=.02+.02*Math.random(),o.rotation=0,o.alpha=.1+.4*Math.random(),o.lifetime=25,o.scale.x=o.scale.y=.5+2*Math.random(),this._particleContainer.addChild(o),this._particleList.push(o)}}},{key:"quality",get:function(){return this._settings.quality},set:function(e){this._settings.quality=e}}])&&Nn(t.prototype,n),r&&Nn(t,r),i}(Oe);function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xn(e);if(t){var o=Xn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kn(this,n)}}function Kn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(i,e);var t,n,r,o=Gn(i);function i(){return Fn(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"renderTank",value:function(e,t){}},{key:"renderBullet",value:function(e,t){}},{key:"loadAssets",value:function(e){e()}},{key:"init",value:function(){}}])&&qn(t.prototype,n),r&&qn(t,r),i}(U),Yn={createSimulation:function(e,t){return e=e||new U(t),new z(e,t)},createAiDefinition:function(){return new C},createUBD:function(){return new I},createRenderer:function(e,t){switch(e){case"debug":return new yt(t);case"bw":return new Zt(t);case"brody":return new Bn(t);case"void":return new Wn(t);default:throw"Unknown rederer "+e}}};!function(e){e?e.JsBattle=Yn:console.warn("self is not defined")}(window)}]);
//# sourceMappingURL=jsbattle.min.js.map